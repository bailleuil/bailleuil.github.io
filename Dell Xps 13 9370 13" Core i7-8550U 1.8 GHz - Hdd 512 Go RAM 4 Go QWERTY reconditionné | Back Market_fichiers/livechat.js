!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=799)}([,,,,,function(t,e,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var o=typeof r;if("string"===o||"number"===o)t.push(r);else if(Array.isArray(r)&&r.length){var a=i.apply(null,r);a&&t.push(a)}else if("object"===o)for(var s in r)n.call(r,s)&&r[s]&&t.push(s)}}return t.join(" ")}t.exports?(i.default=i,t.exports=i):void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}()},function(t,e,n){(function(t,n){(function(){var r,i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",s="__lodash_hash_undefined__",c=500,u="__lodash_placeholder__",l=1,f=2,d=4,h=1,p=2,m=1,g=2,v=4,_=8,y=16,b=32,S=64,T=128,E=256,C=512,w=30,A="...",O=800,x=16,R=1,I=2,N=1/0,M=9007199254740991,P=1.7976931348623157e308,D=NaN,k=4294967295,j=k-1,U=k>>>1,z=[["ary",T],["bind",m],["bindKey",g],["curry",_],["curryRight",y],["flip",C],["partial",b],["partialRight",S],["rearg",E]],L="[object Arguments]",B="[object Array]",F="[object AsyncFunction]",H="[object Boolean]",q="[object Date]",G="[object DOMException]",V="[object Error]",Y="[object Function]",W="[object GeneratorFunction]",$="[object Map]",J="[object Number]",X="[object Null]",K="[object Object]",Q="[object Proxy]",Z="[object RegExp]",tt="[object Set]",et="[object String]",nt="[object Symbol]",rt="[object Undefined]",it="[object WeakMap]",ot="[object WeakSet]",at="[object ArrayBuffer]",st="[object DataView]",ct="[object Float32Array]",ut="[object Float64Array]",lt="[object Int8Array]",ft="[object Int16Array]",dt="[object Int32Array]",ht="[object Uint8Array]",pt="[object Uint8ClampedArray]",mt="[object Uint16Array]",gt="[object Uint32Array]",vt=/\b__p \+= '';/g,_t=/\b(__p \+=) '' \+/g,yt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bt=/&(?:amp|lt|gt|quot|#39);/g,St=/[&<>"']/g,Tt=RegExp(bt.source),Et=RegExp(St.source),Ct=/<%-([\s\S]+?)%>/g,wt=/<%([\s\S]+?)%>/g,At=/<%=([\s\S]+?)%>/g,Ot=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xt=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,Nt=RegExp(It.source),Mt=/^\s+|\s+$/g,Pt=/^\s+/,Dt=/\s+$/,kt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,jt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ut=/,? & /,zt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Lt=/\\(\\)?/g,Bt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ft=/\w*$/,Ht=/^[-+]0x[0-9a-f]+$/i,qt=/^0b[01]+$/i,Gt=/^\[object .+?Constructor\]$/,Vt=/^0o[0-7]+$/i,Yt=/^(?:0|[1-9]\d*)$/,Wt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$t=/($^)/,Jt=/['\n\r\u2028\u2029\\]/g,Xt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Kt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Qt="[\\ud800-\\udfff]",Zt="["+Kt+"]",te="["+Xt+"]",ee="\\d+",ne="[\\u2700-\\u27bf]",re="[a-z\\xdf-\\xf6\\xf8-\\xff]",ie="[^\\ud800-\\udfff"+Kt+ee+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",oe="\\ud83c[\\udffb-\\udfff]",ae="[^\\ud800-\\udfff]",se="(?:\\ud83c[\\udde6-\\uddff]){2}",ce="[\\ud800-\\udbff][\\udc00-\\udfff]",ue="[A-Z\\xc0-\\xd6\\xd8-\\xde]",le="(?:"+re+"|"+ie+")",fe="(?:"+ue+"|"+ie+")",de="(?:"+te+"|"+oe+")"+"?",he="[\\ufe0e\\ufe0f]?"+de+("(?:\\u200d(?:"+[ae,se,ce].join("|")+")[\\ufe0e\\ufe0f]?"+de+")*"),pe="(?:"+[ne,se,ce].join("|")+")"+he,me="(?:"+[ae+te+"?",te,se,ce,Qt].join("|")+")",ge=RegExp("['’]","g"),ve=RegExp(te,"g"),_e=RegExp(oe+"(?="+oe+")|"+me+he,"g"),ye=RegExp([ue+"?"+re+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[Zt,ue,"$"].join("|")+")",fe+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[Zt,ue+le,"$"].join("|")+")",ue+"?"+le+"+(?:['’](?:d|ll|m|re|s|t|ve))?",ue+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ee,pe].join("|"),"g"),be=RegExp("[\\u200d\\ud800-\\udfff"+Xt+"\\ufe0e\\ufe0f]"),Se=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Te=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ee=-1,Ce={};Ce[ct]=Ce[ut]=Ce[lt]=Ce[ft]=Ce[dt]=Ce[ht]=Ce[pt]=Ce[mt]=Ce[gt]=!0,Ce[L]=Ce[B]=Ce[at]=Ce[H]=Ce[st]=Ce[q]=Ce[V]=Ce[Y]=Ce[$]=Ce[J]=Ce[K]=Ce[Z]=Ce[tt]=Ce[et]=Ce[it]=!1;var we={};we[L]=we[B]=we[at]=we[st]=we[H]=we[q]=we[ct]=we[ut]=we[lt]=we[ft]=we[dt]=we[$]=we[J]=we[K]=we[Z]=we[tt]=we[et]=we[nt]=we[ht]=we[pt]=we[mt]=we[gt]=!0,we[V]=we[Y]=we[it]=!1;var Ae={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Oe=parseFloat,xe=parseInt,Re="object"==typeof t&&t&&t.Object===Object&&t,Ie="object"==typeof self&&self&&self.Object===Object&&self,Ne=Re||Ie||Function("return this")(),Me=e&&!e.nodeType&&e,Pe=Me&&"object"==typeof n&&n&&!n.nodeType&&n,De=Pe&&Pe.exports===Me,ke=De&&Re.process,je=function(){try{var t=Pe&&Pe.require&&Pe.require("util").types;return t||ke&&ke.binding&&ke.binding("util")}catch(t){}}(),Ue=je&&je.isArrayBuffer,ze=je&&je.isDate,Le=je&&je.isMap,Be=je&&je.isRegExp,Fe=je&&je.isSet,He=je&&je.isTypedArray;function qe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ge(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function Ve(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Ye(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function We(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function $e(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function Je(t,e){return!!(null==t?0:t.length)&&an(t,e,0)>-1}function Xe(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Ke(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Qe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Ze(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function tn(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function en(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var nn=ln("length");function rn(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function on(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function an(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):on(t,cn,n)}function sn(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function cn(t){return t!=t}function un(t,e){var n=null==t?0:t.length;return n?hn(t,e)/n:D}function ln(t){return function(e){return null==e?r:e[t]}}function fn(t){return function(e){return null==t?r:t[e]}}function dn(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function hn(t,e){for(var n,i=-1,o=t.length;++i<o;){var a=e(t[i]);a!==r&&(n=n===r?a:n+a)}return n}function pn(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function mn(t){return function(e){return t(e)}}function gn(t,e){return Ke(e,function(e){return t[e]})}function vn(t,e){return t.has(e)}function _n(t,e){for(var n=-1,r=t.length;++n<r&&an(e,t[n],0)>-1;);return n}function yn(t,e){for(var n=t.length;n--&&an(e,t[n],0)>-1;);return n}var bn=fn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Sn=fn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Tn(t){return"\\"+Ae[t]}function En(t){return be.test(t)}function Cn(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function wn(t,e){return function(n){return t(e(n))}}function An(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&a!==u||(t[n]=u,o[i++]=n)}return o}function On(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function xn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function Rn(t){return En(t)?function(t){var e=_e.lastIndex=0;for(;_e.test(t);)++e;return e}(t):nn(t)}function In(t){return En(t)?function(t){return t.match(_e)||[]}(t):function(t){return t.split("")}(t)}var Nn=fn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Mn=function t(e){var n,Xt=(e=null==e?Ne:Mn.defaults(Ne.Object(),e,Mn.pick(Ne,Te))).Array,Kt=e.Date,Qt=e.Error,Zt=e.Function,te=e.Math,ee=e.Object,ne=e.RegExp,re=e.String,ie=e.TypeError,oe=Xt.prototype,ae=Zt.prototype,se=ee.prototype,ce=e["__core-js_shared__"],ue=ae.toString,le=se.hasOwnProperty,fe=0,de=(n=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",he=se.toString,pe=ue.call(ee),me=Ne._,_e=ne("^"+ue.call(le).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),be=De?e.Buffer:r,Ae=e.Symbol,Re=e.Uint8Array,Ie=be?be.allocUnsafe:r,Me=wn(ee.getPrototypeOf,ee),Pe=ee.create,ke=se.propertyIsEnumerable,je=oe.splice,nn=Ae?Ae.isConcatSpreadable:r,fn=Ae?Ae.iterator:r,Pn=Ae?Ae.toStringTag:r,Dn=function(){try{var t=Lo(ee,"defineProperty");return t({},"",{}),t}catch(t){}}(),kn=e.clearTimeout!==Ne.clearTimeout&&e.clearTimeout,jn=Kt&&Kt.now!==Ne.Date.now&&Kt.now,Un=e.setTimeout!==Ne.setTimeout&&e.setTimeout,zn=te.ceil,Ln=te.floor,Bn=ee.getOwnPropertySymbols,Fn=be?be.isBuffer:r,Hn=e.isFinite,qn=oe.join,Gn=wn(ee.keys,ee),Vn=te.max,Yn=te.min,Wn=Kt.now,$n=e.parseInt,Jn=te.random,Xn=oe.reverse,Kn=Lo(e,"DataView"),Qn=Lo(e,"Map"),Zn=Lo(e,"Promise"),tr=Lo(e,"Set"),er=Lo(e,"WeakMap"),nr=Lo(ee,"create"),rr=er&&new er,ir={},or=fa(Kn),ar=fa(Qn),sr=fa(Zn),cr=fa(tr),ur=fa(er),lr=Ae?Ae.prototype:r,fr=lr?lr.valueOf:r,dr=lr?lr.toString:r;function hr(t){if(xs(t)&&!vs(t)&&!(t instanceof vr)){if(t instanceof gr)return t;if(le.call(t,"__wrapped__"))return da(t)}return new gr(t)}var pr=function(){function t(){}return function(e){if(!Os(e))return{};if(Pe)return Pe(e);t.prototype=e;var n=new t;return t.prototype=r,n}}();function mr(){}function gr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=r}function vr(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=k,this.__views__=[]}function _r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function yr(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function br(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Sr(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new br;++e<n;)this.add(t[e])}function Tr(t){var e=this.__data__=new yr(t);this.size=e.size}function Er(t,e){var n=vs(t),r=!n&&gs(t),i=!n&&!r&&Ss(t),o=!n&&!r&&!i&&js(t),a=n||r||i||o,s=a?pn(t.length,re):[],c=s.length;for(var u in t)!e&&!le.call(t,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Yo(u,c))||s.push(u);return s}function Cr(t){var e=t.length;return e?t[Si(0,e-1)]:r}function wr(t,e){return ca(no(t),Dr(e,0,t.length))}function Ar(t){return ca(no(t))}function Or(t,e,n){(n===r||hs(t[e],n))&&(n!==r||e in t)||Mr(t,e,n)}function xr(t,e,n){var i=t[e];le.call(t,e)&&hs(i,n)&&(n!==r||e in t)||Mr(t,e,n)}function Rr(t,e){for(var n=t.length;n--;)if(hs(t[n][0],e))return n;return-1}function Ir(t,e,n,r){return Lr(t,function(t,i,o){e(r,t,n(t),o)}),r}function Nr(t,e){return t&&ro(e,ic(e),t)}function Mr(t,e,n){"__proto__"==e&&Dn?Dn(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Pr(t,e){for(var n=-1,i=e.length,o=Xt(i),a=null==t;++n<i;)o[n]=a?r:Zs(t,e[n]);return o}function Dr(t,e,n){return t==t&&(n!==r&&(t=t<=n?t:n),e!==r&&(t=t>=e?t:e)),t}function kr(t,e,n,i,o,a){var s,c=e&l,u=e&f,h=e&d;if(n&&(s=o?n(t,i,o,a):n(t)),s!==r)return s;if(!Os(t))return t;var p=vs(t);if(p){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&le.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!c)return no(t,s)}else{var m=Ho(t),g=m==Y||m==W;if(Ss(t))return Xi(t,c);if(m==K||m==L||g&&!o){if(s=u||g?{}:Go(t),!c)return u?function(t,e){return ro(t,Fo(t),e)}(t,function(t,e){return t&&ro(e,oc(e),t)}(s,t)):function(t,e){return ro(t,Bo(t),e)}(t,Nr(s,t))}else{if(!we[m])return o?t:{};s=function(t,e,n){var r,i=t.constructor;switch(e){case at:return Ki(t);case H:case q:return new i(+t);case st:return function(t,e){var n=e?Ki(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case ct:case ut:case lt:case ft:case dt:case ht:case pt:case mt:case gt:return Qi(t,n);case $:return new i;case J:case et:return new i(t);case Z:return function(t){var e=new t.constructor(t.source,Ft.exec(t));return e.lastIndex=t.lastIndex,e}(t);case tt:return new i;case nt:return r=t,fr?ee(fr.call(r)):{}}}(t,m,c)}}a||(a=new Tr);var v=a.get(t);if(v)return v;if(a.set(t,s),Ps(t))return t.forEach(function(r){s.add(kr(r,e,n,r,t,a))}),s;if(Rs(t))return t.forEach(function(r,i){s.set(i,kr(r,e,n,i,t,a))}),s;var _=p?r:(h?u?Mo:No:u?oc:ic)(t);return Ve(_||t,function(r,i){_&&(r=t[i=r]),xr(s,i,kr(r,e,n,i,t,a))}),s}function jr(t,e,n){var i=n.length;if(null==t)return!i;for(t=ee(t);i--;){var o=n[i],a=e[o],s=t[o];if(s===r&&!(o in t)||!a(s))return!1}return!0}function Ur(t,e,n){if("function"!=typeof t)throw new ie(a);return ia(function(){t.apply(r,n)},e)}function zr(t,e,n,r){var o=-1,a=Je,s=!0,c=t.length,u=[],l=e.length;if(!c)return u;n&&(e=Ke(e,mn(n))),r?(a=Xe,s=!1):e.length>=i&&(a=vn,s=!1,e=new Sr(e));t:for(;++o<c;){var f=t[o],d=null==n?f:n(f);if(f=r||0!==f?f:0,s&&d==d){for(var h=l;h--;)if(e[h]===d)continue t;u.push(f)}else a(e,d,r)||u.push(f)}return u}hr.templateSettings={escape:Ct,evaluate:wt,interpolate:At,variable:"",imports:{_:hr}},hr.prototype=mr.prototype,hr.prototype.constructor=hr,gr.prototype=pr(mr.prototype),gr.prototype.constructor=gr,vr.prototype=pr(mr.prototype),vr.prototype.constructor=vr,_r.prototype.clear=function(){this.__data__=nr?nr(null):{},this.size=0},_r.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},_r.prototype.get=function(t){var e=this.__data__;if(nr){var n=e[t];return n===s?r:n}return le.call(e,t)?e[t]:r},_r.prototype.has=function(t){var e=this.__data__;return nr?e[t]!==r:le.call(e,t)},_r.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=nr&&e===r?s:e,this},yr.prototype.clear=function(){this.__data__=[],this.size=0},yr.prototype.delete=function(t){var e=this.__data__,n=Rr(e,t);return!(n<0||(n==e.length-1?e.pop():je.call(e,n,1),--this.size,0))},yr.prototype.get=function(t){var e=this.__data__,n=Rr(e,t);return n<0?r:e[n][1]},yr.prototype.has=function(t){return Rr(this.__data__,t)>-1},yr.prototype.set=function(t,e){var n=this.__data__,r=Rr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},br.prototype.clear=function(){this.size=0,this.__data__={hash:new _r,map:new(Qn||yr),string:new _r}},br.prototype.delete=function(t){var e=Uo(this,t).delete(t);return this.size-=e?1:0,e},br.prototype.get=function(t){return Uo(this,t).get(t)},br.prototype.has=function(t){return Uo(this,t).has(t)},br.prototype.set=function(t,e){var n=Uo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Sr.prototype.add=Sr.prototype.push=function(t){return this.__data__.set(t,s),this},Sr.prototype.has=function(t){return this.__data__.has(t)},Tr.prototype.clear=function(){this.__data__=new yr,this.size=0},Tr.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Tr.prototype.get=function(t){return this.__data__.get(t)},Tr.prototype.has=function(t){return this.__data__.has(t)},Tr.prototype.set=function(t,e){var n=this.__data__;if(n instanceof yr){var r=n.__data__;if(!Qn||r.length<i-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new br(r)}return n.set(t,e),this.size=n.size,this};var Lr=ao(Wr),Br=ao($r,!0);function Fr(t,e){var n=!0;return Lr(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Hr(t,e,n){for(var i=-1,o=t.length;++i<o;){var a=t[i],s=e(a);if(null!=s&&(c===r?s==s&&!ks(s):n(s,c)))var c=s,u=a}return u}function qr(t,e){var n=[];return Lr(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function Gr(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=Vo),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?Gr(s,e-1,n,r,i):Qe(i,s):r||(i[i.length]=s)}return i}var Vr=so(),Yr=so(!0);function Wr(t,e){return t&&Vr(t,e,ic)}function $r(t,e){return t&&Yr(t,e,ic)}function Jr(t,e){return $e(e,function(e){return Cs(t[e])})}function Xr(t,e){for(var n=0,i=(e=Yi(e,t)).length;null!=t&&n<i;)t=t[la(e[n++])];return n&&n==i?t:r}function Kr(t,e,n){var r=e(t);return vs(t)?r:Qe(r,n(t))}function Qr(t){return null==t?t===r?rt:X:Pn&&Pn in ee(t)?function(t){var e=le.call(t,Pn),n=t[Pn];try{t[Pn]=r;var i=!0}catch(t){}var o=he.call(t);return i&&(e?t[Pn]=n:delete t[Pn]),o}(t):function(t){return he.call(t)}(t)}function Zr(t,e){return t>e}function ti(t,e){return null!=t&&le.call(t,e)}function ei(t,e){return null!=t&&e in ee(t)}function ni(t,e,n){for(var i=n?Xe:Je,o=t[0].length,a=t.length,s=a,c=Xt(a),u=1/0,l=[];s--;){var f=t[s];s&&e&&(f=Ke(f,mn(e))),u=Yn(f.length,u),c[s]=!n&&(e||o>=120&&f.length>=120)?new Sr(s&&f):r}f=t[0];var d=-1,h=c[0];t:for(;++d<o&&l.length<u;){var p=f[d],m=e?e(p):p;if(p=n||0!==p?p:0,!(h?vn(h,m):i(l,m,n))){for(s=a;--s;){var g=c[s];if(!(g?vn(g,m):i(t[s],m,n)))continue t}h&&h.push(m),l.push(p)}}return l}function ri(t,e,n){var i=null==(t=ea(t,e=Yi(e,t)))?t:t[la(Ea(e))];return null==i?r:qe(i,t,n)}function ii(t){return xs(t)&&Qr(t)==L}function oi(t,e,n,i,o){return t===e||(null==t||null==e||!xs(t)&&!xs(e)?t!=t&&e!=e:function(t,e,n,i,o,a){var s=vs(t),c=vs(e),u=s?B:Ho(t),l=c?B:Ho(e),f=(u=u==L?K:u)==K,d=(l=l==L?K:l)==K,m=u==l;if(m&&Ss(t)){if(!Ss(e))return!1;s=!0,f=!1}if(m&&!f)return a||(a=new Tr),s||js(t)?Ro(t,e,n,i,o,a):function(t,e,n,r,i,o,a){switch(n){case st:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case at:return!(t.byteLength!=e.byteLength||!o(new Re(t),new Re(e)));case H:case q:case J:return hs(+t,+e);case V:return t.name==e.name&&t.message==e.message;case Z:case et:return t==e+"";case $:var s=Cn;case tt:var c=r&h;if(s||(s=On),t.size!=e.size&&!c)return!1;var u=a.get(t);if(u)return u==e;r|=p,a.set(t,e);var l=Ro(s(t),s(e),r,i,o,a);return a.delete(t),l;case nt:if(fr)return fr.call(t)==fr.call(e)}return!1}(t,e,u,n,i,o,a);if(!(n&h)){var g=f&&le.call(t,"__wrapped__"),v=d&&le.call(e,"__wrapped__");if(g||v){var _=g?t.value():t,y=v?e.value():e;return a||(a=new Tr),o(_,y,n,i,a)}}return!!m&&(a||(a=new Tr),function(t,e,n,i,o,a){var s=n&h,c=No(t),u=c.length,l=No(e).length;if(u!=l&&!s)return!1;for(var f=u;f--;){var d=c[f];if(!(s?d in e:le.call(e,d)))return!1}var p=a.get(t);if(p&&a.get(e))return p==e;var m=!0;a.set(t,e),a.set(e,t);for(var g=s;++f<u;){d=c[f];var v=t[d],_=e[d];if(i)var y=s?i(_,v,d,e,t,a):i(v,_,d,t,e,a);if(!(y===r?v===_||o(v,_,n,i,a):y)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var b=t.constructor,S=e.constructor;b!=S&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof S&&S instanceof S)&&(m=!1)}return a.delete(t),a.delete(e),m}(t,e,n,i,o,a))}(t,e,n,i,oi,o))}function ai(t,e,n,i){var o=n.length,a=o,s=!i;if(null==t)return!a;for(t=ee(t);o--;){var c=n[o];if(s&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<a;){var u=(c=n[o])[0],l=t[u],f=c[1];if(s&&c[2]){if(l===r&&!(u in t))return!1}else{var d=new Tr;if(i)var m=i(l,f,u,t,e,d);if(!(m===r?oi(f,l,h|p,i,d):m))return!1}}return!0}function si(t){return!(!Os(t)||(e=t,de&&de in e))&&(Cs(t)?_e:Gt).test(fa(t));var e}function ci(t){return"function"==typeof t?t:null==t?Ic:"object"==typeof t?vs(t)?pi(t[0],t[1]):hi(t):Lc(t)}function ui(t){if(!Ko(t))return Gn(t);var e=[];for(var n in ee(t))le.call(t,n)&&"constructor"!=n&&e.push(n);return e}function li(t){if(!Os(t))return function(t){var e=[];if(null!=t)for(var n in ee(t))e.push(n);return e}(t);var e=Ko(t),n=[];for(var r in t)("constructor"!=r||!e&&le.call(t,r))&&n.push(r);return n}function fi(t,e){return t<e}function di(t,e){var n=-1,r=ys(t)?Xt(t.length):[];return Lr(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function hi(t){var e=zo(t);return 1==e.length&&e[0][2]?Zo(e[0][0],e[0][1]):function(n){return n===t||ai(n,t,e)}}function pi(t,e){return $o(t)&&Qo(e)?Zo(la(t),e):function(n){var i=Zs(n,t);return i===r&&i===e?tc(n,t):oi(e,i,h|p)}}function mi(t,e,n,i,o){t!==e&&Vr(e,function(a,s){if(Os(a))o||(o=new Tr),function(t,e,n,i,o,a,s){var c=na(t,n),u=na(e,n),l=s.get(u);if(l)Or(t,n,l);else{var f=a?a(c,u,n+"",t,e,s):r,d=f===r;if(d){var h=vs(u),p=!h&&Ss(u),m=!h&&!p&&js(u);f=u,h||p||m?vs(c)?f=c:bs(c)?f=no(c):p?(d=!1,f=Xi(u,!0)):m?(d=!1,f=Qi(u,!0)):f=[]:Ns(u)||gs(u)?(f=c,gs(c)?f=Gs(c):Os(c)&&!Cs(c)||(f=Go(u))):d=!1}d&&(s.set(u,f),o(f,u,i,a,s),s.delete(u)),Or(t,n,f)}}(t,e,s,n,mi,i,o);else{var c=i?i(na(t,s),a,s+"",t,e,o):r;c===r&&(c=a),Or(t,s,c)}},oc)}function gi(t,e){var n=t.length;if(n)return Yo(e+=e<0?n:0,n)?t[e]:r}function vi(t,e,n){var r=-1;return e=Ke(e.length?e:[Ic],mn(jo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(di(t,function(t,n,i){return{criteria:Ke(e,function(e){return e(t)}),index:++r,value:t}}),function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;++r<a;){var c=Zi(i[r],o[r]);if(c){if(r>=s)return c;var u=n[r];return c*("desc"==u?-1:1)}}return t.index-e.index}(t,e,n)})}function _i(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=Xr(t,a);n(s,a)&&Ai(o,Yi(a,t),s)}return o}function yi(t,e,n,r){var i=r?sn:an,o=-1,a=e.length,s=t;for(t===e&&(e=no(e)),n&&(s=Ke(t,mn(n)));++o<a;)for(var c=0,u=e[o],l=n?n(u):u;(c=i(s,l,c,r))>-1;)s!==t&&je.call(s,c,1),je.call(t,c,1);return t}function bi(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;Yo(i)?je.call(t,i,1):zi(t,i)}}return t}function Si(t,e){return t+Ln(Jn()*(e-t+1))}function Ti(t,e){var n="";if(!t||e<1||e>M)return n;do{e%2&&(n+=t),(e=Ln(e/2))&&(t+=t)}while(e);return n}function Ei(t,e){return oa(ta(t,e,Ic),t+"")}function Ci(t){return Cr(hc(t))}function wi(t,e){var n=hc(t);return ca(n,Dr(e,0,n.length))}function Ai(t,e,n,i){if(!Os(t))return t;for(var o=-1,a=(e=Yi(e,t)).length,s=a-1,c=t;null!=c&&++o<a;){var u=la(e[o]),l=n;if(o!=s){var f=c[u];(l=i?i(f,u,c):r)===r&&(l=Os(f)?f:Yo(e[o+1])?[]:{})}xr(c,u,l),c=c[u]}return t}var Oi=rr?function(t,e){return rr.set(t,e),t}:Ic,xi=Dn?function(t,e){return Dn(t,"toString",{configurable:!0,enumerable:!1,value:Oc(e),writable:!0})}:Ic;function Ri(t){return ca(hc(t))}function Ii(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Xt(i);++r<i;)o[r]=t[r+e];return o}function Ni(t,e){var n;return Lr(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function Mi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=U){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!ks(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return Pi(t,e,Ic,n)}function Pi(t,e,n,i){e=n(e);for(var o=0,a=null==t?0:t.length,s=e!=e,c=null===e,u=ks(e),l=e===r;o<a;){var f=Ln((o+a)/2),d=n(t[f]),h=d!==r,p=null===d,m=d==d,g=ks(d);if(s)var v=i||m;else v=l?m&&(i||h):c?m&&h&&(i||!p):u?m&&h&&!p&&(i||!g):!p&&!g&&(i?d<=e:d<e);v?o=f+1:a=f}return Yn(a,j)}function Di(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!hs(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function ki(t){return"number"==typeof t?t:ks(t)?D:+t}function ji(t){if("string"==typeof t)return t;if(vs(t))return Ke(t,ji)+"";if(ks(t))return dr?dr.call(t):"";var e=t+"";return"0"==e&&1/t==-N?"-0":e}function Ui(t,e,n){var r=-1,o=Je,a=t.length,s=!0,c=[],u=c;if(n)s=!1,o=Xe;else if(a>=i){var l=e?null:Eo(t);if(l)return On(l);s=!1,o=vn,u=new Sr}else u=e?[]:c;t:for(;++r<a;){var f=t[r],d=e?e(f):f;if(f=n||0!==f?f:0,s&&d==d){for(var h=u.length;h--;)if(u[h]===d)continue t;e&&u.push(d),c.push(f)}else o(u,d,n)||(u!==c&&u.push(d),c.push(f))}return c}function zi(t,e){return null==(t=ea(t,e=Yi(e,t)))||delete t[la(Ea(e))]}function Li(t,e,n,r){return Ai(t,e,n(Xr(t,e)),r)}function Bi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Ii(t,r?0:o,r?o+1:i):Ii(t,r?o+1:0,r?i:o)}function Fi(t,e){var n=t;return n instanceof vr&&(n=n.value()),Ze(e,function(t,e){return e.func.apply(e.thisArg,Qe([t],e.args))},n)}function Hi(t,e,n){var r=t.length;if(r<2)return r?Ui(t[0]):[];for(var i=-1,o=Xt(r);++i<r;)for(var a=t[i],s=-1;++s<r;)s!=i&&(o[i]=zr(o[i]||a,t[s],e,n));return Ui(Gr(o,1),e,n)}function qi(t,e,n){for(var i=-1,o=t.length,a=e.length,s={};++i<o;){var c=i<a?e[i]:r;n(s,t[i],c)}return s}function Gi(t){return bs(t)?t:[]}function Vi(t){return"function"==typeof t?t:Ic}function Yi(t,e){return vs(t)?t:$o(t,e)?[t]:ua(Vs(t))}var Wi=Ei;function $i(t,e,n){var i=t.length;return n=n===r?i:n,!e&&n>=i?t:Ii(t,e,n)}var Ji=kn||function(t){return Ne.clearTimeout(t)};function Xi(t,e){if(e)return t.slice();var n=t.length,r=Ie?Ie(n):new t.constructor(n);return t.copy(r),r}function Ki(t){var e=new t.constructor(t.byteLength);return new Re(e).set(new Re(t)),e}function Qi(t,e){var n=e?Ki(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Zi(t,e){if(t!==e){var n=t!==r,i=null===t,o=t==t,a=ks(t),s=e!==r,c=null===e,u=e==e,l=ks(e);if(!c&&!l&&!a&&t>e||a&&s&&u&&!c&&!l||i&&s&&u||!n&&u||!o)return 1;if(!i&&!a&&!l&&t<e||l&&n&&o&&!i&&!a||c&&n&&o||!s&&o||!u)return-1}return 0}function to(t,e,n,r){for(var i=-1,o=t.length,a=n.length,s=-1,c=e.length,u=Vn(o-a,0),l=Xt(c+u),f=!r;++s<c;)l[s]=e[s];for(;++i<a;)(f||i<o)&&(l[n[i]]=t[i]);for(;u--;)l[s++]=t[i++];return l}function eo(t,e,n,r){for(var i=-1,o=t.length,a=-1,s=n.length,c=-1,u=e.length,l=Vn(o-s,0),f=Xt(l+u),d=!r;++i<l;)f[i]=t[i];for(var h=i;++c<u;)f[h+c]=e[c];for(;++a<s;)(d||i<o)&&(f[h+n[a]]=t[i++]);return f}function no(t,e){var n=-1,r=t.length;for(e||(e=Xt(r));++n<r;)e[n]=t[n];return e}function ro(t,e,n,i){var o=!n;n||(n={});for(var a=-1,s=e.length;++a<s;){var c=e[a],u=i?i(n[c],t[c],c,n,t):r;u===r&&(u=t[c]),o?Mr(n,c,u):xr(n,c,u)}return n}function io(t,e){return function(n,r){var i=vs(n)?Ge:Ir,o=e?e():{};return i(n,t,jo(r,2),o)}}function oo(t){return Ei(function(e,n){var i=-1,o=n.length,a=o>1?n[o-1]:r,s=o>2?n[2]:r;for(a=t.length>3&&"function"==typeof a?(o--,a):r,s&&Wo(n[0],n[1],s)&&(a=o<3?r:a,o=1),e=ee(e);++i<o;){var c=n[i];c&&t(e,c,i,a)}return e})}function ao(t,e){return function(n,r){if(null==n)return n;if(!ys(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=ee(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function so(t){return function(e,n,r){for(var i=-1,o=ee(e),a=r(e),s=a.length;s--;){var c=a[t?s:++i];if(!1===n(o[c],c,o))break}return e}}function co(t){return function(e){var n=En(e=Vs(e))?In(e):r,i=n?n[0]:e.charAt(0),o=n?$i(n,1).join(""):e.slice(1);return i[t]()+o}}function uo(t){return function(e){return Ze(Cc(gc(e).replace(ge,"")),t,"")}}function lo(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=pr(t.prototype),r=t.apply(n,e);return Os(r)?r:n}}function fo(t){return function(e,n,i){var o=ee(e);if(!ys(e)){var a=jo(n,3);e=ic(e),n=function(t){return a(o[t],t,o)}}var s=t(e,n,i);return s>-1?o[a?e[s]:s]:r}}function ho(t){return Io(function(e){var n=e.length,i=n,o=gr.prototype.thru;for(t&&e.reverse();i--;){var s=e[i];if("function"!=typeof s)throw new ie(a);if(o&&!c&&"wrapper"==Do(s))var c=new gr([],!0)}for(i=c?i:n;++i<n;){var u=Do(s=e[i]),l="wrapper"==u?Po(s):r;c=l&&Jo(l[0])&&l[1]==(T|_|b|E)&&!l[4].length&&1==l[9]?c[Do(l[0])].apply(c,l[3]):1==s.length&&Jo(s)?c[u]():c.thru(s)}return function(){var t=arguments,r=t[0];if(c&&1==t.length&&vs(r))return c.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}function po(t,e,n,i,o,a,s,c,u,l){var f=e&T,d=e&m,h=e&g,p=e&(_|y),v=e&C,b=h?r:lo(t);return function m(){for(var g=arguments.length,_=Xt(g),y=g;y--;)_[y]=arguments[y];if(p)var S=ko(m),T=function(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}(_,S);if(i&&(_=to(_,i,o,p)),a&&(_=eo(_,a,s,p)),g-=T,p&&g<l){var E=An(_,S);return So(t,e,po,m.placeholder,n,_,E,c,u,l-g)}var C=d?n:this,w=h?C[t]:t;return g=_.length,c?_=function(t,e){for(var n=t.length,i=Yn(e.length,n),o=no(t);i--;){var a=e[i];t[i]=Yo(a,n)?o[a]:r}return t}(_,c):v&&g>1&&_.reverse(),f&&u<g&&(_.length=u),this&&this!==Ne&&this instanceof m&&(w=b||lo(w)),w.apply(C,_)}}function mo(t,e){return function(n,r){return function(t,e,n,r){return Wr(t,function(t,i,o){e(r,n(t),i,o)}),r}(n,t,e(r),{})}}function go(t,e){return function(n,i){var o;if(n===r&&i===r)return e;if(n!==r&&(o=n),i!==r){if(o===r)return i;"string"==typeof n||"string"==typeof i?(n=ji(n),i=ji(i)):(n=ki(n),i=ki(i)),o=t(n,i)}return o}}function vo(t){return Io(function(e){return e=Ke(e,mn(jo())),Ei(function(n){var r=this;return t(e,function(t){return qe(t,r,n)})})})}function _o(t,e){var n=(e=e===r?" ":ji(e)).length;if(n<2)return n?Ti(e,t):e;var i=Ti(e,zn(t/Rn(e)));return En(e)?$i(In(i),0,t).join(""):i.slice(0,t)}function yo(t){return function(e,n,i){return i&&"number"!=typeof i&&Wo(e,n,i)&&(n=i=r),e=Bs(e),n===r?(n=e,e=0):n=Bs(n),function(t,e,n,r){for(var i=-1,o=Vn(zn((e-t)/(n||1)),0),a=Xt(o);o--;)a[r?o:++i]=t,t+=n;return a}(e,n,i=i===r?e<n?1:-1:Bs(i),t)}}function bo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=qs(e),n=qs(n)),t(e,n)}}function So(t,e,n,i,o,a,s,c,u,l){var f=e&_;e|=f?b:S,(e&=~(f?S:b))&v||(e&=~(m|g));var d=[t,e,o,f?a:r,f?s:r,f?r:a,f?r:s,c,u,l],h=n.apply(r,d);return Jo(t)&&ra(h,d),h.placeholder=i,aa(h,t,e)}function To(t){var e=te[t];return function(t,n){if(t=qs(t),n=null==n?0:Yn(Fs(n),292)){var r=(Vs(t)+"e").split("e");return+((r=(Vs(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Eo=tr&&1/On(new tr([,-0]))[1]==N?function(t){return new tr(t)}:kc;function Co(t){return function(e){var n=Ho(e);return n==$?Cn(e):n==tt?xn(e):function(t,e){return Ke(e,function(e){return[e,t[e]]})}(e,t(e))}}function wo(t,e,n,i,o,s,c,l){var f=e&g;if(!f&&"function"!=typeof t)throw new ie(a);var d=i?i.length:0;if(d||(e&=~(b|S),i=o=r),c=c===r?c:Vn(Fs(c),0),l=l===r?l:Fs(l),d-=o?o.length:0,e&S){var h=i,p=o;i=o=r}var C=f?r:Po(t),w=[t,e,n,i,o,h,p,s,c,l];if(C&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<(m|g|T),a=r==T&&n==_||r==T&&n==E&&t[7].length<=e[8]||r==(T|E)&&e[7].length<=e[8]&&n==_;if(!o&&!a)return t;r&m&&(t[2]=e[2],i|=n&m?0:v);var s=e[3];if(s){var c=t[3];t[3]=c?to(c,s,e[4]):s,t[4]=c?An(t[3],u):e[4]}(s=e[5])&&(c=t[5],t[5]=c?eo(c,s,e[6]):s,t[6]=c?An(t[5],u):e[6]),(s=e[7])&&(t[7]=s),r&T&&(t[8]=null==t[8]?e[8]:Yn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(w,C),t=w[0],e=w[1],n=w[2],i=w[3],o=w[4],!(l=w[9]=w[9]===r?f?0:t.length:Vn(w[9]-d,0))&&e&(_|y)&&(e&=~(_|y)),e&&e!=m)A=e==_||e==y?function(t,e,n){var i=lo(t);return function o(){for(var a=arguments.length,s=Xt(a),c=a,u=ko(o);c--;)s[c]=arguments[c];var l=a<3&&s[0]!==u&&s[a-1]!==u?[]:An(s,u);return(a-=l.length)<n?So(t,e,po,o.placeholder,r,s,l,r,r,n-a):qe(this&&this!==Ne&&this instanceof o?i:t,this,s)}}(t,e,l):e!=b&&e!=(m|b)||o.length?po.apply(r,w):function(t,e,n,r){var i=e&m,o=lo(t);return function e(){for(var a=-1,s=arguments.length,c=-1,u=r.length,l=Xt(u+s),f=this&&this!==Ne&&this instanceof e?o:t;++c<u;)l[c]=r[c];for(;s--;)l[c++]=arguments[++a];return qe(f,i?n:this,l)}}(t,e,n,i);else var A=function(t,e,n){var r=e&m,i=lo(t);return function e(){return(this&&this!==Ne&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,n);return aa((C?Oi:ra)(A,w),t,e)}function Ao(t,e,n,i){return t===r||hs(t,se[n])&&!le.call(i,n)?e:t}function Oo(t,e,n,i,o,a){return Os(t)&&Os(e)&&(a.set(e,t),mi(t,e,r,Oo,a),a.delete(e)),t}function xo(t){return Ns(t)?r:t}function Ro(t,e,n,i,o,a){var s=n&h,c=t.length,u=e.length;if(c!=u&&!(s&&u>c))return!1;var l=a.get(t);if(l&&a.get(e))return l==e;var f=-1,d=!0,m=n&p?new Sr:r;for(a.set(t,e),a.set(e,t);++f<c;){var g=t[f],v=e[f];if(i)var _=s?i(v,g,f,e,t,a):i(g,v,f,t,e,a);if(_!==r){if(_)continue;d=!1;break}if(m){if(!en(e,function(t,e){if(!vn(m,e)&&(g===t||o(g,t,n,i,a)))return m.push(e)})){d=!1;break}}else if(g!==v&&!o(g,v,n,i,a)){d=!1;break}}return a.delete(t),a.delete(e),d}function Io(t){return oa(ta(t,r,_a),t+"")}function No(t){return Kr(t,ic,Bo)}function Mo(t){return Kr(t,oc,Fo)}var Po=rr?function(t){return rr.get(t)}:kc;function Do(t){for(var e=t.name+"",n=ir[e],r=le.call(ir,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function ko(t){return(le.call(hr,"placeholder")?hr:t).placeholder}function jo(){var t=hr.iteratee||Nc;return t=t===Nc?ci:t,arguments.length?t(arguments[0],arguments[1]):t}function Uo(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function zo(t){for(var e=ic(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Qo(i)]}return e}function Lo(t,e){var n=function(t,e){return null==t?r:t[e]}(t,e);return si(n)?n:r}var Bo=Bn?function(t){return null==t?[]:(t=ee(t),$e(Bn(t),function(e){return ke.call(t,e)}))}:Hc,Fo=Bn?function(t){for(var e=[];t;)Qe(e,Bo(t)),t=Me(t);return e}:Hc,Ho=Qr;function qo(t,e,n){for(var r=-1,i=(e=Yi(e,t)).length,o=!1;++r<i;){var a=la(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&As(i)&&Yo(a,i)&&(vs(t)||gs(t))}function Go(t){return"function"!=typeof t.constructor||Ko(t)?{}:pr(Me(t))}function Vo(t){return vs(t)||gs(t)||!!(nn&&t&&t[nn])}function Yo(t,e){var n=typeof t;return!!(e=null==e?M:e)&&("number"==n||"symbol"!=n&&Yt.test(t))&&t>-1&&t%1==0&&t<e}function Wo(t,e,n){if(!Os(n))return!1;var r=typeof e;return!!("number"==r?ys(n)&&Yo(e,n.length):"string"==r&&e in n)&&hs(n[e],t)}function $o(t,e){if(vs(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ks(t))||xt.test(t)||!Ot.test(t)||null!=e&&t in ee(e)}function Jo(t){var e=Do(t),n=hr[e];if("function"!=typeof n||!(e in vr.prototype))return!1;if(t===n)return!0;var r=Po(n);return!!r&&t===r[0]}(Kn&&Ho(new Kn(new ArrayBuffer(1)))!=st||Qn&&Ho(new Qn)!=$||Zn&&"[object Promise]"!=Ho(Zn.resolve())||tr&&Ho(new tr)!=tt||er&&Ho(new er)!=it)&&(Ho=function(t){var e=Qr(t),n=e==K?t.constructor:r,i=n?fa(n):"";if(i)switch(i){case or:return st;case ar:return $;case sr:return"[object Promise]";case cr:return tt;case ur:return it}return e});var Xo=ce?Cs:qc;function Ko(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||se)}function Qo(t){return t==t&&!Os(t)}function Zo(t,e){return function(n){return null!=n&&n[t]===e&&(e!==r||t in ee(n))}}function ta(t,e,n){return e=Vn(e===r?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=Vn(r.length-e,0),a=Xt(o);++i<o;)a[i]=r[e+i];i=-1;for(var s=Xt(e+1);++i<e;)s[i]=r[i];return s[e]=n(a),qe(t,this,s)}}function ea(t,e){return e.length<2?t:Xr(t,Ii(e,0,-1))}function na(t,e){if("__proto__"!=e)return t[e]}var ra=sa(Oi),ia=Un||function(t,e){return Ne.setTimeout(t,e)},oa=sa(xi);function aa(t,e,n){var r=e+"";return oa(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(kt,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ve(z,function(n){var r="_."+n[0];e&n[1]&&!Je(t,r)&&t.push(r)}),t.sort()}(function(t){var e=t.match(jt);return e?e[1].split(Ut):[]}(r),n)))}function sa(t){var e=0,n=0;return function(){var i=Wn(),o=x-(i-n);if(n=i,o>0){if(++e>=O)return arguments[0]}else e=0;return t.apply(r,arguments)}}function ca(t,e){var n=-1,i=t.length,o=i-1;for(e=e===r?i:e;++n<e;){var a=Si(n,o),s=t[a];t[a]=t[n],t[n]=s}return t.length=e,t}var ua=function(t){var e=ss(t,function(t){return n.size===c&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Rt,function(t,n,r,i){e.push(r?i.replace(Lt,"$1"):n||t)}),e});function la(t){if("string"==typeof t||ks(t))return t;var e=t+"";return"0"==e&&1/t==-N?"-0":e}function fa(t){if(null!=t){try{return ue.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function da(t){if(t instanceof vr)return t.clone();var e=new gr(t.__wrapped__,t.__chain__);return e.__actions__=no(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var ha=Ei(function(t,e){return bs(t)?zr(t,Gr(e,1,bs,!0)):[]}),pa=Ei(function(t,e){var n=Ea(e);return bs(n)&&(n=r),bs(t)?zr(t,Gr(e,1,bs,!0),jo(n,2)):[]}),ma=Ei(function(t,e){var n=Ea(e);return bs(n)&&(n=r),bs(t)?zr(t,Gr(e,1,bs,!0),r,n):[]});function ga(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Fs(n);return i<0&&(i=Vn(r+i,0)),on(t,jo(e,3),i)}function va(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var o=i-1;return n!==r&&(o=Fs(n),o=n<0?Vn(i+o,0):Yn(o,i-1)),on(t,jo(e,3),o,!0)}function _a(t){return null!=t&&t.length?Gr(t,1):[]}function ya(t){return t&&t.length?t[0]:r}var ba=Ei(function(t){var e=Ke(t,Gi);return e.length&&e[0]===t[0]?ni(e):[]}),Sa=Ei(function(t){var e=Ea(t),n=Ke(t,Gi);return e===Ea(n)?e=r:n.pop(),n.length&&n[0]===t[0]?ni(n,jo(e,2)):[]}),Ta=Ei(function(t){var e=Ea(t),n=Ke(t,Gi);return(e="function"==typeof e?e:r)&&n.pop(),n.length&&n[0]===t[0]?ni(n,r,e):[]});function Ea(t){var e=null==t?0:t.length;return e?t[e-1]:r}var Ca=Ei(wa);function wa(t,e){return t&&t.length&&e&&e.length?yi(t,e):t}var Aa=Io(function(t,e){var n=null==t?0:t.length,r=Pr(t,e);return bi(t,Ke(e,function(t){return Yo(t,n)?+t:t}).sort(Zi)),r});function Oa(t){return null==t?t:Xn.call(t)}var xa=Ei(function(t){return Ui(Gr(t,1,bs,!0))}),Ra=Ei(function(t){var e=Ea(t);return bs(e)&&(e=r),Ui(Gr(t,1,bs,!0),jo(e,2))}),Ia=Ei(function(t){var e=Ea(t);return e="function"==typeof e?e:r,Ui(Gr(t,1,bs,!0),r,e)});function Na(t){if(!t||!t.length)return[];var e=0;return t=$e(t,function(t){if(bs(t))return e=Vn(t.length,e),!0}),pn(e,function(e){return Ke(t,ln(e))})}function Ma(t,e){if(!t||!t.length)return[];var n=Na(t);return null==e?n:Ke(n,function(t){return qe(e,r,t)})}var Pa=Ei(function(t,e){return bs(t)?zr(t,e):[]}),Da=Ei(function(t){return Hi($e(t,bs))}),ka=Ei(function(t){var e=Ea(t);return bs(e)&&(e=r),Hi($e(t,bs),jo(e,2))}),ja=Ei(function(t){var e=Ea(t);return e="function"==typeof e?e:r,Hi($e(t,bs),r,e)}),Ua=Ei(Na);var za=Ei(function(t){var e=t.length,n=e>1?t[e-1]:r;return n="function"==typeof n?(t.pop(),n):r,Ma(t,n)});function La(t){var e=hr(t);return e.__chain__=!0,e}function Ba(t,e){return e(t)}var Fa=Io(function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,o=function(e){return Pr(e,t)};return!(e>1||this.__actions__.length)&&i instanceof vr&&Yo(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:Ba,args:[o],thisArg:r}),new gr(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(r),t})):this.thru(o)});var Ha=io(function(t,e,n){le.call(t,n)?++t[n]:Mr(t,n,1)});var qa=fo(ga),Ga=fo(va);function Va(t,e){return(vs(t)?Ve:Lr)(t,jo(e,3))}function Ya(t,e){return(vs(t)?Ye:Br)(t,jo(e,3))}var Wa=io(function(t,e,n){le.call(t,n)?t[n].push(e):Mr(t,n,[e])});var $a=Ei(function(t,e,n){var r=-1,i="function"==typeof e,o=ys(t)?Xt(t.length):[];return Lr(t,function(t){o[++r]=i?qe(e,t,n):ri(t,e,n)}),o}),Ja=io(function(t,e,n){Mr(t,n,e)});function Xa(t,e){return(vs(t)?Ke:di)(t,jo(e,3))}var Ka=io(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});var Qa=Ei(function(t,e){if(null==t)return[];var n=e.length;return n>1&&Wo(t,e[0],e[1])?e=[]:n>2&&Wo(e[0],e[1],e[2])&&(e=[e[0]]),vi(t,Gr(e,1),[])}),Za=jn||function(){return Ne.Date.now()};function ts(t,e,n){return e=n?r:e,e=t&&null==e?t.length:e,wo(t,T,r,r,r,r,e)}function es(t,e){var n;if("function"!=typeof e)throw new ie(a);return t=Fs(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=r),n}}var ns=Ei(function(t,e,n){var r=m;if(n.length){var i=An(n,ko(ns));r|=b}return wo(t,r,e,n,i)}),rs=Ei(function(t,e,n){var r=m|g;if(n.length){var i=An(n,ko(rs));r|=b}return wo(e,r,t,n,i)});function is(t,e,n){var i,o,s,c,u,l,f=0,d=!1,h=!1,p=!0;if("function"!=typeof t)throw new ie(a);function m(e){var n=i,a=o;return i=o=r,f=e,c=t.apply(a,n)}function g(t){var n=t-l;return l===r||n>=e||n<0||h&&t-f>=s}function v(){var t=Za();if(g(t))return _(t);u=ia(v,function(t){var n=e-(t-l);return h?Yn(n,s-(t-f)):n}(t))}function _(t){return u=r,p&&i?m(t):(i=o=r,c)}function y(){var t=Za(),n=g(t);if(i=arguments,o=this,l=t,n){if(u===r)return function(t){return f=t,u=ia(v,e),d?m(t):c}(l);if(h)return u=ia(v,e),m(l)}return u===r&&(u=ia(v,e)),c}return e=qs(e)||0,Os(n)&&(d=!!n.leading,s=(h="maxWait"in n)?Vn(qs(n.maxWait)||0,e):s,p="trailing"in n?!!n.trailing:p),y.cancel=function(){u!==r&&Ji(u),f=0,i=l=o=u=r},y.flush=function(){return u===r?c:_(Za())},y}var os=Ei(function(t,e){return Ur(t,1,e)}),as=Ei(function(t,e,n){return Ur(t,qs(e)||0,n)});function ss(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new ie(a);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(ss.Cache||br),n}function cs(t){if("function"!=typeof t)throw new ie(a);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ss.Cache=br;var us=Wi(function(t,e){var n=(e=1==e.length&&vs(e[0])?Ke(e[0],mn(jo())):Ke(Gr(e,1),mn(jo()))).length;return Ei(function(r){for(var i=-1,o=Yn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return qe(t,this,r)})}),ls=Ei(function(t,e){var n=An(e,ko(ls));return wo(t,b,r,e,n)}),fs=Ei(function(t,e){var n=An(e,ko(fs));return wo(t,S,r,e,n)}),ds=Io(function(t,e){return wo(t,E,r,r,r,e)});function hs(t,e){return t===e||t!=t&&e!=e}var ps=bo(Zr),ms=bo(function(t,e){return t>=e}),gs=ii(function(){return arguments}())?ii:function(t){return xs(t)&&le.call(t,"callee")&&!ke.call(t,"callee")},vs=Xt.isArray,_s=Ue?mn(Ue):function(t){return xs(t)&&Qr(t)==at};function ys(t){return null!=t&&As(t.length)&&!Cs(t)}function bs(t){return xs(t)&&ys(t)}var Ss=Fn||qc,Ts=ze?mn(ze):function(t){return xs(t)&&Qr(t)==q};function Es(t){if(!xs(t))return!1;var e=Qr(t);return e==V||e==G||"string"==typeof t.message&&"string"==typeof t.name&&!Ns(t)}function Cs(t){if(!Os(t))return!1;var e=Qr(t);return e==Y||e==W||e==F||e==Q}function ws(t){return"number"==typeof t&&t==Fs(t)}function As(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=M}function Os(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function xs(t){return null!=t&&"object"==typeof t}var Rs=Le?mn(Le):function(t){return xs(t)&&Ho(t)==$};function Is(t){return"number"==typeof t||xs(t)&&Qr(t)==J}function Ns(t){if(!xs(t)||Qr(t)!=K)return!1;var e=Me(t);if(null===e)return!0;var n=le.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ue.call(n)==pe}var Ms=Be?mn(Be):function(t){return xs(t)&&Qr(t)==Z};var Ps=Fe?mn(Fe):function(t){return xs(t)&&Ho(t)==tt};function Ds(t){return"string"==typeof t||!vs(t)&&xs(t)&&Qr(t)==et}function ks(t){return"symbol"==typeof t||xs(t)&&Qr(t)==nt}var js=He?mn(He):function(t){return xs(t)&&As(t.length)&&!!Ce[Qr(t)]};var Us=bo(fi),zs=bo(function(t,e){return t<=e});function Ls(t){if(!t)return[];if(ys(t))return Ds(t)?In(t):no(t);if(fn&&t[fn])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[fn]());var e=Ho(t);return(e==$?Cn:e==tt?On:hc)(t)}function Bs(t){return t?(t=qs(t))===N||t===-N?(t<0?-1:1)*P:t==t?t:0:0===t?t:0}function Fs(t){var e=Bs(t),n=e%1;return e==e?n?e-n:e:0}function Hs(t){return t?Dr(Fs(t),0,k):0}function qs(t){if("number"==typeof t)return t;if(ks(t))return D;if(Os(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Os(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Mt,"");var n=qt.test(t);return n||Vt.test(t)?xe(t.slice(2),n?2:8):Ht.test(t)?D:+t}function Gs(t){return ro(t,oc(t))}function Vs(t){return null==t?"":ji(t)}var Ys=oo(function(t,e){if(Ko(e)||ys(e))ro(e,ic(e),t);else for(var n in e)le.call(e,n)&&xr(t,n,e[n])}),Ws=oo(function(t,e){ro(e,oc(e),t)}),$s=oo(function(t,e,n,r){ro(e,oc(e),t,r)}),Js=oo(function(t,e,n,r){ro(e,ic(e),t,r)}),Xs=Io(Pr);var Ks=Ei(function(t,e){t=ee(t);var n=-1,i=e.length,o=i>2?e[2]:r;for(o&&Wo(e[0],e[1],o)&&(i=1);++n<i;)for(var a=e[n],s=oc(a),c=-1,u=s.length;++c<u;){var l=s[c],f=t[l];(f===r||hs(f,se[l])&&!le.call(t,l))&&(t[l]=a[l])}return t}),Qs=Ei(function(t){return t.push(r,Oo),qe(sc,r,t)});function Zs(t,e,n){var i=null==t?r:Xr(t,e);return i===r?n:i}function tc(t,e){return null!=t&&qo(t,e,ei)}var ec=mo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=he.call(e)),t[e]=n},Oc(Ic)),nc=mo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=he.call(e)),le.call(t,e)?t[e].push(n):t[e]=[n]},jo),rc=Ei(ri);function ic(t){return ys(t)?Er(t):ui(t)}function oc(t){return ys(t)?Er(t,!0):li(t)}var ac=oo(function(t,e,n){mi(t,e,n)}),sc=oo(function(t,e,n,r){mi(t,e,n,r)}),cc=Io(function(t,e){var n={};if(null==t)return n;var r=!1;e=Ke(e,function(e){return e=Yi(e,t),r||(r=e.length>1),e}),ro(t,Mo(t),n),r&&(n=kr(n,l|f|d,xo));for(var i=e.length;i--;)zi(n,e[i]);return n});var uc=Io(function(t,e){return null==t?{}:function(t,e){return _i(t,e,function(e,n){return tc(t,n)})}(t,e)});function lc(t,e){if(null==t)return{};var n=Ke(Mo(t),function(t){return[t]});return e=jo(e),_i(t,n,function(t,n){return e(t,n[0])})}var fc=Co(ic),dc=Co(oc);function hc(t){return null==t?[]:gn(t,ic(t))}var pc=uo(function(t,e,n){return e=e.toLowerCase(),t+(n?mc(e):e)});function mc(t){return Ec(Vs(t).toLowerCase())}function gc(t){return(t=Vs(t))&&t.replace(Wt,bn).replace(ve,"")}var vc=uo(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),_c=uo(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),yc=co("toLowerCase");var bc=uo(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});var Sc=uo(function(t,e,n){return t+(n?" ":"")+Ec(e)});var Tc=uo(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Ec=co("toUpperCase");function Cc(t,e,n){return t=Vs(t),(e=n?r:e)===r?function(t){return Se.test(t)}(t)?function(t){return t.match(ye)||[]}(t):function(t){return t.match(zt)||[]}(t):t.match(e)||[]}var wc=Ei(function(t,e){try{return qe(t,r,e)}catch(t){return Es(t)?t:new Qt(t)}}),Ac=Io(function(t,e){return Ve(e,function(e){e=la(e),Mr(t,e,ns(t[e],t))}),t});function Oc(t){return function(){return t}}var xc=ho(),Rc=ho(!0);function Ic(t){return t}function Nc(t){return ci("function"==typeof t?t:kr(t,l))}var Mc=Ei(function(t,e){return function(n){return ri(n,t,e)}}),Pc=Ei(function(t,e){return function(n){return ri(t,n,e)}});function Dc(t,e,n){var r=ic(e),i=Jr(e,r);null!=n||Os(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=Jr(e,ic(e)));var o=!(Os(n)&&"chain"in n&&!n.chain),a=Cs(t);return Ve(i,function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=no(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Qe([this.value()],arguments))})}),t}function kc(){}var jc=vo(Ke),Uc=vo(We),zc=vo(en);function Lc(t){return $o(t)?ln(la(t)):function(t){return function(e){return Xr(e,t)}}(t)}var Bc=yo(),Fc=yo(!0);function Hc(){return[]}function qc(){return!1}var Gc=go(function(t,e){return t+e},0),Vc=To("ceil"),Yc=go(function(t,e){return t/e},1),Wc=To("floor");var $c,Jc=go(function(t,e){return t*e},1),Xc=To("round"),Kc=go(function(t,e){return t-e},0);return hr.after=function(t,e){if("function"!=typeof e)throw new ie(a);return t=Fs(t),function(){if(--t<1)return e.apply(this,arguments)}},hr.ary=ts,hr.assign=Ys,hr.assignIn=Ws,hr.assignInWith=$s,hr.assignWith=Js,hr.at=Xs,hr.before=es,hr.bind=ns,hr.bindAll=Ac,hr.bindKey=rs,hr.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return vs(t)?t:[t]},hr.chain=La,hr.chunk=function(t,e,n){e=(n?Wo(t,e,n):e===r)?1:Vn(Fs(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var o=0,a=0,s=Xt(zn(i/e));o<i;)s[a++]=Ii(t,o,o+=e);return s},hr.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},hr.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Xt(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Qe(vs(n)?no(n):[n],Gr(e,1))},hr.cond=function(t){var e=null==t?0:t.length,n=jo();return t=e?Ke(t,function(t){if("function"!=typeof t[1])throw new ie(a);return[n(t[0]),t[1]]}):[],Ei(function(n){for(var r=-1;++r<e;){var i=t[r];if(qe(i[0],this,n))return qe(i[1],this,n)}})},hr.conforms=function(t){return function(t){var e=ic(t);return function(n){return jr(n,t,e)}}(kr(t,l))},hr.constant=Oc,hr.countBy=Ha,hr.create=function(t,e){var n=pr(t);return null==e?n:Nr(n,e)},hr.curry=function t(e,n,i){var o=wo(e,_,r,r,r,r,r,n=i?r:n);return o.placeholder=t.placeholder,o},hr.curryRight=function t(e,n,i){var o=wo(e,y,r,r,r,r,r,n=i?r:n);return o.placeholder=t.placeholder,o},hr.debounce=is,hr.defaults=Ks,hr.defaultsDeep=Qs,hr.defer=os,hr.delay=as,hr.difference=ha,hr.differenceBy=pa,hr.differenceWith=ma,hr.drop=function(t,e,n){var i=null==t?0:t.length;return i?Ii(t,(e=n||e===r?1:Fs(e))<0?0:e,i):[]},hr.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?Ii(t,0,(e=i-(e=n||e===r?1:Fs(e)))<0?0:e):[]},hr.dropRightWhile=function(t,e){return t&&t.length?Bi(t,jo(e,3),!0,!0):[]},hr.dropWhile=function(t,e){return t&&t.length?Bi(t,jo(e,3),!0):[]},hr.fill=function(t,e,n,i){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&Wo(t,e,n)&&(n=0,i=o),function(t,e,n,i){var o=t.length;for((n=Fs(n))<0&&(n=-n>o?0:o+n),(i=i===r||i>o?o:Fs(i))<0&&(i+=o),i=n>i?0:Hs(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},hr.filter=function(t,e){return(vs(t)?$e:qr)(t,jo(e,3))},hr.flatMap=function(t,e){return Gr(Xa(t,e),1)},hr.flatMapDeep=function(t,e){return Gr(Xa(t,e),N)},hr.flatMapDepth=function(t,e,n){return n=n===r?1:Fs(n),Gr(Xa(t,e),n)},hr.flatten=_a,hr.flattenDeep=function(t){return null!=t&&t.length?Gr(t,N):[]},hr.flattenDepth=function(t,e){return null!=t&&t.length?Gr(t,e=e===r?1:Fs(e)):[]},hr.flip=function(t){return wo(t,C)},hr.flow=xc,hr.flowRight=Rc,hr.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},hr.functions=function(t){return null==t?[]:Jr(t,ic(t))},hr.functionsIn=function(t){return null==t?[]:Jr(t,oc(t))},hr.groupBy=Wa,hr.initial=function(t){return null!=t&&t.length?Ii(t,0,-1):[]},hr.intersection=ba,hr.intersectionBy=Sa,hr.intersectionWith=Ta,hr.invert=ec,hr.invertBy=nc,hr.invokeMap=$a,hr.iteratee=Nc,hr.keyBy=Ja,hr.keys=ic,hr.keysIn=oc,hr.map=Xa,hr.mapKeys=function(t,e){var n={};return e=jo(e,3),Wr(t,function(t,r,i){Mr(n,e(t,r,i),t)}),n},hr.mapValues=function(t,e){var n={};return e=jo(e,3),Wr(t,function(t,r,i){Mr(n,r,e(t,r,i))}),n},hr.matches=function(t){return hi(kr(t,l))},hr.matchesProperty=function(t,e){return pi(t,kr(e,l))},hr.memoize=ss,hr.merge=ac,hr.mergeWith=sc,hr.method=Mc,hr.methodOf=Pc,hr.mixin=Dc,hr.negate=cs,hr.nthArg=function(t){return t=Fs(t),Ei(function(e){return gi(e,t)})},hr.omit=cc,hr.omitBy=function(t,e){return lc(t,cs(jo(e)))},hr.once=function(t){return es(2,t)},hr.orderBy=function(t,e,n,i){return null==t?[]:(vs(e)||(e=null==e?[]:[e]),vs(n=i?r:n)||(n=null==n?[]:[n]),vi(t,e,n))},hr.over=jc,hr.overArgs=us,hr.overEvery=Uc,hr.overSome=zc,hr.partial=ls,hr.partialRight=fs,hr.partition=Ka,hr.pick=uc,hr.pickBy=lc,hr.property=Lc,hr.propertyOf=function(t){return function(e){return null==t?r:Xr(t,e)}},hr.pull=Ca,hr.pullAll=wa,hr.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?yi(t,e,jo(n,2)):t},hr.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?yi(t,e,r,n):t},hr.pullAt=Aa,hr.range=Bc,hr.rangeRight=Fc,hr.rearg=ds,hr.reject=function(t,e){return(vs(t)?$e:qr)(t,cs(jo(e,3)))},hr.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=jo(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return bi(t,i),n},hr.rest=function(t,e){if("function"!=typeof t)throw new ie(a);return Ei(t,e=e===r?e:Fs(e))},hr.reverse=Oa,hr.sampleSize=function(t,e,n){return e=(n?Wo(t,e,n):e===r)?1:Fs(e),(vs(t)?wr:wi)(t,e)},hr.set=function(t,e,n){return null==t?t:Ai(t,e,n)},hr.setWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:Ai(t,e,n,i)},hr.shuffle=function(t){return(vs(t)?Ar:Ri)(t)},hr.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Wo(t,e,n)?(e=0,n=i):(e=null==e?0:Fs(e),n=n===r?i:Fs(n)),Ii(t,e,n)):[]},hr.sortBy=Qa,hr.sortedUniq=function(t){return t&&t.length?Di(t):[]},hr.sortedUniqBy=function(t,e){return t&&t.length?Di(t,jo(e,2)):[]},hr.split=function(t,e,n){return n&&"number"!=typeof n&&Wo(t,e,n)&&(e=n=r),(n=n===r?k:n>>>0)?(t=Vs(t))&&("string"==typeof e||null!=e&&!Ms(e))&&!(e=ji(e))&&En(t)?$i(In(t),0,n):t.split(e,n):[]},hr.spread=function(t,e){if("function"!=typeof t)throw new ie(a);return e=null==e?0:Vn(Fs(e),0),Ei(function(n){var r=n[e],i=$i(n,0,e);return r&&Qe(i,r),qe(t,this,i)})},hr.tail=function(t){var e=null==t?0:t.length;return e?Ii(t,1,e):[]},hr.take=function(t,e,n){return t&&t.length?Ii(t,0,(e=n||e===r?1:Fs(e))<0?0:e):[]},hr.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?Ii(t,(e=i-(e=n||e===r?1:Fs(e)))<0?0:e,i):[]},hr.takeRightWhile=function(t,e){return t&&t.length?Bi(t,jo(e,3),!1,!0):[]},hr.takeWhile=function(t,e){return t&&t.length?Bi(t,jo(e,3)):[]},hr.tap=function(t,e){return e(t),t},hr.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new ie(a);return Os(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),is(t,e,{leading:r,maxWait:e,trailing:i})},hr.thru=Ba,hr.toArray=Ls,hr.toPairs=fc,hr.toPairsIn=dc,hr.toPath=function(t){return vs(t)?Ke(t,la):ks(t)?[t]:no(ua(Vs(t)))},hr.toPlainObject=Gs,hr.transform=function(t,e,n){var r=vs(t),i=r||Ss(t)||js(t);if(e=jo(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:Os(t)&&Cs(o)?pr(Me(t)):{}}return(i?Ve:Wr)(t,function(t,r,i){return e(n,t,r,i)}),n},hr.unary=function(t){return ts(t,1)},hr.union=xa,hr.unionBy=Ra,hr.unionWith=Ia,hr.uniq=function(t){return t&&t.length?Ui(t):[]},hr.uniqBy=function(t,e){return t&&t.length?Ui(t,jo(e,2)):[]},hr.uniqWith=function(t,e){return e="function"==typeof e?e:r,t&&t.length?Ui(t,r,e):[]},hr.unset=function(t,e){return null==t||zi(t,e)},hr.unzip=Na,hr.unzipWith=Ma,hr.update=function(t,e,n){return null==t?t:Li(t,e,Vi(n))},hr.updateWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:Li(t,e,Vi(n),i)},hr.values=hc,hr.valuesIn=function(t){return null==t?[]:gn(t,oc(t))},hr.without=Pa,hr.words=Cc,hr.wrap=function(t,e){return ls(Vi(e),t)},hr.xor=Da,hr.xorBy=ka,hr.xorWith=ja,hr.zip=Ua,hr.zipObject=function(t,e){return qi(t||[],e||[],xr)},hr.zipObjectDeep=function(t,e){return qi(t||[],e||[],Ai)},hr.zipWith=za,hr.entries=fc,hr.entriesIn=dc,hr.extend=Ws,hr.extendWith=$s,Dc(hr,hr),hr.add=Gc,hr.attempt=wc,hr.camelCase=pc,hr.capitalize=mc,hr.ceil=Vc,hr.clamp=function(t,e,n){return n===r&&(n=e,e=r),n!==r&&(n=(n=qs(n))==n?n:0),e!==r&&(e=(e=qs(e))==e?e:0),Dr(qs(t),e,n)},hr.clone=function(t){return kr(t,d)},hr.cloneDeep=function(t){return kr(t,l|d)},hr.cloneDeepWith=function(t,e){return kr(t,l|d,e="function"==typeof e?e:r)},hr.cloneWith=function(t,e){return kr(t,d,e="function"==typeof e?e:r)},hr.conformsTo=function(t,e){return null==e||jr(t,e,ic(e))},hr.deburr=gc,hr.defaultTo=function(t,e){return null==t||t!=t?e:t},hr.divide=Yc,hr.endsWith=function(t,e,n){t=Vs(t),e=ji(e);var i=t.length,o=n=n===r?i:Dr(Fs(n),0,i);return(n-=e.length)>=0&&t.slice(n,o)==e},hr.eq=hs,hr.escape=function(t){return(t=Vs(t))&&Et.test(t)?t.replace(St,Sn):t},hr.escapeRegExp=function(t){return(t=Vs(t))&&Nt.test(t)?t.replace(It,"\\$&"):t},hr.every=function(t,e,n){var i=vs(t)?We:Fr;return n&&Wo(t,e,n)&&(e=r),i(t,jo(e,3))},hr.find=qa,hr.findIndex=ga,hr.findKey=function(t,e){return rn(t,jo(e,3),Wr)},hr.findLast=Ga,hr.findLastIndex=va,hr.findLastKey=function(t,e){return rn(t,jo(e,3),$r)},hr.floor=Wc,hr.forEach=Va,hr.forEachRight=Ya,hr.forIn=function(t,e){return null==t?t:Vr(t,jo(e,3),oc)},hr.forInRight=function(t,e){return null==t?t:Yr(t,jo(e,3),oc)},hr.forOwn=function(t,e){return t&&Wr(t,jo(e,3))},hr.forOwnRight=function(t,e){return t&&$r(t,jo(e,3))},hr.get=Zs,hr.gt=ps,hr.gte=ms,hr.has=function(t,e){return null!=t&&qo(t,e,ti)},hr.hasIn=tc,hr.head=ya,hr.identity=Ic,hr.includes=function(t,e,n,r){t=ys(t)?t:hc(t),n=n&&!r?Fs(n):0;var i=t.length;return n<0&&(n=Vn(i+n,0)),Ds(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&an(t,e,n)>-1},hr.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Fs(n);return i<0&&(i=Vn(r+i,0)),an(t,e,i)},hr.inRange=function(t,e,n){return e=Bs(e),n===r?(n=e,e=0):n=Bs(n),function(t,e,n){return t>=Yn(e,n)&&t<Vn(e,n)}(t=qs(t),e,n)},hr.invoke=rc,hr.isArguments=gs,hr.isArray=vs,hr.isArrayBuffer=_s,hr.isArrayLike=ys,hr.isArrayLikeObject=bs,hr.isBoolean=function(t){return!0===t||!1===t||xs(t)&&Qr(t)==H},hr.isBuffer=Ss,hr.isDate=Ts,hr.isElement=function(t){return xs(t)&&1===t.nodeType&&!Ns(t)},hr.isEmpty=function(t){if(null==t)return!0;if(ys(t)&&(vs(t)||"string"==typeof t||"function"==typeof t.splice||Ss(t)||js(t)||gs(t)))return!t.length;var e=Ho(t);if(e==$||e==tt)return!t.size;if(Ko(t))return!ui(t).length;for(var n in t)if(le.call(t,n))return!1;return!0},hr.isEqual=function(t,e){return oi(t,e)},hr.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:r)?n(t,e):r;return i===r?oi(t,e,r,n):!!i},hr.isError=Es,hr.isFinite=function(t){return"number"==typeof t&&Hn(t)},hr.isFunction=Cs,hr.isInteger=ws,hr.isLength=As,hr.isMap=Rs,hr.isMatch=function(t,e){return t===e||ai(t,e,zo(e))},hr.isMatchWith=function(t,e,n){return n="function"==typeof n?n:r,ai(t,e,zo(e),n)},hr.isNaN=function(t){return Is(t)&&t!=+t},hr.isNative=function(t){if(Xo(t))throw new Qt(o);return si(t)},hr.isNil=function(t){return null==t},hr.isNull=function(t){return null===t},hr.isNumber=Is,hr.isObject=Os,hr.isObjectLike=xs,hr.isPlainObject=Ns,hr.isRegExp=Ms,hr.isSafeInteger=function(t){return ws(t)&&t>=-M&&t<=M},hr.isSet=Ps,hr.isString=Ds,hr.isSymbol=ks,hr.isTypedArray=js,hr.isUndefined=function(t){return t===r},hr.isWeakMap=function(t){return xs(t)&&Ho(t)==it},hr.isWeakSet=function(t){return xs(t)&&Qr(t)==ot},hr.join=function(t,e){return null==t?"":qn.call(t,e)},hr.kebabCase=vc,hr.last=Ea,hr.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var o=i;return n!==r&&(o=(o=Fs(n))<0?Vn(i+o,0):Yn(o,i-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):on(t,cn,o,!0)},hr.lowerCase=_c,hr.lowerFirst=yc,hr.lt=Us,hr.lte=zs,hr.max=function(t){return t&&t.length?Hr(t,Ic,Zr):r},hr.maxBy=function(t,e){return t&&t.length?Hr(t,jo(e,2),Zr):r},hr.mean=function(t){return un(t,Ic)},hr.meanBy=function(t,e){return un(t,jo(e,2))},hr.min=function(t){return t&&t.length?Hr(t,Ic,fi):r},hr.minBy=function(t,e){return t&&t.length?Hr(t,jo(e,2),fi):r},hr.stubArray=Hc,hr.stubFalse=qc,hr.stubObject=function(){return{}},hr.stubString=function(){return""},hr.stubTrue=function(){return!0},hr.multiply=Jc,hr.nth=function(t,e){return t&&t.length?gi(t,Fs(e)):r},hr.noConflict=function(){return Ne._===this&&(Ne._=me),this},hr.noop=kc,hr.now=Za,hr.pad=function(t,e,n){t=Vs(t);var r=(e=Fs(e))?Rn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return _o(Ln(i),n)+t+_o(zn(i),n)},hr.padEnd=function(t,e,n){t=Vs(t);var r=(e=Fs(e))?Rn(t):0;return e&&r<e?t+_o(e-r,n):t},hr.padStart=function(t,e,n){t=Vs(t);var r=(e=Fs(e))?Rn(t):0;return e&&r<e?_o(e-r,n)+t:t},hr.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),$n(Vs(t).replace(Pt,""),e||0)},hr.random=function(t,e,n){if(n&&"boolean"!=typeof n&&Wo(t,e,n)&&(e=n=r),n===r&&("boolean"==typeof e?(n=e,e=r):"boolean"==typeof t&&(n=t,t=r)),t===r&&e===r?(t=0,e=1):(t=Bs(t),e===r?(e=t,t=0):e=Bs(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var o=Jn();return Yn(t+o*(e-t+Oe("1e-"+((o+"").length-1))),e)}return Si(t,e)},hr.reduce=function(t,e,n){var r=vs(t)?Ze:dn,i=arguments.length<3;return r(t,jo(e,4),n,i,Lr)},hr.reduceRight=function(t,e,n){var r=vs(t)?tn:dn,i=arguments.length<3;return r(t,jo(e,4),n,i,Br)},hr.repeat=function(t,e,n){return e=(n?Wo(t,e,n):e===r)?1:Fs(e),Ti(Vs(t),e)},hr.replace=function(){var t=arguments,e=Vs(t[0]);return t.length<3?e:e.replace(t[1],t[2])},hr.result=function(t,e,n){var i=-1,o=(e=Yi(e,t)).length;for(o||(o=1,t=r);++i<o;){var a=null==t?r:t[la(e[i])];a===r&&(i=o,a=n),t=Cs(a)?a.call(t):a}return t},hr.round=Xc,hr.runInContext=t,hr.sample=function(t){return(vs(t)?Cr:Ci)(t)},hr.size=function(t){if(null==t)return 0;if(ys(t))return Ds(t)?Rn(t):t.length;var e=Ho(t);return e==$||e==tt?t.size:ui(t).length},hr.snakeCase=bc,hr.some=function(t,e,n){var i=vs(t)?en:Ni;return n&&Wo(t,e,n)&&(e=r),i(t,jo(e,3))},hr.sortedIndex=function(t,e){return Mi(t,e)},hr.sortedIndexBy=function(t,e,n){return Pi(t,e,jo(n,2))},hr.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=Mi(t,e);if(r<n&&hs(t[r],e))return r}return-1},hr.sortedLastIndex=function(t,e){return Mi(t,e,!0)},hr.sortedLastIndexBy=function(t,e,n){return Pi(t,e,jo(n,2),!0)},hr.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=Mi(t,e,!0)-1;if(hs(t[n],e))return n}return-1},hr.startCase=Sc,hr.startsWith=function(t,e,n){return t=Vs(t),n=null==n?0:Dr(Fs(n),0,t.length),e=ji(e),t.slice(n,n+e.length)==e},hr.subtract=Kc,hr.sum=function(t){return t&&t.length?hn(t,Ic):0},hr.sumBy=function(t,e){return t&&t.length?hn(t,jo(e,2)):0},hr.template=function(t,e,n){var i=hr.templateSettings;n&&Wo(t,e,n)&&(e=r),t=Vs(t),e=$s({},e,i,Ao);var o,a,s=$s({},e.imports,i.imports,Ao),c=ic(s),u=gn(s,c),l=0,f=e.interpolate||$t,d="__p += '",h=ne((e.escape||$t).source+"|"+f.source+"|"+(f===At?Bt:$t).source+"|"+(e.evaluate||$t).source+"|$","g"),p="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++Ee+"]")+"\n";t.replace(h,function(e,n,r,i,s,c){return r||(r=i),d+=t.slice(l,c).replace(Jt,Tn),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+e.length,e}),d+="';\n";var m=e.variable;m||(d="with (obj) {\n"+d+"\n}\n"),d=(a?d.replace(vt,""):d).replace(_t,"$1").replace(yt,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=wc(function(){return Zt(c,p+"return "+d).apply(r,u)});if(g.source=d,Es(g))throw g;return g},hr.times=function(t,e){if((t=Fs(t))<1||t>M)return[];var n=k,r=Yn(t,k);e=jo(e),t-=k;for(var i=pn(r,e);++n<t;)e(n);return i},hr.toFinite=Bs,hr.toInteger=Fs,hr.toLength=Hs,hr.toLower=function(t){return Vs(t).toLowerCase()},hr.toNumber=qs,hr.toSafeInteger=function(t){return t?Dr(Fs(t),-M,M):0===t?t:0},hr.toString=Vs,hr.toUpper=function(t){return Vs(t).toUpperCase()},hr.trim=function(t,e,n){if((t=Vs(t))&&(n||e===r))return t.replace(Mt,"");if(!t||!(e=ji(e)))return t;var i=In(t),o=In(e);return $i(i,_n(i,o),yn(i,o)+1).join("")},hr.trimEnd=function(t,e,n){if((t=Vs(t))&&(n||e===r))return t.replace(Dt,"");if(!t||!(e=ji(e)))return t;var i=In(t);return $i(i,0,yn(i,In(e))+1).join("")},hr.trimStart=function(t,e,n){if((t=Vs(t))&&(n||e===r))return t.replace(Pt,"");if(!t||!(e=ji(e)))return t;var i=In(t);return $i(i,_n(i,In(e))).join("")},hr.truncate=function(t,e){var n=w,i=A;if(Os(e)){var o="separator"in e?e.separator:o;n="length"in e?Fs(e.length):n,i="omission"in e?ji(e.omission):i}var a=(t=Vs(t)).length;if(En(t)){var s=In(t);a=s.length}if(n>=a)return t;var c=n-Rn(i);if(c<1)return i;var u=s?$i(s,0,c).join(""):t.slice(0,c);if(o===r)return u+i;if(s&&(c+=u.length-c),Ms(o)){if(t.slice(c).search(o)){var l,f=u;for(o.global||(o=ne(o.source,Vs(Ft.exec(o))+"g")),o.lastIndex=0;l=o.exec(f);)var d=l.index;u=u.slice(0,d===r?c:d)}}else if(t.indexOf(ji(o),c)!=c){var h=u.lastIndexOf(o);h>-1&&(u=u.slice(0,h))}return u+i},hr.unescape=function(t){return(t=Vs(t))&&Tt.test(t)?t.replace(bt,Nn):t},hr.uniqueId=function(t){var e=++fe;return Vs(t)+e},hr.upperCase=Tc,hr.upperFirst=Ec,hr.each=Va,hr.eachRight=Ya,hr.first=ya,Dc(hr,($c={},Wr(hr,function(t,e){le.call(hr.prototype,e)||($c[e]=t)}),$c),{chain:!1}),hr.VERSION="4.17.11",Ve(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){hr[t].placeholder=hr}),Ve(["drop","take"],function(t,e){vr.prototype[t]=function(n){n=n===r?1:Vn(Fs(n),0);var i=this.__filtered__&&!e?new vr(this):this.clone();return i.__filtered__?i.__takeCount__=Yn(n,i.__takeCount__):i.__views__.push({size:Yn(n,k),type:t+(i.__dir__<0?"Right":"")}),i},vr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Ve(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==R||3==n;vr.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:jo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),Ve(["head","last"],function(t,e){var n="take"+(e?"Right":"");vr.prototype[t]=function(){return this[n](1).value()[0]}}),Ve(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");vr.prototype[t]=function(){return this.__filtered__?new vr(this):this[n](1)}}),vr.prototype.compact=function(){return this.filter(Ic)},vr.prototype.find=function(t){return this.filter(t).head()},vr.prototype.findLast=function(t){return this.reverse().find(t)},vr.prototype.invokeMap=Ei(function(t,e){return"function"==typeof t?new vr(this):this.map(function(n){return ri(n,t,e)})}),vr.prototype.reject=function(t){return this.filter(cs(jo(t)))},vr.prototype.slice=function(t,e){t=Fs(t);var n=this;return n.__filtered__&&(t>0||e<0)?new vr(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==r&&(n=(e=Fs(e))<0?n.dropRight(-e):n.take(e-t)),n)},vr.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},vr.prototype.toArray=function(){return this.take(k)},Wr(vr.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),o=hr[i?"take"+("last"==e?"Right":""):e],a=i||/^find/.test(e);o&&(hr.prototype[e]=function(){var e=this.__wrapped__,s=i?[1]:arguments,c=e instanceof vr,u=s[0],l=c||vs(e),f=function(t){var e=o.apply(hr,Qe([t],s));return i&&d?e[0]:e};l&&n&&"function"==typeof u&&1!=u.length&&(c=l=!1);var d=this.__chain__,h=!!this.__actions__.length,p=a&&!d,m=c&&!h;if(!a&&l){e=m?e:new vr(this);var g=t.apply(e,s);return g.__actions__.push({func:Ba,args:[f],thisArg:r}),new gr(g,d)}return p&&m?t.apply(this,s):(g=this.thru(f),p?i?g.value()[0]:g.value():g)})}),Ve(["pop","push","shift","sort","splice","unshift"],function(t){var e=oe[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);hr.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(vs(i)?i:[],t)}return this[n](function(n){return e.apply(vs(n)?n:[],t)})}}),Wr(vr.prototype,function(t,e){var n=hr[e];if(n){var r=n.name+"";(ir[r]||(ir[r]=[])).push({name:e,func:n})}}),ir[po(r,g).name]=[{name:"wrapper",func:r}],vr.prototype.clone=function(){var t=new vr(this.__wrapped__);return t.__actions__=no(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=no(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=no(this.__views__),t},vr.prototype.reverse=function(){if(this.__filtered__){var t=new vr(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},vr.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=vs(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=Yn(e,t+a);break;case"takeRight":t=Vn(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,f=l.length,d=0,h=Yn(c,this.__takeCount__);if(!n||!r&&i==c&&h==c)return Fi(t,this.__actions__);var p=[];t:for(;c--&&d<h;){for(var m=-1,g=t[u+=e];++m<f;){var v=l[m],_=v.iteratee,y=v.type,b=_(g);if(y==I)g=b;else if(!b){if(y==R)continue t;break t}}p[d++]=g}return p},hr.prototype.at=Fa,hr.prototype.chain=function(){return La(this)},hr.prototype.commit=function(){return new gr(this.value(),this.__chain__)},hr.prototype.next=function(){this.__values__===r&&(this.__values__=Ls(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?r:this.__values__[this.__index__++]}},hr.prototype.plant=function(t){for(var e,n=this;n instanceof mr;){var i=da(n);i.__index__=0,i.__values__=r,e?o.__wrapped__=i:e=i;var o=i;n=n.__wrapped__}return o.__wrapped__=t,e},hr.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof vr){var e=t;return this.__actions__.length&&(e=new vr(this)),(e=e.reverse()).__actions__.push({func:Ba,args:[Oa],thisArg:r}),new gr(e,this.__chain__)}return this.thru(Oa)},hr.prototype.toJSON=hr.prototype.valueOf=hr.prototype.value=function(){return Fi(this.__wrapped__,this.__actions__)},hr.prototype.first=hr.prototype.head,fn&&(hr.prototype[fn]=function(){return this}),hr}();Pe?((Pe.exports=Mn)._=Mn,Me._=Mn):Ne._=Mn}).call(this)}).call(this,n(21),n(48)(t))},function(t,e,n){"use strict";var r,i,o,a,s;n.d(e,"d",function(){return r}),n.d(e,"c",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"e",function(){return a}),n.d(e,"a",function(){return s}),function(t){t.MESSAGE="MESSAGE",t.SYSTEM_MESSAGE="SYSTEM_MESSAGE"}(r||(r={})),function(t){t.UNKNOWN="UNKNOWN",t.VISITOR="VISITOR",t.ADMIN="ADMIN",t.BOT="BOT",t.CTY_EXPERT="CTY_EXPERT",t.IBBU_EXPERT="IBBU_EXPERT",t.MANAGER="MANAGER",t.OPERATOR="OPERATOR",t.PROFILE="PROFILE"}(i||(i={})),function(t){t.IMAGE="IMAGE",t.PRODUCT="PRODUCT",t.FILE="FILE",t.LINK="LINK",t.OFFER="OFFER",t.QUICK_REPLY_MENU="QUICK_REPLY_MENU",t.CARD="CARD",t.CARD_BUNDLE="CARD_BUNDLE",t.PRODUCT_OFFER="PRODUCT_OFFER",t.PRODUCT_OFFER_BUNDLE="PRODUCT_OFFER_BUNDLE",t.UNSUPPORTED="UNSUPPORTED"}(o||(o={})),function(t){t.AVAILABLE="AVAILABLE",t.UNAVAILABLE="UNAVAILABLE"}(a||(a={})),function(t){t.LINK="LINK"}(s||(s={}))},,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e),n.d(e,"createStore",function(){return s}),n.d(e,"combineReducers",function(){return u}),n.d(e,"bindActionCreators",function(){return f}),n.d(e,"applyMiddleware",function(){return p}),n.d(e,"compose",function(){return h}),n.d(e,"__DO_NOT_USE__ActionTypes",function(){return o});var r=n(42),i=function(){return Math.random().toString(36).substring(7).split("").join(".")},o={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function a(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function s(t,e,n){var i;if("function"==typeof e&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof e&&void 0===n&&(n=e,e=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(s)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var c=t,u=e,l=[],f=l,d=!1;function h(){f===l&&(f=l.slice())}function p(){if(d)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function m(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(d)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var e=!0;return h(),f.push(t),function(){if(e){if(d)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");e=!1,h();var n=f.indexOf(t);f.splice(n,1)}}}function g(t){if(!a(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw new Error("Reducers may not dispatch actions.");try{d=!0,u=c(u,t)}finally{d=!1}for(var e=l=f,n=0;n<e.length;n++){(0,e[n])()}return t}return g({type:o.INIT}),(i={dispatch:g,subscribe:m,getState:p,replaceReducer:function(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");c=t,g({type:o.REPLACE})}})[r.a]=function(){var t,e=m;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function n(){t.next&&t.next(p())}return n(),{unsubscribe:e(n)}}})[r.a]=function(){return this},t},i}function c(t,e){var n=e&&e.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];0,"function"==typeof t[i]&&(n[i]=t[i])}var a,s=Object.keys(n);try{!function(t){Object.keys(t).forEach(function(e){var n=t[e];if(void 0===n(void 0,{type:o.INIT}))throw new Error('Reducer "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:o.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+o.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(t){a=t}return function(t,e){if(void 0===t&&(t={}),a)throw a;for(var r=!1,i={},o=0;o<s.length;o++){var u=s[o],l=n[u],f=t[u],d=l(f,e);if(void 0===d){var h=c(u,e);throw new Error(h)}i[u]=d,r=r||d!==f}return r?i:t}}function l(t,e){return function(){return e(t.apply(this,arguments))}}function f(t,e){if("function"==typeof t)return l(t,e);if("object"!=typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(t),r={},i=0;i<n.length;i++){var o=n[i],a=t[o];"function"==typeof a&&(r[o]=l(a,e))}return r}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce(function(t,e){return function(){return t(e.apply(void 0,arguments))}})}function p(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(){var n=t.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=e.map(function(t){return t(i)});return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){d(t,e,n[e])})}return t}({},n,{dispatch:r=h.apply(void 0,o)(n.dispatch)})}}}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n=Array.isArray;t.exports=n},,function(t,e,n){var r=n(189),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e,n){"use strict";var r;n.d(e,"a",function(){return r}),function(t){t.COBROWSING_ASKED="COBROWSING_ASKED",t.COBROWSING_STOPPED="COBROWSING_STOPPED",t.CONVERSATION_CLOSED="CONVERSATION_CLOSED",t.PARTICIPANT_LEFT="PARTICIPANT_LEFT",t.PARTICIPANT_RETURNED="PARTICIPANT_RETURNED",t.VISITOR_BLOCKED="VISITOR_BLOCKED",t.ENGAGEMENT_RULE_TRIGGERED="ENGAGEMENT_RULE_TRIGGERED",t.NAVIGATION_CHANGED="NAVIGATION_CHANGED",t.COBROWSING_REFUSED="COBROWSING_REFUSED",t.COBROWSING_ACCEPTED="COBROWSING_ACCEPTED",t.VISITOR_CHATBOX_CLOSED="VISITOR_CHATBOX_CLOSED",t.VISITOR_CHATBOX_MAXIMIZED="VISITOR_CHATBOX_MAXIMIZED",t.VISITOR_CHATBOX_MINIFIED="VISITOR_CHATBOX_MINIFIED",t.SUPERVISOR_COMMENT_SENT="SUPERVISOR_COMMENT_SENT",t.TRANSFERRED_TO_PARTICIPANT="TRANSFERRED_TO_PARTICIPANT",t.TRANSFERRED_TO_ROUTING_RULE="TRANSFERRED_TO_ROUTING_RULE",t.AUTOMATIC_MESSAGE_SENT="AUTOMATIC_MESSAGE_SENT"}(r||(r={}))},,,,,,,,,,,,,,,function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){"use strict";(function(t,r){var i,o=n(58);i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:r;var a=Object(o.a)(i);e.a=a}).call(this,n(21),n(113)(t))},,,,,,function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(168),i=n(143);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},,,function(t,e,n){var r=n(298),i=n(301);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},,,,function(t,e,n){var r=n(72),i=n(288),o=n(289),a="[object Null]",s="[object Undefined]",c=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?s:a:c&&c in Object(t)?i(t):o(t)}},,function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}n.d(e,"a",function(){return r})},,,,,,,,,function(t,e,n){var r=n(188),i=n(167),o=n(49);t.exports=function(t){return o(t)?r(t):i(t)}},,,,,function(t,e,n){var r=n(24).Symbol;t.exports=r},,function(t,e,n){var r=n(150);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},,,,,,,,,,,,,,,function(t,e,n){var r=n(56),i=n(40),o="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||i(t)&&r(t)==o}},,,function(t,e,n){var r=n(287),i=n(40),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=c},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(297),i=n(148),o=n(302),a=n(270),s=n(206),c=n(56),u=n(190),l=u(r),f=u(i),d=u(o),h=u(a),p=u(s),m=c;(r&&"[object DataView]"!=m(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=m(new i)||o&&"[object Promise]"!=m(o.resolve())||a&&"[object Set]"!=m(new a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(t){var e=c(t),n="[object Object]"==e?t.constructor:void 0,r=n?u(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case d:return"[object Promise]";case h:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=m},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e,n){var r=n(52)(Object,"create");t.exports=r},function(t,e,n){var r=n(130);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(324);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var r=n(89),i=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}},,,,,,,,,,,,function(t,e,n){(function(t){var r=n(24),i=n(290),o=e&&!e.nodeType&&e,a=o&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===o?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||i;t.exports=c}).call(this,n(48)(t))},function(t,e){t.exports=function(t){return t}},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){var r=n(22),i=n(173),o=n(308),a=n(119);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(a(t))}},,,,function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.showChatboxButtonClickedBeforeBundle="engagement.showChatboxButtonClickedBeforeBundle",e.showChatboxButtonClicked="engagement.showChatboxButtonClicked",e.showChatboxNotificationBeforeBundle="engagement.showChatboxNotificationBeforeBundle",e.showChatboxNotification="engagement.showChatboxNotification",e.showChatbox="engagement.showChatbox",e.showChatboxWithGDPRWorkflow="engagement.showChatboxWithGDPRWorkflow",e.showMessageNotificationBeforeBundle="engagement.showMessageNotificationBeforeBundle",e.showMessageWithGDPRWorkflow="engagement.showMessageWithGDPRWorkflow",e.showMessageNotification="engagement.showMessageNotification",e.showMessage="engagement.showMessage",e.callModalSaveConsent="engagement.callModalSaveConsent",e.showCallModalWithAcceptedGDPRWorkflow="engagement.showCallModalWithAcceptedGDPRWorkflow",e.showCallModalSaveConsentFailedWorkflow="engagement.showCallModalSaveConsentFailedWorkflow",e.showCallButtonClickedBeforeBundle="engagement.showCallButtonClickedBeforeBundle",e.showCallButtonClicked="engagement.showCallButtonClicked",e.showCallModal="engagement.showCallModal",e.showCallModalRetrievingFailedWorkflow="engagement.showCallModalRetrievingFailedWorkflow",e.showChatboxWithAcceptedGDPRWorkflow="engagement.showChatboxWithAcceptedGDPRWorkflow",e.showChatboxWithRefusedGDPRWorkflow="engagement.showChatboxWithRefusedGDPRWorkflow",e.showChatboxWithAcceptedGDPRFailedWorkflow="engagement.showChatboxWithAcceptedGDPRFailedWorkflow",e.showChatboxWithRefusedGDPRFailedWorkflow="engagement.showChatboxWithRefusedGDPRFailedWorkflow",e.showChatboxWithGDPRRetrievingFailedWorkflow="engagement.showChatboxWithGDPRRetrievingFailedWorkflow",e.showLegalInformationPopin="engagement.showLegalInformationPopin",e.hideLegalInformationPopin="engagement.hideLegalInformationPopin",e.GDPRAccepted="engagement.GDPRAccepted",e.GDPRRefused="engagement.GDPRRefused"},function(t,e,n){var r=n(215);t.exports=function(t){return null==t?"":r(t)}},,,,,function(t,e,n){var r=n(284),i=n(293)(r);t.exports=i},function(t,e,n){var r=n(291),i=n(126),o=n(166),a=o&&o.isTypedArray,s=a?i(a):r;t.exports=s},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=e.SURVEY_STEP_NPS="SURVEY_STEP_NPS",r=e.SURVEY_STEP_CSAT="SURVEY_STEP_CSAT",i=e.SURVEY_STEP_REWARDS="SURVEY_STEP_REWARDS",o=e.SURVEY_STEP_COMMENT="SURVEY_STEP_COMMENT",a=e.SURVEY_STEP_END="SURVEY_STEP_END";e.SURVEY_STEPS=[n,r,i,o,a]},function(t,e){t.exports=function(){}},function(t,e,n){var r=n(318),i=n(319),o=n(320),a=n(321),s=n(322);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},,,,,,,,,,,,function(t,e){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?n:e)&&("number"==i||"symbol"!=i&&r.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e){var n=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},function(t,e,n){var r=n(188),i=n(295),o=n(49);t.exports=function(t){return o(t)?r(t,!0):i(t)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.INIT_SURVEY="INIT_SURVEY",e.CLOSE_SURVEY="CLOSE_SURVEY",e.SURVEY_NEXT_STEP="SURVEY_NEXT_STEP",e.SURVEY_PREVIOUS_STEP="SURVEY_PREVIOUS_STEP",e.SURVEY_NPS_SUBMIT_REQUEST="SURVEY_NPS_SUBMIT_REQUEST",e.SURVEY_NPS_SUBMIT_FAILED="SURVEY_NPS_SUBMIT_FAILED",e.SURVEY_NPS_SUBMIT_SUCCESS="SURVEY_NPS_SUBMIT_SUCCESS",e.SURVEY_CSAT_SUBMIT_REQUEST="SURVEY_CSAT_SUBMIT_REQUEST",e.SURVEY_CSAT_SUBMIT_FAILED="SURVEY_CSAT_SUBMIT_FAILED",e.SURVEY_CSAT_SUBMIT_SUCCESS="SURVEY_CSAT_SUBMIT_SUCCESS",e.SURVEY_COMMENT_SUBMIT_REQUEST="SURVEY_COMMENT_SUBMIT_REQUEST",e.SURVEY_COMMENT_SUBMIT_FAILED="SURVEY_COMMENT_SUBMIT_FAILED",e.SURVEY_COMMENT_SUBMIT_SUCCESS="SURVEY_COMMENT_SUBMIT_SUCCESS",e.SURVEY_REWARD_SUBMIT="SURVEY_REWARD_SUBMIT",e.SURVEY_REWARDS_GET_REQUEST="SURVEY_REWARDS_GET_REQUEST",e.SURVEY_REWARDS_GET_FAILED="SURVEY_REWARDS_GET_FAILED",e.SURVEY_REWARDS_GET_SUCCESS="SURVEY_REWARDS_GET_SUCCESS",e.CONVERSATION_HISTORY_GET_REQUEST="CONVERSATION_HISTORY_GET_REQUEST",e.CONVERSATION_HISTORY_GET_FAILED="CONVERSATION_HISTORY_GET_FAILED",e.CONVERSATION_HISTORY_GET_SUCCESS="CONVERSATION_HISTORY_GET_SUCCESS"},function(t,e,n){"use strict";n.r(e),n.d(e,"LegacyTypes",function(){return r}),n.d(e,"getAuthorFromLegacyOperator",function(){return a}),n.d(e,"getAuthorFromBareJid",function(){return s}),n.d(e,"toFileMessageAttachment",function(){return c}),n.d(e,"toImageMessageAttachment",function(){return u}),n.d(e,"createRfcMessage",function(){return l}),n.d(e,"isImageMimeType",function(){return f}),n.d(e,"getUploadMessageAttachment",function(){return d}),n.d(e,"getQuickReplyMenuMessageAttachment",function(){return h}),n.d(e,"fromUploadToRfcMessage",function(){return p}),n.d(e,"fromQCMToRfcMessage",function(){return m}),n.d(e,"fromOobToRfcMessage",function(){return g}),n.d(e,"toRfcMessage",function(){return v}),n.d(e,"toRfcFirstConversationMessage",function(){return _}),n.d(e,"toRfcCommand",function(){return y}),n.d(e,"toRfcCardAttachment",function(){return E}),n.d(e,"toRfcCardBundleAttachment",function(){return C}),n.d(e,"toRfcProductOfferAvailabilityStatus",function(){return w}),n.d(e,"toRfcProductOfferAvailability",function(){return A}),n.d(e,"toRfcProductOfferAttachment",function(){return O}),n.d(e,"toRfcProductOfferBundleAttachment",function(){return x}),n.d(e,"toRfcFileAttachment",function(){return R});var r,i=n(7),o=n(25);!function(t){t.GROUP_CHAT="groupchat",t.CHAT="chat"}(r||(r={}));var a=function(t){return{externalUrl:"",firstName:"",lastName:"",id:t.id,name:t.name,nickName:t.pseudo,pictureUrl:t.avatar,type:i.c.OPERATOR}},s=function(t){var e=iAdvize.operator,n=e.name,r=e.pseudo,o=e.avatar;return iAdvize.vuid===Strophe.getResourceFromJid(t)?{pictureUrl:o,type:i.c.VISITOR,id:t}:{name:n,nickName:r,pictureUrl:o,id:t,type:i.c.OPERATOR}},c=function(t,e,n){return{type:i.b.FILE,data:{fileName:t,mimeType:e,url:n}}},u=function(t,e,n){return{type:i.b.IMAGE,data:{fileName:t,mimeType:e,url:n}}},l=function(t,e,n,r){void 0===n&&(n=""),void 0===r&&(r=[]);var o=s(t);return{author:o,attachments:r,id:e,text:n,sentAs:o,type:i.d.MESSAGE,createdAt:(new Date).toISOString()}},f=function(t){return/^image\//.test(t)},d=function(t){return f(t.type)?u(t.name,t.type,t.url):c(t.name,t.type,t.url)},h=function(t){return{data:t,type:i.b.QUICK_REPLY_MENU}},p=function(t,e,n){return l(t,e,"",[d(n)])},m=function(t,e,n){return l(t,e,"",[h(n)])},g=function(t,e,n,r){switch(n){case"upload":return p(t,e,r);case"message-with-multiple-choices":return m(t,e,r);default:return l(t,e,"UNSUPPORTED CONTENT ("+n+")")}},v=function(t,e){void 0===e&&(e=[]);var n=s(t.from);return{author:n,attachments:e,id:t.id,type:i.d.MESSAGE,text:t.body,createdAt:(new Date).toISOString(),sentAs:n}},_=function(t,e,n){var r={id:n,type:i.c.VISITOR};return{author:r,attachments:[],id:e,type:i.d.MESSAGE,text:t,createdAt:(new Date).toISOString(),sentAs:r}},y=function(t){var e=t.getCommand();switch(e.name){case"magic_event":return"receiver_request"===e.param1?b(t):null;default:return null}},b=function(t){var e=iAdvize.operator,n=e.name,r=e.pseudo;return{id:t.id,type:i.d.SYSTEM_MESSAGE,createdAt:(new Date).toISOString(),attachments:[{type:o.a.COBROWSING_ASKED,data:{participant:{name:n,nickName:r,id:t.from,type:i.c.OPERATOR}}}]}},S=function(t){switch(t.type){case"link":return{title:t.title,url:t.url,type:i.a.LINK};default:return}},T=function(t){return t.map(S).filter(function(t){return Boolean(t)})},E=function(t){var e=t.actions,n=t.text,r=t.title,o=t.image;return{type:i.b.CARD,data:{title:r,text:n,image:o,actions:T(e)}}},C=function(t){var e=t.cards;return{type:i.b.CARD_BUNDLE,data:{cards:e.map(E)}}},w=function(t){switch(t){case"available":return i.e.AVAILABLE;case"unavailable":default:return i.e.UNAVAILABLE}},A=function(t){if(t)return{status:w(t.status)}},O=function(t){var e=t.image,n=t.name,r=t.price,o=t.offerPrice,a=t.availability,s=t.description,c=t.actions;return{type:i.b.PRODUCT_OFFER,data:{name:n,price:r,offerPrice:o,description:s,image:e,availability:A(a),actions:T(c)}}},x=function(t){var e=t.productOffers;return{type:i.b.PRODUCT_OFFER_BUNDLE,data:{productOffers:e.map(O)}}},R=function(t){var e=t.fileName,n=t.mimeType,r=t.url;return{type:i.b.FILE,data:{fileName:e,mimeType:n,url:r}}}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r={A:["href"],APPLET:["codebase"],AREA:["href"],BASE:["href"],BLOCKQUOTE:["cite"],BODY:["background"],DEL:["cite"],FORM:["action"],FRAME:["longdesc","src"],HEAD:["profile"],IFRAME:["longdesc","src"],IMG:["longdesc","src","usemap"],INPUT:["src","usemap","formaction"],INS:["cite"],LINK:["href"],OBJECT:["classid","codebase","data","usemap"],Q:["cite"],SCRIPT:["src"],AUDIO:["src"],BUTTON:["formaction"],COMMAND:["icon"],EMBED:["src"],HTML:["manifest"],SOURCE:["src"],TRACK:["src"],VIDEO:["poster","src"]},i=(e.html=function(t,e){for(var o=arguments.length,a=Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];var c,u=document.createElement(t);return function(t,e){!function(t,e){for(var n in t)e(t[n],n)}(e,function(e,r){"dangerouslySetInnerHTML"!==r?"style"!==r?"onClick"!==r?!0!==e?t.setAttribute(r,e):t.setAttribute(r,""):t.addEventListener("click",e):t.setAttribute(r,function(t,e){var n=[];for(var r in t)void 0!==t[r]&&n.push(e(t[r],r));return n}(e,function(t,e){return e+": "+t+";"}).join(" ")):"object"===(void 0===e?"undefined":n(e))&&"string"==typeof e.__html&&(t.innerHTML=e.__html)})}(u,e||{}),a.forEach(function(t){if("string"!=typeof t){if(t instanceof Array)t.forEach(function(t){return u.appendChild(t.render())});else if(t){var e=t.render();if(e instanceof Array)return void e.forEach(function(t){return u.appendChild(t)});u.appendChild(e)}}else u.appendChild(document.createTextNode(t))}),c=u,{renderAsString:function(){var t=c.tagName===i?c.innerHTML:c.outerHTML,e=r[c.tagName];return e?e.reduce(function(t,e){return t.replace(new RegExp(e+'=".+?"',"g"),function(t){return t.replace(/&amp;/g,"&")})},t):t},render:function(){if(c.tagName===i){for(var t=[],e=0;e<c.childNodes.length;e++)t.push(c.childNodes[e]);return t}return c}}},e.Fragment="DOMHELPERSINTERNALEMPTYFRAGMENTCOMPONENT");e.render=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.render();r instanceof Array||(r=[r]),n&&(e.innerHTML=""),r.forEach(function(t){return e.appendChild(t)})},e.renderAsString=function(t){return t.renderAsString()},e.findDOMNode=function(t){return t.render()}},function(t,e,n){var r=n(52)(n(24),"Map");t.exports=r},function(t,e,n){var r=n(41),i=Object.create,o=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=o},function(t,e,n){var r=n(114),i=n(99);t.exports=function(t,e){for(var n=0,o=(e=r(e,t)).length;null!=t&&n<o;)t=t[i(e[n++])];return n&&n==o?t:void 0}},,,,,,,,,,,,,,,,function(t,e,n){(function(t){var r=n(189),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i&&r.process,s=function(){try{var t=o&&o.require&&o.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(this,n(48)(t))},function(t,e,n){var r=n(93),i=n(292),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){var r=n(56),i=n(41),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";t.exports=function(t){if(!i(t))return!1;var e=r(t);return e==a||e==s||e==o||e==c}},function(t,e,n){var r=n(167),i=n(94),o=n(92),a=n(22),s=n(49),c=n(111),u=n(93),l=n(125),f="[object Map]",d="[object Set]",h=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(s(t)&&(a(t)||"string"==typeof t||"function"==typeof t.splice||c(t)||l(t)||o(t)))return!t.length;var e=i(t);if(e==f||e==d)return!t.size;if(u(t))return!r(t).length;for(var n in t)if(h.call(t,n))return!1;return!0}},function(t,e,n){var r=n(428)();t.exports=r},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},function(t,e,n){var r=n(307),i=n(67);t.exports=function(t){return null==t?[]:r(t,i(t))}},function(t,e,n){var r=n(22),i=n(89),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||a.test(t)||!o.test(t)||null!=e&&t in Object(e)}},function(t,e,n){var r=n(311),i=n(323),o=n(325),a=n(326),s=n(327);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,t.exports=c},,,,,,,,,,,,,function(t,e,n){var r=n(285)();t.exports=r},function(t,e,n){var r=n(286),i=n(92),o=n(22),a=n(111),s=n(142),c=n(125),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),l=!n&&i(t),f=!n&&!l&&a(t),d=!n&&!l&&!f&&c(t),h=n||l||f||d,p=h?r(t.length,String):[],m=p.length;for(var g in t)!e&&!u.call(t,g)||h&&("length"==g||f&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||p.push(g);return p}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(21))},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var r=n(171),i=n(303);t.exports=function t(e,n,o,a,s){var c=-1,u=e.length;for(o||(o=i),s||(s=[]);++c<u;){var l=e[c];n>0&&o(l)?n>1?t(l,n-1,o,a,s):r(s,l):a||(s[s.length]=l)}return s}},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},,,,,,,,,,,,function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(52)(n(24),"WeakMap");t.exports=r},function(t,e,n){var r=n(149),i=n(208);function o(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}o.prototype=r(i.prototype),o.prototype.constructor=o,t.exports=o},function(t,e){t.exports=function(){}},function(t,e,n){var r=n(210),i=n(271),o=n(212);t.exports=function(t){return o(i(t,void 0,r),t+"")}},function(t,e,n){var r=n(191);t.exports=function(t){return null!=t&&t.length?r(t,1):[]}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(304),i=n(272)(r);t.exports=i},function(t,e,n){var r=n(52),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){var r=n(149),i=n(208),o=4294967295;function a(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=o,this.__views__=[]}a.prototype=r(i.prototype),a.prototype.constructor=a,t.exports=a},function(t,e,n){var r=n(72),i=n(95),o=n(22),a=n(89),s=1/0,c=r?r.prototype:void 0,u=c?c.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(a(e))return u?u.call(e):"";var n=e+"";return"0"==n&&1/e==-s?"-0":n}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(52)(n(24),"Set");t.exports=r},function(t,e,n){var r=n(211),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=i(o.length-e,0),c=Array(s);++a<s;)c[a]=o[e+a];a=-1;for(var u=Array(e+1);++a<e;)u[a]=o[a];return u[e]=n(c),r(t,this,u)}}},function(t,e){var n=800,r=16,i=Date.now;t.exports=function(t){var e=0,o=0;return function(){var a=i(),s=r-(a-o);if(o=a,s>0){if(++e>=n)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(374),i=n(128),o=r?function(t){return r.get(t)}:i;t.exports=o},,,,,,,,,,,function(t,e,n){var r=n(187),i=n(67);t.exports=function(t,e){return t&&r(t,e,i)}},function(t,e){t.exports=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var c=a[t?s:++i];if(!1===n(o[c],c,o))break}return e}}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(56),i=n(40),o="[object Arguments]";t.exports=function(t){return i(t)&&r(t)==o}},function(t,e,n){var r=n(72),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(56),i=n(143),o=n(40),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},function(t,e,n){var r=n(205)(Object.keys,Object);t.exports=r},function(t,e,n){var r=n(49);t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var o=n.length,a=e?o:-1,s=Object(n);(e?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},function(t,e,n){var r=n(112);t.exports=function(t){return"function"==typeof t?t:r}},function(t,e,n){var r=n(41),i=n(93),o=n(296),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&n.push(s);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var r=n(52)(n(24),"DataView");t.exports=r},function(t,e,n){var r=n(168),i=n(299),o=n(41),a=n(190),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,f=u.hasOwnProperty,d=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?d:s).test(a(t))}},function(t,e,n){var r,i=n(300),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},function(t,e,n){var r=n(24)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(52)(n(24),"Promise");t.exports=r},function(t,e,n){var r=n(72),i=n(92),o=n(22),a=r?r.isConcatSpreadable:void 0;t.exports=function(t){return o(t)||i(t)||!!(a&&t&&t[a])}},function(t,e,n){var r=n(305),i=n(213),o=n(112),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=a},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e,n){var r=n(429),i=Object.prototype.hasOwnProperty;t.exports=function(t){for(var e=t.name+"",n=r[e],o=i.call(r,e)?n.length:0;o--;){var a=n[o],s=a.func;if(null==s||s==t)return a.name}return e}},function(t,e,n){var r=n(95);t.exports=function(t,e){return r(e,function(e){return t[e]})}},function(t,e,n){var r=n(309),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,function(t,n,r,i){e.push(r?i.replace(o,"$1"):n||t)}),e});t.exports=a},function(t,e,n){var r=n(310),i=500;t.exports=function(t){var e=r(t,function(t){return n.size===i&&n.clear(),t}),n=e.cache;return e}},function(t,e,n){var r=n(174),i="Expected a function";function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(i);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},function(t,e,n){var r=n(312),i=n(129),o=n(148);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(t,e,n){var r=n(313),i=n(314),o=n(315),a=n(316),s=n(317);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,e,n){var r=n(96);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(96),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===i?void 0:n}return o.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(96),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(96),i="__lodash_hash_undefined__";t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?i:e,this}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(97),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():i.call(e,n,1),--this.size,0))}},function(t,e,n){var r=n(97);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(97);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(97);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(98);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(98);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(98);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(98);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(424);Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})})},function(t,e,n){t.exports=n(373)},function(t,e,n){var r=n(204),i=n(124),o=n(294),a=n(22);t.exports=function(t,e){return(a(t)?r:i)(t,o(e))}},function(t,e,n){var r=n(206),i=r&&new r;t.exports=i},function(t,e,n){var r=n(214),i=n(273),o=n(306),a=n(430);t.exports=function(t){var e=o(t),n=a[e];if("function"!=typeof n||!(e in r.prototype))return!1;if(t===n)return!0;var s=i(n);return!!s&&t===s[0]}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.destroyIframeByID=e.addIfDoesNotExistIframe=e.addOrReplaceIframe=e.createAndAppendIframe=e.addStylesheet=e.addScript=e.getIframeSkeleton=e.iframes=void 0;var r=o(n(372)),i=o(n(425));function o(t){return t&&t.__esModule?t:{default:t}}var a=e.iframes={},s=e.getIframeSkeleton=function(t,e){return'\n  <!DOCTYPE html>\n  <html lang="'+e+'">\n    <head></head>\n    <body>\n      <div id="'+t+'"></div>\n    </body>\n  </html>\n'},c=e.addScript=function(t,e){var n=t.createElement("script");return n.setAttribute("charset","utf-8"),n.setAttribute("type","text/javascript"),n.src=e,t.head.appendChild(n),t},u=e.addStylesheet=function(t,e){var n=t.createElement("link");return n.href=e,n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),t.head.appendChild(n),t},l=e.createAndAppendIframe=function(t,e,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",c=document.createElement("iframe");c.setAttribute("id",e),c.setAttribute("allowfullscreen",""),c.setAttribute("seamless",""),c.setAttribute("frameborder","0"),c.setAttribute("scrolling","no"),c.setAttribute("title",a),t.appendChild(c);var u=s(n,r);return c.contentWindow.document.open("text/html","replace"),c.contentWindow.document.write(u),c.contentWindow.document.close(),c.contentWindow.iframeId=e,(0,i.default)(o,function(t,e){c.style[e]=t}),c},f=e.addOrReplaceIframe=function(t,e,n,i,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",p=l(t,n,i,o,s,h),m=p.contentWindow.document;return f.forEach(function(t){c(m,t)}),d.forEach(function(t){u(m,t)}),(0,r.default)(e,function(t,e){p.contentWindow[e]=t}),a[n]=p,p};e.addIfDoesNotExistIframe=function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"";return a[n]||f(t,e,n,r,i,o,s,c,u)},e.destroyIframeByID=function(t){var e=a[t];e&&(e.parentNode.removeChild(e),delete a[t])};window.addEventListener("message",function(t){if("idz-iframe-resize"===t.data.type){var e=document.getElementById(t.data.payload.iframeId),n=t.data.payload.size,r=n.width,i=n.height;e.style.width=r+"px",e.style.height=i+"px"}},!1)},function(t,e,n){var r=n(187),i=n(294),o=n(144);t.exports=function(t,e){return null==t?t:r(t,i(e),o)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.SurveyNPSDisplayed="SurveyNPSDisplayed",e.SurveyNPSSubmitted="SurveyNPSSubmitted",e.SurveyCSATDisplayed="SurveyCSATDisplayed",e.SurveyCSATSubmitted="SurveyCSATSubmitted",e.SurveyCommentDisplayed="SurveyCommentDisplayed",e.SurveyCommentSubmitted="SurveyCommentSubmitted",e.SurveyRewardDisplayed="SurveyRewardDisplayed",e.SurveyRewardSubmitted="SurveyRewardSubmitted"},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.surveyCurrentStepSelector=e.surveyStepsSelector=e.surveyRootSelector=void 0;var r=n(6),i=e.surveyRootSelector=function(t){return(0,r.get)(t,"survey.survey",{})};e.surveyStepsSelector=function(t){return(0,r.get)(i(t),"steps",{})},e.surveyCurrentStepSelector=function(t){return(0,r.get)(i(t),"currentStep",{})}},function(t,e,n){var r=n(207),i=n(209),o=n(273),a=n(306),s=n(22),c=n(375),u="Expected a function",l=8,f=32,d=128,h=256;t.exports=function(t){return i(function(e){var n=e.length,i=n,p=r.prototype.thru;for(t&&e.reverse();i--;){var m=e[i];if("function"!=typeof m)throw new TypeError(u);if(p&&!g&&"wrapper"==a(m))var g=new r([],!0)}for(i=g?i:n;++i<n;){m=e[i];var v=a(m),_="wrapper"==v?o(m):void 0;g=_&&c(_[0])&&_[1]==(d|l|f|h)&&!_[4].length&&1==_[9]?g[a(_[0])].apply(g,_[3]):1==m.length&&c(m)?g[v]():g.thru(m)}return function(){var t=arguments,r=t[0];if(g&&1==t.length&&s(r))return g.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}},function(t,e){t.exports={}},function(t,e,n){var r=n(214),i=n(207),o=n(208),a=n(22),s=n(40),c=n(431),u=Object.prototype.hasOwnProperty;function l(t){if(s(t)&&!a(t)&&!(t instanceof r)){if(t instanceof i)return t;if(u.call(t,"__wrapped__"))return c(t)}return new i(t)}l.prototype=o.prototype,l.prototype.constructor=l,t.exports=l},function(t,e,n){var r=n(214),i=n(207),o=n(192);t.exports=function(t){if(t instanceof r)return t.clone();var e=new i(t.__wrapped__,t.__chain__);return e.__actions__=o(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.HIDDEN=1,e.OPENED=2,e.MINIMIZED=3,e.CHATBAR_HIDDEN=4},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.hideSurvey=e.displaySurvey=void 0;var r=n(371);e.displaySurvey=function(t,e){var n=t.buildHttpUrl,i=t.buildIdentifier,o=t.displaySurveyContainer,a=t.translationService,s=t.lang,c=t.featureFlags,u=n("js/dist/survey.js")+"?version="+i,l=n("js/dist/surveyStyle.js")+"?version="+i,f=[u],d=o();(0,r.addScript)(document,l),(0,r.addOrReplaceIframe)(document.body,{store:e,translationService:a,mountingEl:document.getElementById(d),featureFlags:c},"SURVEY_IFRAME","",s,{display:"none"},f,[],"Technical Survey iFrame")},e.hideSurvey=function(t){var e=t.shrinkDialogBox;(0,t.$)("#idz_button_close").click(),e(),(0,r.destroyIframeByID)("SURVEY_IFRAME")}},function(t,e){t.exports=function(t,e,n,r){var i=function(t){return""+e+t},o=function(e){return t.getJSON(i("api/conversations/"+e),{vuid:n,website_id:r}).then(function(t){return t.data})};return{getConversationHistoryById:o,getFetchPreviousConversationIterator:function(){var e=t.Deferred();return t.getJSON(i("api/conversations"),{vuid:n,website_id:r}).then(function(t){return t.data}).then(function(n){return e.resolve(function(e){return{conversationsMetadata:e,cursor:e.length-1,fetching:!1,hasNext:function(){return this.cursor>=0&&!this.fetching},next:function(){var e=this;return this.hasNext()?(this.fetching=!0,o(this.conversationsMetadata[this.cursor].legacyId).then(function(t){return e.cursor-=1,t}).always(function(t){return e.fetching=!1,t})):t.Deferred().resolve()}}}(n.reverse()))}),e.promise()}}}},function(t,e,n){"use strict";function r(t,e){this.stack=(new Error).stack,this.message=t||"An error as occured",this.name="UploadError",this.statusCode=e}function i(t){this.stack=(new Error).stack,this.message=t||"Upload aborted",this.name="AbortUploadError"}function o(t,e){this.stack=(new Error).stack,this.message=t||"An error as occured",this.name="HttpError",this.statusCode=e}function a(t){this.stack=(new Error).stack,this.message=t||"Request aborted",this.name="AbortedRequestError"}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o,a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,t.exports={HttpError:o,AbortedRequestError:a,UploadError:r,AbortUploadError:i}},function(t,e){t.exports=function(t){var e=t.split(" ");this.name=e.shift().substr(1),this.param1=e.shift()||"",this.param2=e.join(" ")}},function(t,e,n){var r=n(569),i=iAdvize.$;function o(t){var e=i(t);this.raw=e,this.id=e.attr("id")||null,this.to=e.attr("to"),this.from=e.attr("from").toLowerCase(),this.barejid=Strophe.getBareJidFromJid(this.from),this.type=e.attr("type"),this.bodies=e.find("body"),this.body=this.bodies.length?Strophe.xmlunescape(Strophe.getText(this.bodies[0])):"",this.x=e.find("x")}o.prototype={isChat:function(){return("chat"===this.type||"groupchat"===this.type)&&this.bodies.length>0&&!this.isCommand()},isCommand:function(){return 0===this.body.indexOf("!")},getCommand:function(){return this.command||(this.command=new r(this.body))}},t.exports=o},function(t,e,n){"use strict";var r=n(572).Emoji;t.exports=function(t){return r.parse(t).status}},function(t,e,n){"use strict";var r=n(573),i=n(574),o=e.OptionalVariationSelector=r.regex(/[\ufe0e\ufe0f]{0,1}/).desc("an optional variation selector (\\ufe0e or \\ufe0f)"),a=e.RequiredVariationSelector=r.regex(/[\ufe0e\ufe0f]/).desc("an required variation selector (\\ufe0e or \\ufe0f)"),s=r.seq(r.regex(/[0-9#*]/),o,r.string("⃣")).desc("a keycap emoji"),c=r.regex(/\ud83c[\udde6-\uddff]/).times(2).desc("a flag emoji"),u=r.seq(r.string("🏴󠁧󠁢"),r.alt(r.string("󠁷󠁬󠁳"),r.string("󠁳󠁣󠁴"),r.string("󠁥󠁮󠁧")),r.string("󠁿")),l=r.string("‍").desc("zero-width joiner (\\u200d)"),f=r.regex(/(\ud83c[\udffb-\udfff]){0,1}/).desc("an optional Fitzpatrick modifier"),d=r.alt(r.regex(/[\u203c-\u2bff]/),r.regex(/[\u2702-\u27b0]/),r.regex(/[\u3200-\u32ff]/),c,u,r.regex(/\ud83c[\udc04-\udfff]/),r.regex(/\ud83d[\udc00-\udfff]/),r.regex(/\ud83e[\udc00-\udfff]/)),h=r.seq(r.alt(r.string("©"),r.string("®"),r.string("〰"),r.string("〽")),a),p=r.seq(d,o,r.seq(l,d,o).times(1,3)),m=e.Emoji=r.seq(r.alt(h,p,r.seq(d,f,o),s),f).map(function(t){return i(t).join("")});e.parseOne=function(t){var e=m.parse(t);return!!e.status&&e.value},e.parse=function(t){var e=m.many().parse(t);return!!e.status&&e.value}},function(t,e,n){(function(e){"undefined"!=typeof self&&self,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,n,r){"use strict";function i(t){if(!(this instanceof i))return new i(t);this._=t}var o=i.prototype;function a(t,e){for(var n=0;n<t;n++)e(n)}function s(t,e,n){return function(t,e){a(e.length,function(n){t(e[n],n,e)})}(function(n,r,i){e=t(e,n,r,i)},n),e}function c(t,e){return s(function(e,n,r,i){return e.concat([t(n,r,i)])},[],e)}function u(t,n){var r={v:0,buf:n};return a(t,function(){var t;r={v:r.v<<1|(t=r.buf,t[0]>>7),buf:function(t){var n=s(function(t,n,r,i){return t.concat(r===i.length-1?e.from([n,0]).readUInt16BE(0):i.readUInt16BE(r))},[],t);return e.from(c(function(t){return(t<<1&65535)>>8},n))}(r.buf)}}),r}function l(){return void 0!==e}function f(){if(!l())throw new Error("Buffer global does not exist; please consider using https://github.com/feross/buffer if you are running Parsimmon in a browser.")}function d(t){f();var e=s(function(t,e){return t+e},0,t);if(e%8!=0)throw new Error("The bits ["+t.join(", ")+"] add up to "+e+" which is not an even number of bytes; the total should be divisible by 8");var n,r=e/8,o=(n=function(t){return t>48},s(function(t,e){return t||(n(e)?e:t)},null,t));if(o)throw new Error(o+" bit range requested exceeds 48 bit (6 byte) Number max.");return new i(function(e,n){var i=r+n;return i>e.length?E(n,r.toString()+" bytes"):T(i,s(function(t,e){var n=u(e,t.buf);return{coll:t.coll.concat(n.v),buf:n.buf}},{coll:[],buf:e.slice(n,i)},t).coll)})}function h(t,e){return f(),new i(function(n,r){return r+e>n.length?E(r,e+" bytes for "+t):T(r+e,n.slice(r,r+e))})}function p(t,e){if("number"!=typeof(n=e)||Math.floor(n)!==n||e<0||e>6)throw new Error(t+" requires integer length in range [0, 6].");var n}function m(t){return p("uintBE",t),h("uintBE("+t+")",t).map(function(e){return e.readUIntBE(0,t)})}function g(t){return p("uintLE",t),h("uintLE("+t+")",t).map(function(e){return e.readUIntLE(0,t)})}function v(t){return p("intBE",t),h("intBE("+t+")",t).map(function(e){return e.readIntBE(0,t)})}function _(t){return p("intLE",t),h("intLE("+t+")",t).map(function(e){return e.readIntLE(0,t)})}function y(t){return t instanceof i}function b(t){return"[object Array]"==={}.toString.call(t)}function S(t){return l()&&e.isBuffer(t)}function T(t,e){return{status:!0,index:t,value:e,furthest:-1,expected:[]}}function E(t,e){return b(e)||(e=[e]),{status:!1,index:-1,value:null,furthest:t,expected:e}}function C(t,e){if(!e)return t;if(t.furthest>e.furthest)return t;var n=t.furthest===e.furthest?function(t,e){for(var n={},r=0;r<t.length;r++)n[t[r]]=!0;for(var i=0;i<e.length;i++)n[e[i]]=!0;var o=[];for(var a in n)({}).hasOwnProperty.call(n,a)&&o.push(a);return o.sort(),o}(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:n}}function w(t,e){if(S(t))return{offset:e,line:-1,column:-1};var n=t.slice(0,e).split("\n");return{offset:e,line:n.length,column:n[n.length-1].length+1}}function A(t){if(!y(t))throw new Error("not a parser: "+t)}function O(t,e){return"string"==typeof t?t.charAt(e):t[e]}function x(t){if("number"!=typeof t)throw new Error("not a number: "+t)}function R(t){if("function"!=typeof t)throw new Error("not a function: "+t)}function I(t){if("string"!=typeof t)throw new Error("not a string: "+t)}var N=2,M=3,P=8,D=5*P,k=4*P,j="  ";function U(t,e){return new Array(e+1).join(t)}function z(t,e,n){var r=e-t.length;return r<=0?t:U(n,r)+t}function L(t,e,n,r){return{from:t-e>0?t-e:0,to:t+n>r?r:t+n}}function B(t,e){var n,r,i,o,a,u=e.index,l=u.offset,f=1;if(l===t.length)return"Got the end of the input";if(S(t)){var d=l-l%P,h=l-d,p=L(d,D,k+P,t.length),m=c(function(t){return c(function(t){return z(t.toString(16),2,"0")},t)},function(t,e){var n=t.length,r=[],i=0;if(n<=e)return[t.slice()];for(var o=0;o<n;o++)r[i]||r.push([]),r[i].push(t[o]),(o+1)%e==0&&i++;return r}(t.slice(p.from,p.to).toJSON().data,P));o=function(t){return 0===t.from&&1===t.to?{from:t.from,to:t.to}:{from:t.from/P,to:Math.floor(t.to/P)}}(p),r=d/P,n=3*h,h>=4&&(n+=1),f=2,i=c(function(t){return t.length<=4?t.join(" "):t.slice(0,4).join(" ")+"  "+t.slice(4).join(" ")},m),(a=(8*(o.to>0?o.to-1:o.to)).toString(16).length)<2&&(a=2)}else{var g=t.split(/\r\n|[\n\r\u2028\u2029]/);n=u.column-1,r=u.line-1,o=L(r,N,M,g.length),i=g.slice(o.from,o.to),a=o.to.toString().length}var v=r-o.from;return S(t)&&(a=(8*(o.to>0?o.to-1:o.to)).toString(16).length)<2&&(a=2),s(function(e,r,i){var s,c=i===v,u=c?"> ":j;return s=S(t)?z((8*(o.from+i)).toString(16),a,"0"):z((o.from+i+1).toString(),a," "),[].concat(e,[u+s+" | "+r],c?[j+U(" ",a)+" | "+z("",n," ")+U("^",f)]:[])},[],i).join("\n")}function F(t,e){return["\n","-- PARSING FAILED "+U("-",50),"\n\n",B(t,e),"\n\n",(n=e.expected,1===n.length?"Expected:\n\n"+n[0]:"Expected one of the following: \n\n"+n.join(", ")),"\n"].join("");var n}function H(t){var e=""+t;return e.slice(e.lastIndexOf("/")+1)}function q(){for(var t=[].slice.call(arguments),e=t.length,n=0;n<e;n+=1)A(t[n]);return i(function(n,r){for(var i,o=new Array(e),a=0;a<e;a+=1){if(!(i=C(t[a]._(n,r),i)).status)return i;o[a]=i.value,r=i.index}return C(T(r,o),i)})}function G(){var t=[].slice.call(arguments);if(0===t.length)throw new Error("seqMap needs at least one argument");var e=t.pop();return R(e),q.apply(null,t).map(function(t){return e.apply(null,t)})}function V(){var t=[].slice.call(arguments),e=t.length;if(0===e)return K("zero alternates");for(var n=0;n<e;n+=1)A(t[n]);return i(function(e,n){for(var r,i=0;i<t.length;i+=1)if((r=C(t[i]._(e,n),r)).status)return r;return r})}function Y(t,e){return W(t,e).or(X([]))}function W(t,e){return A(t),A(e),G(t,e.then(t).many(),function(t,e){return[t].concat(e)})}function $(t){I(t);var e="'"+t+"'";return i(function(n,r){var i=r+t.length,o=n.slice(r,i);return o===t?T(i,o):E(r,e)})}function J(t,e){!function(t){if(!(t instanceof RegExp))throw new Error("not a regexp: "+t);for(var e=H(t),n=0;n<e.length;n++){var r=e.charAt(n);if("i"!==r&&"m"!==r&&"u"!==r)throw new Error('unsupported regexp flag "'+r+'": '+t)}}(t),arguments.length>=2?x(e):e=0;var n=function(t){return RegExp("^(?:"+t.source+")",H(t))}(t),r=""+t;return i(function(t,i){var o=n.exec(t.slice(i));if(o){if(0<=e&&e<=o.length){var a=o[0],s=o[e];return T(i+a.length,s)}return E(i,"valid match group (0 to "+o.length+") in "+r)}return E(i,r)})}function X(t){return i(function(e,n){return T(n,t)})}function K(t){return i(function(e,n){return E(n,t)})}function Q(t){if(y(t))return i(function(e,n){var r=t._(e,n);return r.index=n,r.value="",r});if("string"==typeof t)return Q($(t));if(t instanceof RegExp)return Q(J(t));throw new Error("not a string, regexp, or parser: "+t)}function Z(t){return A(t),i(function(e,n){var r=t._(e,n),i=e.slice(n,r.index);return r.status?E(n,'not "'+i+'"'):T(n,null)})}function tt(t){return R(t),i(function(e,n){var r=O(e,n);return n<e.length&&t(r)?T(n+1,r):E(n,"a character/byte matching "+t)})}function et(t,e){arguments.length<2&&(e=t,t=void 0);var n=i(function(t,r){return n._=e()._,n._(t,r)});return t?n.desc(t):n}function nt(){return K("fantasy-land/empty")}o.parse=function(t){if("string"!=typeof t&&!S(t))throw new Error(".parse must be called with a string or Buffer as its argument");var e=this.skip(at)._(t,0);return e.status?{status:!0,value:e.value}:{status:!1,index:w(t,e.furthest),expected:e.expected}},o.tryParse=function(t){var e=this.parse(t);if(e.status)return e.value;var n=F(t,e),r=new Error(n);throw r.type="ParsimmonError",r.result=e,r},o.or=function(t){return V(this,t)},o.trim=function(t){return this.wrap(t,t)},o.wrap=function(t,e){return G(t,this,e,function(t,e){return e})},o.thru=function(t){return t(this)},o.then=function(t){return A(t),q(this,t).map(function(t){return t[1]})},o.many=function(){var t=this;return i(function(e,n){for(var r=[],i=void 0;;){if(!(i=C(t._(e,n),i)).status)return C(T(n,r),i);if(n===i.index)throw new Error("infinite loop detected in .many() parser --- calling .many() on a parser which can accept zero characters is usually the cause");n=i.index,r.push(i.value)}})},o.tieWith=function(t){return I(t),this.map(function(e){if(function(t){if(!b(t))throw new Error("not an array: "+t)}(e),e.length){I(e[0]);for(var n=e[0],r=1;r<e.length;r++)I(e[r]),n+=t+e[r];return n}return""})},o.tie=function(){return this.tieWith("")},o.times=function(t,e){var n=this;return arguments.length<2&&(e=t),x(t),x(e),i(function(r,i){for(var o=[],a=void 0,s=void 0,c=0;c<t;c+=1){if(s=C(a=n._(r,i),s),!a.status)return s;i=a.index,o.push(a.value)}for(;c<e&&(s=C(a=n._(r,i),s),a.status);c+=1)i=a.index,o.push(a.value);return C(T(i,o),s)})},o.result=function(t){return this.map(function(){return t})},o.atMost=function(t){return this.times(0,t)},o.atLeast=function(t){return G(this.times(t),this.many(),function(t,e){return t.concat(e)})},o.map=function(t){R(t);var e=this;return i(function(n,r){var i=e._(n,r);return i.status?C(T(i.index,t(i.value)),i):i})},o.contramap=function(t){R(t);var e=this;return i(function(n,r){var i=e.parse(t(n.slice(r)));return i.status?T(r+n.length,i.value):i})},o.promap=function(t,e){return R(t),R(e),this.contramap(t).map(e)},o.skip=function(t){return q(this,t).map(function(t){return t[0]})},o.mark=function(){return G(rt,this,rt,function(t,e,n){return{start:t,value:e,end:n}})},o.node=function(t){return G(rt,this,rt,function(e,n,r){return{name:t,value:n,start:e,end:r}})},o.sepBy=function(t){return Y(this,t)},o.sepBy1=function(t){return W(this,t)},o.lookahead=function(t){return this.skip(Q(t))},o.notFollowedBy=function(t){return this.skip(Z(t))},o.desc=function(t){b(t)||(t=[t]);var e=this;return i(function(n,r){var i=e._(n,r);return i.status||(i.expected=t),i})},o.fallback=function(t){return this.or(X(t))},o.ap=function(t){return G(t,this,function(t,e){return t(e)})},o.chain=function(t){var e=this;return i(function(n,r){var i=e._(n,r);return i.status?C(t(i.value)._(n,i.index),i):i})},o.concat=o.or,o.empty=nt,o.of=X,o["fantasy-land/ap"]=o.ap,o["fantasy-land/chain"]=o.chain,o["fantasy-land/concat"]=o.concat,o["fantasy-land/empty"]=o.empty,o["fantasy-land/of"]=o.of,o["fantasy-land/map"]=o.map;var rt=i(function(t,e){return T(e,w(t,e))}),it=i(function(t,e){return e>=t.length?E(e,"any character/byte"):T(e+1,O(t,e))}),ot=i(function(t,e){return T(t.length,t.slice(e))}),at=i(function(t,e){return e<t.length?E(e,"EOF"):T(e,null)}),st=J(/[0-9]/).desc("a digit"),ct=J(/[0-9]*/).desc("optional digits"),ut=J(/[a-z]/i).desc("a letter"),lt=J(/[a-z]*/i).desc("optional letters"),ft=J(/\s*/).desc("optional whitespace"),dt=J(/\s+/).desc("whitespace"),ht=$("\r"),pt=$("\n"),mt=$("\r\n"),gt=V(mt,pt,ht).desc("newline"),vt=V(gt,at);i.all=ot,i.alt=V,i.any=it,i.cr=ht,i.createLanguage=function(t){var e={};for(var n in t)({}).hasOwnProperty.call(t,n)&&function(n){e[n]=et(function(){return t[n](e)})}(n);return e},i.crlf=mt,i.custom=function(t){return i(t(T,E))},i.digit=st,i.digits=ct,i.empty=nt,i.end=vt,i.eof=at,i.fail=K,i.formatError=F,i.index=rt,i.isParser=y,i.lazy=et,i.letter=ut,i.letters=lt,i.lf=pt,i.lookahead=Q,i.makeFailure=E,i.makeSuccess=T,i.newline=gt,i.noneOf=function(t){return tt(function(e){return t.indexOf(e)<0}).desc("none of '"+t+"'")},i.notFollowedBy=Z,i.of=X,i.oneOf=function(t){for(var e=t.split(""),n=0;n<e.length;n++)e[n]="'"+e[n]+"'";return tt(function(e){return t.indexOf(e)>=0}).desc(e)},i.optWhitespace=ft,i.Parser=i,i.range=function(t,e){return tt(function(n){return t<=n&&n<=e}).desc(t+"-"+e)},i.regex=J,i.regexp=J,i.sepBy=Y,i.sepBy1=W,i.seq=q,i.seqMap=G,i.seqObj=function(){for(var t,e={},n=0,r=(t=arguments,Array.prototype.slice.call(t)),o=r.length,a=0;a<o;a+=1){var s=r[a];if(!y(s)){if(b(s)&&2===s.length&&"string"==typeof s[0]&&y(s[1])){var c=s[0];if(Object.prototype.hasOwnProperty.call(e,c))throw new Error("seqObj: duplicate key "+c);e[c]=!0,n++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(0===n)throw new Error("seqObj expects at least one named parser, found zero");return i(function(t,e){for(var n,i={},a=0;a<o;a+=1){var s,c;if(b(r[a])?(s=r[a][0],c=r[a][1]):(s=null,c=r[a]),!(n=C(c._(t,e),n)).status)return n;s&&(i[s]=n.value),e=n.index}return C(T(e,i),n)})},i.string=$,i.succeed=X,i.takeWhile=function(t){return R(t),i(function(e,n){for(var r=n;r<e.length&&t(O(e,r));)r++;return T(r,e.slice(n,r))})},i.test=tt,i.whitespace=dt,i["fantasy-land/empty"]=nt,i["fantasy-land/of"]=X,i.Binary={bitSeq:d,bitSeqObj:function(t){f();var e={},n=0,r=c(function(t){if(b(t)){var r=t;if(2!==r.length)throw new Error("["+r.join(", ")+"] should be length 2, got length "+r.length);if(I(r[0]),x(r[1]),Object.prototype.hasOwnProperty.call(e,r[0]))throw new Error("duplicate key in bitSeqObj: "+r[0]);return e[r[0]]=!0,n++,r}return x(t),[null,t]},t);if(n<1)throw new Error("bitSeqObj expects at least one named pair, got ["+t.join(", ")+"]");var i=c(function(t){return t[0]},r);return d(c(function(t){return t[1]},r)).map(function(t){return s(function(t,e){return null!==e[0]&&(t[e[0]]=e[1]),t},{},c(function(e,n){return[e,t[n]]},i))})},byte:function(t){if(f(),x(t),t>255)throw new Error("Value specified to byte constructor ("+t+"=0x"+t.toString(16)+") is larger in value than a single byte.");var e=(t>15?"0x":"0x0")+t.toString(16);return i(function(n,r){var i=O(n,r);return i===t?T(r+1,i):E(r,e)})},buffer:function(t){return h("buffer",t).map(function(t){return e.from(t)})},encodedString:function(t,e){return h("string",e).map(function(e){return e.toString(t)})},uintBE:m,uint8BE:m(1),uint16BE:m(2),uint32BE:m(4),uintLE:g,uint8LE:g(1),uint16LE:g(2),uint32LE:g(4),intBE:v,int8BE:v(1),int16BE:v(2),int32BE:v(4),intLE:_,int8LE:_(1),int16LE:_(2),int32LE:_(4),floatBE:h("floatBE",4).map(function(t){return t.readFloatBE(0)}),floatLE:h("floatLE",4).map(function(t){return t.readFloatLE(0)}),doubleBE:h("doubleBE",8).map(function(t){return t.readDoubleBE(0)}),doubleLE:h("doubleLE",8).map(function(t){return t.readDoubleLE(0)})},t.exports=i}])}).call(this,n(843).Buffer)},function(t,e,n){(function(e){var n=1/0,r=9007199254740991,i="[object Arguments]",o="[object Function]",a="[object GeneratorFunction]",s="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,u=s||c||Function("return this")();function l(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var f=Object.prototype,d=f.hasOwnProperty,h=f.toString,p=u.Symbol,m=f.propertyIsEnumerable,g=p?p.isConcatSpreadable:void 0;function v(t){return _(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?h.call(t):"";return e==o||e==a}(t)}(t)}(t)&&d.call(t,"callee")&&(!m.call(t,"callee")||h.call(t)==i)}(t)||!!(g&&t&&t[g])}var _=Array.isArray;t.exports=function(t){return t&&t.length?function t(e,n,r,i,o){var a=-1,s=e.length;for(r||(r=v),o||(o=[]);++a<s;){var c=e[a];n>0&&r(c)?n>1?t(c,n-1,r,i,o):l(o,c):i||(o[o.length]=c)}return o}(t,n):[]}}).call(this,n(21))},function(t,e,n){"use strict";var r=n(572).Emoji,i=n(573),o=n(574),a=i.regex(/[\uD800-\uDBFF][\uDC00-\uDFFF]/),s=e.Unicode=i.alt(r,i.regex(/[\u0000-\uD799]/),i.regex(/[\uE000-\uFFFF]/),a);e.parseOne=function(t){var e=s.parse(t);return!!e.status&&o(e.value).join("")},e.parse=function(t){var e=s.many().parse(t);return!!e.status&&e.value.map(function(t){return o(t).join("")})}},function(t,e){t.exports=function(t){return{isAsyncChatEnabled:function(){return t.featureFlags["iadvize.conversations.asynchronous-livechat"]},isChatboxV2Enabled:function(){return t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]},isHistoryv2Enabled:function(){return t.featureFlags["iadvize.conversations.livechat-history-v2"]}}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.parseCards=e.parseCard=void 0;var r=n(578),i=n(579),o=e.parseCard=function(t){if(t.length)return{title:t.find("title:first").text(),text:t.find("text:first").text(),image:(0,r.parseImage)(t.find("image:first")),actions:(0,i.parseActions)(t.find("actions:first"))}};e.parseCards=function(t){if(t.length)return t.find("card").map(function(){return o(iAdvize.$(this))}).get()}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.parseImage=function(t){if(t.length)return{url:t.find("url:first").text(),description:t.find("description:first").text()}}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.parseActions=function(t){return t.find("action").map(function(t,e){var n=(iAdvize.$(e).attr("xmlns")||"").split("#")[1];switch(n){case"link":return{type:n,title:iAdvize.$(e).find("title:first").text(),url:iAdvize.$(e).find("url:first").text()};default:return!1}}).get().filter(Boolean)}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.parseProductOffers=e.parseProductOffer=void 0;var r=n(578),i=n(579),o=n(882),a=e.parseProductOffer=function(t){if(t.length)return{name:t.find("name:first").text(),price:t.find("price:first").text(),offerPrice:t.find("offer-price:first").text(),description:t.find("description:first").text(),availability:(0,o.parseAvailability)(t.find("availability:first")),image:(0,r.parseImage)(t.find("image:first")),actions:(0,i.parseActions)(t.find("actions:first"))}};e.parseProductOffers=function(t){if(t.length)return t.find("product-offer").map(function(){return a(iAdvize.$(this))}).get()}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.hidesreactComponent=function(t){t.render().style.display="none"},e.showsreactComponent=function(t){t.render().style.display="block"},e.setClassTosreactComponent=function(t,e){t.render().className=e},e.addClassTosreactComponent=function(t,e){var n=t.render().className;t.render().className=n+" "+e},e.removeClassTosreactComponent=function(t,e){var n=(t.render().className||"").replace(e,"");t.render().className=n}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r,i,o,a,s,c,u,l=n(6),f=n(566),d=p(n(800)),h=p(n(816));function p(t){return t&&t.__esModule?t:{default:t}}r=iAdvize.require("dispatcher"),i=n(817)(iAdvize),o=n(820)(iAdvize),a=r.events,s=(0,d.default)(iAdvize),c=n(821)(r,a,o,iAdvize,i.uploadService),u=n(838)(iAdvize,r,a),n(849)(iAdvize,r,a,c),n(888)(r,a,iAdvize,u),n(893)(iAdvize,r,c),n(902),n(905),r.on(a.OnDisplaySurveyForm,function(){if((0,h.default)()){var t=(0,l.get)(iAdvize,"featureFlags",{});(0,f.displaySurvey)({buildHttpUrl:iAdvize.urls.buildHttpUrl,buildIdentifier:iAdvize.buildIdentifier,displaySurveyContainer:iAdvize.Templates.displaySurveyContainer,translationService:iAdvize.T,lang:iAdvize.curlang,featureFlags:t},s)}else iAdvize.Templates.displaySatisfaction()}),iAdvize.onCoreLoaded(function(){r.emit(a.livechatModuleLoaded),iAdvize.Templates.onLivechatModuleLoaded()})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(20),i=n(6),o=u(n(801)),a=u(n(805)),s=u(n(810)),c=u(n(815));function u(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){var e=iAdvize.require("dispatcher"),n=t.$,u=function(){return t.chat.history_id||t.chat.prev_history},l=t.chaturl,f=t.services,d=t.platform,h=t.website_id,p=t.vuid,m=t.Templates,g=(0,c.default)(l,f),v=(0,s.default)(n,g,u,d,h,p,l),_=(0,a.default)(n,m,e,v,u),y=Array.prototype.reduce;Array.prototype.reduce=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.reduce.apply(void 0,[this].concat(e))};var b=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,r.compose),S=(0,r.createStore)(o.default,b(r.applyMiddleware.apply(void 0,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(_))));return Array.prototype.reduce=y,S}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(20),o=n(802),a=(r=o)&&r.__esModule?r:{default:r};var s=(0,i.combineReducers)({survey:a.default});e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(20),i=a(n(803)),o=a(n(804));function a(t){return t&&t.__esModule?t:{default:t}}var s=(0,r.combineReducers)({survey:i.default,featureFlags:o.default});e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.getLastOperator=e.surveyGetRewards=e.surveyNextStep=e.surveyPreviousStep=e.closeSurvey=e.initSurvey=e.initialState=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=n(6),o=n(145),a=e.initialState={currentStep:null,steps:[],rewards:[],isIbbuExpert:!1},s=e.initSurvey=function(t,e){var n=e.steps;return r({},t,{steps:n,currentStep:n[0]||null})},c=e.closeSurvey=function(t){return r({},t,{currentStep:t.steps[0]||null})},u=e.surveyPreviousStep=function(t){var e=t.steps.indexOf(t.currentStep)>0?t.steps.indexOf(t.currentStep)-1:0;return r({},t,{currentStep:t.steps[e]})},l=e.surveyNextStep=function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipStep:null}).skipStep,n=t.steps.indexOf(t.currentStep),i=function t(e,n,r){var i=n+1;return i>e.length?t(e,-1,r):function(t,e){return t===e}(e[i],r)?t(e,i,r):i}(t.steps,n,e);return r({},t,{currentStep:t.steps[i]})},f=e.surveyGetRewards=function(t,e){var n=e.rewards.map(function(t){return{id:t.id,name:t.label,url:t.icon}});return r({},t,{rewards:n})},d=e.getLastOperator=function(t,e){var n=e.conversationHistory.messages.filter(function(t){return"MESSAGE"===t.type}).filter(function(t){return"VISITOR"!==t.author.type}),o=!(0,i.isEmpty)(n)&&"IBBU_EXPERT"===(0,i.last)(n).author.type;return r({},t,{isIbbuExpert:o})};e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1];switch(e.type){case o.INIT_SURVEY:return s(t,e.payload);case o.SURVEY_PREVIOUS_STEP:return u(t);case o.SURVEY_NEXT_STEP:return l(t,e.payload);case o.SURVEY_REWARDS_GET_SUCCESS:return f(t,e.payload);case o.CONVERSATION_HISTORY_GET_SUCCESS:return d(t,e.payload);case o.CLOSE_SURVEY:return c(t);default:return t}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.setFeatureFlags=e.initialState=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=n(145),o=e.initialState={},a=e.setFeatureFlags=function(t,e){var n=e.featureFlags;return r({},t,n)};e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,e=arguments[1];switch(e.type){case i.INIT_SURVEY:return a(t,e.payload);default:return t}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(806)),i=o(n(807));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,n,o,a){var s=r.default.withExtraArgument(o),c=(0,i.default)(t,e,n,a);return[s].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(c))}},function(t,e,n){"use strict";function r(t){return function(e){var n=e.dispatch,r=e.getState;return function(e){return function(i){return"function"==typeof i?i(n,r,t):e(i)}}}}n.r(e);var i=r();i.withExtraArgument=r,e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(808)),i=o(n(809));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,n,o){return[(0,r.default)(t,e),(0,i.default)(n,o)]}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(566),i=n(145);e.default=function(t,e){return function(n){return function(n){return function(o){switch(n(o),o.type){case i.CLOSE_SURVEY:(0,r.hideSurvey)({shrinkDialogBox:e.shrinkDialogBox,$:t})}}}}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(145),i=n(127),o=n(426),a=n(427);e.default=function(t,e){return function(n){return function(s){return function(c){s(c);var u=n.getState();switch(c.type){case r.INIT_SURVEY:case r.SURVEY_NEXT_STEP:case r.SURVEY_PREVIOUS_STEP:!function(t,e,n){var r={chatId:e};switch(n){case i.SURVEY_STEP_NPS:t.emit(o.SurveyNPSDisplayed,r);break;case i.SURVEY_STEP_CSAT:t.emit(o.SurveyCSATDisplayed,r);break;case i.SURVEY_STEP_COMMENT:t.emit(o.SurveyCommentDisplayed,r);break;case i.SURVEY_STEP_REWARDS:t.emit(o.SurveyRewardDisplayed,r)}}(t,e(),(0,a.surveyCurrentStepSelector)(u));break;case r.SURVEY_NPS_SUBMIT_SUCCESS:t.emit(o.SurveyNPSSubmitted,{chatId:e()});break;case r.SURVEY_CSAT_SUBMIT_SUCCESS:t.emit(o.SurveyCSATSubmitted,{chatId:e()});break;case r.SURVEY_COMMENT_SUBMIT_SUCCESS:t.emit(o.SurveyCommentSubmitted,{chatId:e()});break;case r.SURVEY_REWARD_SUBMIT:t.emit(o.SurveyRewardSubmitted,{chatId:e(),reward:c.payload.reward})}}}}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=a(n(811)),o=a(n(567));function a(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,n,a,s,c,u){return r({},(0,i.default)(t,e,n,a,s,c),{historyService:(0,o.default)(t,u,c,s)})}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=a(n(812)),o=a(n(814));function a(t){return t&&t.__esModule?t:{default:t}}var s={surveyService:i.default,oldSatisfactionService:o.default};e.default=function(t,e,n,i,o,a){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:window.iAdvize,u=(0,r.get)(c,"curlang","en_UK");return(0,r.mapValues)(s,function(r){return r({$:t,apiConfig:e,getChatId:n,platform:i,websiteId:o,vuid:a,idz:c,userLanguage:u})})}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=n(813);e.default=function(t){var e=t.$,n=t.apiConfig,o=t.getChatId,a=t.platform,s=t.vuid,c=t.idz,u=t.userLanguage,l=n.apiV3["conversations-api-service"],f=l.nps,d=l.csat,h=l.comment;return{saveNPS:function(t){var n={id:o(),vuid:s,grade:i.TYPE_FIELD_NPS,value:t};return e.ajax({type:"POST",url:f+"?platform="+a,data:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8"})},saveCSAT:function(t){var n={id:o(),vuid:s,grade:i.TYPE_FIELD_CSAT,value:t};return e.ajax({type:"POST",url:d+"?platform="+a,data:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8"})},saveComment:function(t){var n={id:o(),vuid:s,grade:i.TYPE_FIELD_COMMENT,value:t};return e.ajax({type:"POST",url:h+"?platform="+a,data:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8"})},getRewardsList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.shuffle,n={query:"{\n        rewards(lang: "+(u.replace("-","_")||"en_UK")+") {\n          id\n          label\n          icon(size: SMALL)\n          description\n        }\n      }"};return e.ajax({type:"POST",url:c.graphql.url,data:JSON.stringify(n),contentType:"application/json",processData:!1,headers:{Accept:"application/vnd.iadvize.employment-preview+json"}}).then(function(e){return t(e.data.rewards)})}}}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=e.TYPE_FIELD_NPS="NPS",r=e.TYPE_FIELD_CSAT="CSAT",i=e.TYPE_FIELD_COMMENT="COMMENT";e.TYPE_FIELDS=[n,r,i]},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.$,n=t.apiConfig,r=t.getChatId,i=t.websiteId,o=t.vuid;return{saveCustomerSatisfactionAsOldSatisfaction:function(t){var a="";a=1===t||2===t?"3|3|3|":3===t?"2|2|2|":"1|1|1|";var s=["save="+i,"&u="+o,"&hid="+r(),"&data="+encodeURIComponent(a)].join(""),c=n.apiLivechat.satisfaction+"?"+s;return e.ajax({type:"GET",url:c})}}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(6);e.default=function(t,e){var n={apiLivechat:{satisfaction:"rpc/satisfaction.php"},apiV3:{services:{"conversations-api-service":{nps:"grade",csat:"grade",comment:"grade"}}}};return n.apiLivechat=(0,r.mapValues)(n.apiLivechat,function(e){return""+t+e}),n.apiV3=(0,r.mapValues)(n.apiV3.services,function(t,n){return(0,r.mapValues)(t,function(t){return""+e[n]+t})}),n}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=100*Math.random();e.default=function(){var t=(0,r.get)(window,["iAdvize","featureFlags","iadvize.reports.customer-experience"],!1),e=(0,r.get)(window,["iAdvize","featureFlags","iadvize.conversations.new-survey-ratio"],20),n=t&&i<=e,o=document.location.href.indexOf("iadvizeForceDarkLaunchSurvey")>-1;return n||o}},function(t,e,n){"use strict";t.exports=function(t){var e=t.$,r=n(818)(e);return{httpService:r,uploadService:n(819)(e,r)}}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t){var e={},i=n(568);return r.forEach(["get","post","put","delete"],function(n){e[n]=function(e,o,a){return function(e,n,o,a){var s=t.Deferred(),c=!1,u=r.noop;return a=a||{},o=r.assign({dataType:"json",contentType:"application/json",data:a,type:n,url:e,beforeSend:function(t,e){return u=t.abort,!c}},o),t.ajax(o).then(function(t){s.resolve(t)},function(t){var e=new i.HttpError(""+t.statusText,t.status||0);0===t.status&&"abort"===t.statusText&&(e=new i.AbortedRequestError("Aborted")),s.reject(e)}),function t(e,n){return e.abort=n,e.then=r.wrap(e.then.bind(e),function(e,r,i){return t(e(r,i),n)}),e}(s.promise(),function(){c=!0,u()})}(e,n.toUpperCase(),o,a)}}),e}},function(t,e,n){"use strict";var r=n(6).assign;t.exports=function(t,e){var i={},o=n(568),a=function(t){throw"AbortedRequestError"===t.name?new o.AbortUploadError(t.message):new o.UploadError(t.message,t.statusCode)};return i.upload=function(n,i,o,s){s=s||{};var c=r({data:n,processData:!1,contentType:n.type,cache:!1,dataType:"xml",xhr:function(){var e=t.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(t){if(o){var e=parseInt(t.loaded/t.total*100,10);o(e)}},!1),e}},s);return e.put(i,c).fail(a)},i}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t){var e=[],n=r.debounce(function(){t.$.ajax({type:"POST",contentType:"application/json; charset=UTF-8",url:t.chaturl+"rpc/mail_error.php",data:JSON.stringify(e),processData:!1,complete:function(){}}),e=[]},15e3,{leading:!1,trailing:!0}),i=function(e){t.$.ajax({type:"POST",contentType:"application/json; charset=UTF-8",url:t.chaturl+"rpc/mail_error.php",data:JSON.stringify([e]),processData:!1,complete:function(){}})};function o(r,i,o,a){if(!t.PROD)return console.error(i,r,o,a);e.push({desc:r,err:JSON.stringify(i),msg:o,extras:JSON.stringify(a)}),n()}function a(r,i,o){if(!t.PROD)return console.log(r,i,o);e.push({desc:r,msg:i,extras:JSON.stringify(o)}),n()}function s(e,n,r,o){if(!t.PROD)return console.error(n,e,r,o);var a={desc:e,err:JSON.stringify(n),msg:r,extras:JSON.stringify(o)};i(a)}return t.define("logger",function(){return{error:o,urgent_error:s,info:a}}),{error:o,urgent_error:s,info:a}}},function(t,e,n){"use strict";var r=n(822),i=n(823);window.Strophe=i.Strophe,window.$build=i.$build,window.$iq=i.$iq,window.$msg=i.$msg,window.$pres=i.$pres,n(824),n(825),n(826)(window.Strophe),n(827)(window.Strophe),t.exports=function(t,e,i,o,a){var s=n(828),c=n(569),u=n(570),l=n(829),f=new(n(830))(o.$),d=n(831)(Strophe,t,e,f,o,u,c,l,i,r.namespaceToEvent);n(832)(t,e,d.getConnection,a,o.website_id),n(835)(t,e,o,d.getConnection);var h=n(836)(t,e,o,d.getConnection,s),p=n(837)(t,e,o,d.getConnection);return o.define("xmpp",function(){return{invitation:p,connect:d.connect,getConnection:d.getConnection,sendChatState:d.sendChatState,room:d.room,isOnline:h.isOnline}}),{namespaces:r.namespaces,invitation:p,connection:d,roster:h,stanzaBuilder:Strophe.Builder}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.namespaceToEvent=e.keyToEvent=e.namespaces=e.baseNamespaceUri=void 0;var r=n(6),i=e.baseNamespaceUri="http://iadvize.com/protocol/",o=["call_errored","call_operator_answered","call_started","call_stopped","cobrowsing_accepted","cobrowsing_asked","cobrowsing_refused","cobrowsing_started","cobrowsing_stopped","conversation_closed","custom_data_requested","custom_data_sent","engage_received","engagement_rule_triggered","link_sent","offer_sent","card_sent","card_bundle_sent","product_offer_sent","product_offer_bundle_sent","file_sent","quick_replies_sent","visitor_blocked","visitor_profile_requested","visitor_profile_sent"],a=e.namespaces=(0,r.merge)((0,r.mapValues)((0,r.keyBy)(o,function(t){return"event_"+t}),function(t){return i+"events#"+t})),s=(0,r.invert)(a),c=e.keyToEvent=(0,r.merge)((0,r.mapValues)((0,r.keyBy)(o,function(t){return"event_"+t}),function(t){return"OnEvent"+(0,r.upperFirst)((0,r.camelCase)(t))}));e.namespaceToEvent=function(t){if(s.hasOwnProperty(t)&&c[s[t]])return c[s[t]];throw new Error("Unknown namespace")}},function(t,e){var n;n=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(e){var n,r,i,o,a,s,c,u="",l=0;do{o=(n=e.charCodeAt(l++))>>2,a=(3&n)<<4|(r=e.charCodeAt(l++))>>4,s=(15&r)<<2|(i=e.charCodeAt(l++))>>6,c=63&i,isNaN(r)?(a=(3&n)<<4,s=c=64):isNaN(i)&&(c=64),u=u+t.charAt(o)+t.charAt(a)+t.charAt(s)+t.charAt(c)}while(l<e.length);return u},decode:function(e){var n,r,i,o,a,s,c="",u=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{n=t.indexOf(e.charAt(u++))<<2|(o=t.indexOf(e.charAt(u++)))>>4,r=(15&o)<<4|(a=t.indexOf(e.charAt(u++)))>>2,i=(3&a)<<6|(s=t.indexOf(e.charAt(u++))),c+=String.fromCharCode(n),64!=a&&(c+=String.fromCharCode(r)),64!=s&&(c+=String.fromCharCode(i))}while(u<e.length);return c}}},this.Base64=n(),function(t,e){t.SHA1=e()}(this,function(){function t(t,r){t[r>>5]|=128<<24-r%32,t[15+(r+64>>9<<4)]=r;var a,s,c,u,l,f,d,h,p=new Array(80),m=1732584193,g=-271733879,v=-1732584194,_=271733878,y=-1009589776;for(a=0;a<t.length;a+=16){for(u=m,l=g,f=v,d=_,h=y,s=0;s<80;s++)p[s]=s<16?t[a+s]:o(p[s-3]^p[s-8]^p[s-14]^p[s-16],1),c=i(i(o(m,5),e(s,g,v,_)),i(i(y,p[s]),n(s))),y=_,_=v,v=o(g,30),g=m,m=c;m=i(m,u),g=i(g,l),v=i(v,f),_=i(_,d),y=i(y,h)}return[m,g,v,_,y]}function e(t,e,n,r){return t<20?e&n|~e&r:t<40?e^n^r:t<60?e&n|e&r|n&r:e^n^r}function n(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}function r(e,n){var r=a(e);r.length>16&&(r=t(r,8*e.length));for(var i=new Array(16),o=new Array(16),s=0;s<16;s++)i[s]=909522486^r[s],o[s]=1549556828^r[s];var c=t(i.concat(a(n)),512+8*n.length);return t(o.concat(c),672)}function i(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function o(t,e){return t<<e|t>>>32-e}function a(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}function s(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>24-n%32&255);return e}function c(t){for(var e,n,r="",i=0;i<4*t.length;i+=3)for(e=(t[i>>2]>>8*(3-i%4)&255)<<16|(t[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|t[i+2>>2]>>8*(3-(i+2)%4)&255,n=0;n<4;n++)8*i+6*n>32*t.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6*(3-n)&63);return r}return{b64_hmac_sha1:function(t,e){return c(r(t,e))},b64_sha1:function(e){return c(t(a(e),8*e.length))},binb2str:s,core_hmac_sha1:r,str_hmac_sha1:function(t,e){return s(r(t,e))},str_sha1:function(e){return s(t(a(e),8*e.length))}}}),function(t,e){t.MD5=e()}(this,function(t){var e=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},n=function(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},r=function(t,n,r,i,o,a){return e((s=e(e(n,t),e(i,a)))<<(c=o)|s>>>32-c,r);var s,c},i=function(t,e,n,i,o,a,s){return r(e&n|~e&i,t,e,o,a,s)},o=function(t,e,n,i,o,a,s){return r(e&i|n&~i,t,e,o,a,s)},a=function(t,e,n,i,o,a,s){return r(e^n^i,t,e,o,a,s)},s=function(t,e,n,i,o,a,s){return r(n^(e|~i),t,e,o,a,s)},c=function(t,n){t[n>>5]|=128<<n%32,t[14+(n+64>>>9<<4)]=n;for(var r,c,u,l,f=1732584193,d=-271733879,h=-1732584194,p=271733878,m=0;m<t.length;m+=16)r=f,c=d,u=h,l=p,f=i(f,d,h,p,t[m+0],7,-680876936),p=i(p,f,d,h,t[m+1],12,-389564586),h=i(h,p,f,d,t[m+2],17,606105819),d=i(d,h,p,f,t[m+3],22,-1044525330),f=i(f,d,h,p,t[m+4],7,-176418897),p=i(p,f,d,h,t[m+5],12,1200080426),h=i(h,p,f,d,t[m+6],17,-1473231341),d=i(d,h,p,f,t[m+7],22,-45705983),f=i(f,d,h,p,t[m+8],7,1770035416),p=i(p,f,d,h,t[m+9],12,-1958414417),h=i(h,p,f,d,t[m+10],17,-42063),d=i(d,h,p,f,t[m+11],22,-1990404162),f=i(f,d,h,p,t[m+12],7,1804603682),p=i(p,f,d,h,t[m+13],12,-40341101),h=i(h,p,f,d,t[m+14],17,-1502002290),d=i(d,h,p,f,t[m+15],22,1236535329),f=o(f,d,h,p,t[m+1],5,-165796510),p=o(p,f,d,h,t[m+6],9,-1069501632),h=o(h,p,f,d,t[m+11],14,643717713),d=o(d,h,p,f,t[m+0],20,-373897302),f=o(f,d,h,p,t[m+5],5,-701558691),p=o(p,f,d,h,t[m+10],9,38016083),h=o(h,p,f,d,t[m+15],14,-660478335),d=o(d,h,p,f,t[m+4],20,-405537848),f=o(f,d,h,p,t[m+9],5,568446438),p=o(p,f,d,h,t[m+14],9,-1019803690),h=o(h,p,f,d,t[m+3],14,-187363961),d=o(d,h,p,f,t[m+8],20,1163531501),f=o(f,d,h,p,t[m+13],5,-1444681467),p=o(p,f,d,h,t[m+2],9,-51403784),h=o(h,p,f,d,t[m+7],14,1735328473),d=o(d,h,p,f,t[m+12],20,-1926607734),f=a(f,d,h,p,t[m+5],4,-378558),p=a(p,f,d,h,t[m+8],11,-2022574463),h=a(h,p,f,d,t[m+11],16,1839030562),d=a(d,h,p,f,t[m+14],23,-35309556),f=a(f,d,h,p,t[m+1],4,-1530992060),p=a(p,f,d,h,t[m+4],11,1272893353),h=a(h,p,f,d,t[m+7],16,-155497632),d=a(d,h,p,f,t[m+10],23,-1094730640),f=a(f,d,h,p,t[m+13],4,681279174),p=a(p,f,d,h,t[m+0],11,-358537222),h=a(h,p,f,d,t[m+3],16,-722521979),d=a(d,h,p,f,t[m+6],23,76029189),f=a(f,d,h,p,t[m+9],4,-640364487),p=a(p,f,d,h,t[m+12],11,-421815835),h=a(h,p,f,d,t[m+15],16,530742520),d=a(d,h,p,f,t[m+2],23,-995338651),f=s(f,d,h,p,t[m+0],6,-198630844),p=s(p,f,d,h,t[m+7],10,1126891415),h=s(h,p,f,d,t[m+14],15,-1416354905),d=s(d,h,p,f,t[m+5],21,-57434055),f=s(f,d,h,p,t[m+12],6,1700485571),p=s(p,f,d,h,t[m+3],10,-1894986606),h=s(h,p,f,d,t[m+10],15,-1051523),d=s(d,h,p,f,t[m+1],21,-2054922799),f=s(f,d,h,p,t[m+8],6,1873313359),p=s(p,f,d,h,t[m+15],10,-30611744),h=s(h,p,f,d,t[m+6],15,-1560198380),d=s(d,h,p,f,t[m+13],21,1309151649),f=s(f,d,h,p,t[m+4],6,-145523070),p=s(p,f,d,h,t[m+11],10,-1120210379),h=s(h,p,f,d,t[m+2],15,718787259),d=s(d,h,p,f,t[m+9],21,-343485551),f=e(f,r),d=e(d,c),h=e(h,u),p=e(p,l);return[f,d,h,p]};return{hexdigest:function(t){return function(t){for(var e="",n=0;n<4*t.length;n++)e+="0123456789abcdef".charAt(t[n>>2]>>n%4*8+4&15)+"0123456789abcdef".charAt(t[n>>2]>>n%4*8&15);return e}(c(n(t),8*t.length))},hash:function(t){return function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}(c(n(t),8*t.length))}}}),function(t,e){t.stropheUtils=e()}(this,function(){return{utf16to8:function(t){var e,n,r="",i=t.length;for(e=0;e<i;e++)(n=t.charCodeAt(e))>=0&&n<=127?r+=t.charAt(e):n>2047?(r+=String.fromCharCode(224|n>>12&15),r+=String.fromCharCode(128|n>>6&63),r+=String.fromCharCode(128|n>>0&63)):(r+=String.fromCharCode(192|n>>6&31),r+=String.fromCharCode(128|n>>0&63));return r},addCookies:function(t){var e,n,r,i,o,a,s;for(e in t||{})o="",a="",s="",r="object"==typeof(n=t[e]),i=escape(unescape(r?n.value:n)),r&&(o=n.expires?";expires="+n.expires:"",a=n.domain?";domain="+n.domain:"",s=n.path?";path="+n.path:""),document.cookie=e+"="+i+o+a+s}}}),function(t,e){t.polyfills=e()}(this,function(){var t={bind:function(t,e){var n=Array.prototype.slice,r=Array.prototype.concat,i=n.call(arguments,2);return function(){return t.apply(e||this,r.call(i,n.call(arguments,0)))}}};return Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=e);n<e;n++)if(n in this&&this[n]===t)return n;return-1}),t}),function(t,e){var n=e(t.SHA1,t.Base64,t.MD5,t.stropheUtils,t.polyfills);t.Strophe=n.Strophe,t.$build=n.$build,t.$iq=n.$iq,t.$msg=n.$msg,t.$pres=n.$pres}(this,function(t,e,n,r,i){var o,a=i.bind;function s(t,e){return new o.Builder(t,e)}function c(t){return new o.Builder("iq",t)}function u(t){return new o.Builder("presence",t)}return(o={bind:a,VERSION:"3.2.0",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(t){for(var e=0;e<o.XHTML.tags.length;e++)if(t==o.XHTML.tags[e])return!0;return!1},validAttribute:function(t,e){if(void 0!==o.XHTML.attributes[t]&&o.XHTML.attributes[t].length>0)for(var n=0;n<o.XHTML.attributes[t].length;n++)if(e==o.XHTML.attributes[t][n])return!0;return!1},validCSS:function(t){for(var e=0;e<o.XHTML.css.length;e++)if(t==o.XHTML.css[e])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(t,e){o.NS[t]=e},forEachChild:function(t,e,n){var r,i;for(r=0;r<t.childNodes.length;r++)(i=t.childNodes[r]).nodeType!=o.ElementType.NORMAL||e&&!this.isTagEqual(i,e)||n(i)},isTagEqual:function(t,e){return t.tagName==e},_xmlGenerator:null,_makeGenerator:function(){var t;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(t=this._getIEXmlDom()).appendChild(t.createElement("strophe")):t=document.implementation.createDocument("jabber:client","strophe",null),t},xmlGenerator:function(){return o._xmlGenerator||(o._xmlGenerator=o._makeGenerator()),o._xmlGenerator},_getIEXmlDom:function(){for(var t=null,e=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],n=0;n<e.length&&null===t;n++)try{t=new ActiveXObject(e[n])}catch(e){t=null}return t},xmlElement:function(t){if(!t)return null;var e,n,r,i=o.xmlGenerator().createElement(t);for(e=1;e<arguments.length;e++){var a=arguments[e];if(a)if("string"==typeof a||"number"==typeof a)i.appendChild(o.xmlTextNode(a));else if("object"==typeof a&&"function"==typeof a.sort)for(n=0;n<a.length;n++){var s=a[n];"object"==typeof s&&"function"==typeof s.sort&&void 0!==s[1]&&null!==s[1]&&i.setAttribute(s[0],s[1])}else if("object"==typeof a)for(r in a)a.hasOwnProperty(r)&&void 0!==a[r]&&null!==a[r]&&i.setAttribute(r,a[r])}return i},xmlescape:function(t){return t=(t=(t=(t=(t=t.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")},xmlunescape:function(t){return t=(t=(t=(t=(t=t.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')},xmlTextNode:function(t){return o.xmlGenerator().createTextNode(t)},xmlHtmlNode:function(t){var e;window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t));return e},getText:function(t){if(!t)return null;var e="";0===t.childNodes.length&&t.nodeType==o.ElementType.TEXT&&(e+=t.nodeValue);for(var n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType==o.ElementType.TEXT&&(e+=t.childNodes[n].nodeValue);return o.xmlescape(e)},copyElement:function(t){var e,n;if(t.nodeType==o.ElementType.NORMAL){for(n=o.xmlElement(t.tagName),e=0;e<t.attributes.length;e++)n.setAttribute(t.attributes[e].nodeName,t.attributes[e].value);for(e=0;e<t.childNodes.length;e++)n.appendChild(o.copyElement(t.childNodes[e]))}else t.nodeType==o.ElementType.TEXT&&(n=o.xmlGenerator().createTextNode(t.nodeValue));return n},createHtml:function(t){var e,n,r,i,a,s,c,u,l,f,d;if(t.nodeType==o.ElementType.NORMAL)if(i=t.nodeName.toLowerCase(),o.XHTML.validTag(i))try{for(n=o.xmlElement(i),e=0;e<o.XHTML.attributes[i].length;e++)if(a=o.XHTML.attributes[i][e],null!=(s=t.getAttribute(a))&&""!==s&&!1!==s&&0!==s)if("style"==a&&"object"==typeof s&&void 0!==s.cssText&&(s=s.cssText),"style"==a){for(c=[],u=s.split(";"),r=0;r<u.length;r++)f=(l=u[r].split(":"))[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase(),o.XHTML.validCSS(f)&&(d=l[1].replace(/^\s*/,"").replace(/\s*$/,""),c.push(f+": "+d));c.length>0&&(s=c.join("; "),n.setAttribute(a,s))}else n.setAttribute(a,s);for(e=0;e<t.childNodes.length;e++)n.appendChild(o.createHtml(t.childNodes[e]))}catch(t){n=o.xmlTextNode("")}else for(n=o.xmlGenerator().createDocumentFragment(),e=0;e<t.childNodes.length;e++)n.appendChild(o.createHtml(t.childNodes[e]));else if(t.nodeType==o.ElementType.FRAGMENT)for(n=o.xmlGenerator().createDocumentFragment(),e=0;e<t.childNodes.length;e++)n.appendChild(o.createHtml(t.childNodes[e]));else t.nodeType==o.ElementType.TEXT&&(n=o.xmlTextNode(t.nodeValue));return n},escapeNode:function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(t){return"string"!=typeof t?t:t.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(t){return t.indexOf("@")<0?null:t.split("@")[0]},getDomainFromJid:function(t){var e=o.getBareJidFromJid(t);if(e.indexOf("@")<0)return e;var n=e.split("@");return n.splice(0,1),n.join("@")},getResourceFromJid:function(t){var e=t.split("/");return e.length<2?null:(e.splice(0,1),e.join("/"))},getBareJidFromJid:function(t){return t?t.split("/")[0]:null},log:function(t,e){},debug:function(t){this.log(this.LogLevel.DEBUG,t)},info:function(t){this.log(this.LogLevel.INFO,t)},warn:function(t){this.log(this.LogLevel.WARN,t)},error:function(t){this.log(this.LogLevel.ERROR,t)},fatal:function(t){this.log(this.LogLevel.FATAL,t)},serialize:function(t){var e;if(!t)return null;"function"==typeof t.tree&&(t=t.tree());var n,r,i=t.nodeName;for(t.getAttribute("_realname")&&(i=t.getAttribute("_realname")),e="<"+i,n=0;n<t.attributes.length;n++)"_realname"!=t.attributes[n].nodeName&&(e+=" "+t.attributes[n].nodeName+"='"+o.xmlescape(t.attributes[n].value)+"'");if(t.childNodes.length>0){for(e+=">",n=0;n<t.childNodes.length;n++)switch((r=t.childNodes[n]).nodeType){case o.ElementType.NORMAL:e+=o.serialize(r);break;case o.ElementType.TEXT:e+=o.xmlescape(r.nodeValue);break;case o.ElementType.CDATA:e+="<![CDATA["+r.nodeValue+"]]>"}e+="</"+i+">"}else e+="/>";return e},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(t,e){o._connectionPlugins[t]=e}}).Builder=function(t,e){"presence"!=t&&"message"!=t&&"iq"!=t||(e&&!e.xmlns?e.xmlns=o.NS.CLIENT:e||(e={xmlns:o.NS.CLIENT})),this.nodeTree=o.xmlElement(t,e),this.node=this.nodeTree},o.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return o.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},attrs:function(t){for(var e in t)t.hasOwnProperty(e)&&(void 0===t[e]?this.node.removeAttribute(e):this.node.setAttribute(e,t[e]));return this},c:function(t,e,n){var r=o.xmlElement(t,e,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this},cnode:function(t){var e,n=o.xmlGenerator();try{e=void 0!==n.importNode}catch(t){e=!1}var r=e?n.importNode(t,!0):o.copyElement(t);return this.node.appendChild(r),this.node=r,this},t:function(t){var e=o.xmlTextNode(t);return this.node.appendChild(e),this},h:function(t){var e=document.createElement("body");e.innerHTML=t;for(var n=o.createHtml(e);n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},o.Handler=function(t,e,n,r,i,a,s){this.handler=t,this.ns=e,this.name=n,this.type=r,this.id=i,this.options=s||{matchBare:!1},this.options.matchBare||(this.options.matchBare=!1),this.options.matchBare?this.from=a?o.getBareJidFromJid(a):null:this.from=a,this.user=!0},o.Handler.prototype={isMatch:function(t){var e,n=null;if(n=this.options.matchBare?o.getBareJidFromJid(t.getAttribute("from")):t.getAttribute("from"),e=!1,this.ns){var r=this;o.forEachChild(t,null,function(t){t.getAttribute("xmlns")==r.ns&&(e=!0)}),e=e||t.getAttribute("xmlns")==this.ns}else e=!0;var i=t.getAttribute("type");return!(!e||this.name&&!o.isTagEqual(t,this.name)||this.type&&(Array.isArray(this.type)?-1==this.type.indexOf(i):i!=this.type)||this.id&&t.getAttribute("id")!=this.id||this.from&&n!=this.from)},run:function(t){var e=null;try{e=this.handler(t)}catch(t){throw t.sourceURL?o.fatal("error: "+this.handler+" "+t.sourceURL+":"+t.line+" - "+t.name+": "+t.message):t.fileName?("undefined"!=typeof console&&(console.trace(),console.error(this.handler," - error - ",t,t.message)),o.fatal("error: "+this.handler+" "+t.fileName+":"+t.lineNumber+" - "+t.name+": "+t.message)):o.fatal("error: "+t.message+"\n"+t.stack),t}return e},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},o.TimedHandler=function(t,e){this.period=t,this.handler=e,this.lastCalled=(new Date).getTime(),this.user=!0},o.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},o.Connection=function(t,e){this.service=t,this.options=e||{};var n=this.options.protocol||"";for(var i in 0===t.indexOf("ws:")||0===t.indexOf("wss:")||0===n.indexOf("ws")?this._proto=new o.Websocket(this):this._proto=new o.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(a(this._onIdle,this),100),r.addCookies(this.options.cookies),o._connectionPlugins)if(o._connectionPlugins.hasOwnProperty(i)){var s=o._connectionPlugins[i],c=function(){};c.prototype=s,this[i]=new c,this[i].init(this)}},o.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)});return"string"==typeof t||"number"==typeof t?e+":"+t:e+""},connect:function(t,e,n,r,i,a,s){this.jid=t,this.authzid=o.getBareJidFromJid(this.jid),this.authcid=s||o.getNodeFromJid(this.jid),this.pass=e,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=o.getDomainFromJid(this.jid),this._changeConnectStatus(o.Status.CONNECTING,null),this._proto._connect(r,i,a)},attach:function(t,e,n,r,i,a,s){if(!(this._proto instanceof o.Bosh))throw{name:"StropheSessionError",message:'The "attach" method can only be used with a BOSH connection.'};this._proto._attach(t,e,n,r,i,a,s)},restore:function(t,e,n,r,i){if(!this._sessionCachingSupported())throw{name:"StropheSessionError",message:'The "restore" method can only be used with a BOSH connection.'};this._proto._restore(t,e,n,r,i)},_sessionCachingSupported:function(){if(this._proto instanceof o.Bosh){if(!JSON)return!1;try{window.sessionStorage.setItem("_strophe_","_strophe_"),window.sessionStorage.removeItem("_strophe_")}catch(t){return!1}return!0}return!1},xmlInput:function(t){},xmlOutput:function(t){},rawInput:function(t){},rawOutput:function(t){},nextValidRid:function(t){},send:function(t){if(null!==t){if("function"==typeof t.sort)for(var e=0;e<t.length;e++)this._queueData(t[e]);else"function"==typeof t.tree?this._queueData(t.tree()):this._queueData(t);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendIQ:function(t,e,n,r){var i=null,a=this;"function"==typeof t.tree&&(t=t.tree());var s=t.getAttribute("id");s||(s=this.getUniqueId("sendIQ"),t.setAttribute("id",s));var c=t.getAttribute("to"),u=this.jid,l=this.addHandler(function(t){i&&a.deleteTimedHandler(i);var r=!1,s=t.getAttribute("from");if(s!==c&&(c||s!==o.getBareJidFromJid(u)&&s!==o.getDomainFromJid(u)&&s!==u)||(r=!0),!r)throw{name:"StropheError",message:"Got answer to IQ from wrong jid:"+s+"\nExpected jid: "+c};var l=t.getAttribute("type");if("result"==l)e&&e(t);else{if("error"!=l)throw{name:"StropheError",message:"Got bad IQ type of "+l};n&&n(t)}},null,"iq",["error","result"],s);return r&&(i=this.addTimedHandler(r,function(){return a.deleteHandler(l),n&&n(null),!1})),this.send(t),s},_queueData:function(t){if(null===t||!t.tagName||!t.childNodes)throw{name:"StropheError",message:"Cannot queue non-DOMElement."};this._data.push(t)},_sendRestart:function(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(a(this._onIdle,this),100)},addTimedHandler:function(t,e){var n=new o.TimedHandler(t,e);return this.addTimeds.push(n),n},deleteTimedHandler:function(t){this.removeTimeds.push(t)},addHandler:function(t,e,n,r,i,a,s){var c=new o.Handler(t,e,n,r,i,a,s);return this.addHandlers.push(c),c},deleteHandler:function(t){this.removeHandlers.push(t);var e=this.addHandlers.indexOf(t);e>=0&&this.addHandlers.splice(e,1)},disconnect:function(t){if(this._changeConnectStatus(o.Status.DISCONNECTING,t),o.info("Disconnect was called because: "+t),this.connected){var e=!1;this.disconnecting=!0,this.authenticated&&(e=u({xmlns:o.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,a(this._onDisconnectTimeout,this)),this._proto._disconnect(e)}else o.info("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests()},_changeConnectStatus:function(t,e){for(var n in o._connectionPlugins)if(o._connectionPlugins.hasOwnProperty(n)){var r=this[n];if(r.statusChanged)try{r.statusChanged(t,e)}catch(t){o.error(n+" plugin caused an exception changing status: "+t)}}if(this.connect_callback)try{this.connect_callback(t,e)}catch(t){o.error("User connection callback caused an exception: "+t)}},_doDisconnect:function(t){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),o.info("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(o.Status.DISCONNECTED,t),this.connected=!1},_dataRecv:function(t,e){o.info("_dataRecv called");var n=this._proto._reqToData(t);if(null!==n){var r,i;for(this.xmlInput!==o.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==o.Connection.prototype.rawInput&&(e?this.rawInput(e):this.rawInput(o.serialize(n)));this.removeHandlers.length>0;)i=this.removeHandlers.pop(),(r=this.handlers.indexOf(i))>=0&&this.handlers.splice(r,1);for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())this._doDisconnect();else{var a,s,c=n.getAttribute("type");if(null!==c&&"terminate"==c){if(this.disconnecting)return;return a=n.getAttribute("condition"),s=n.getElementsByTagName("conflict"),null!==a?("remote-stream-error"==a&&s.length>0&&(a="conflict"),this._changeConnectStatus(o.Status.CONNFAIL,a)):this._changeConnectStatus(o.Status.CONNFAIL,"unknown"),void this._doDisconnect(a)}var u=this;o.forEachChild(n,null,function(t){var e,n;for(n=u.handlers,u.handlers=[],e=0;e<n.length;e++){var r=n[e];try{!r.isMatch(t)||!u.authenticated&&r.user?u.handlers.push(r):r.run(t)&&u.handlers.push(r)}catch(t){o.warn("Removing Strophe handlers due to uncaught exception: "+t.message)}}})}}},mechanisms:{},_connect_cb:function(t,e,n){var r;o.info("_connect_cb was called"),this.connected=!0;try{r=this._proto._reqToData(t)}catch(t){if("badformat"!=t)throw t;this._changeConnectStatus(o.Status.CONNFAIL,"bad-format"),this._doDisconnect("bad-format")}if(r&&(this.xmlInput!==o.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==o.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(o.serialize(r))),this._proto._connect_cb(r)!==o.Status.CONNFAIL)){var i;this._authentication.sasl_scram_sha1=!1,this._authentication.sasl_plain=!1,this._authentication.sasl_digest_md5=!1,this._authentication.sasl_anonymous=!1,this._authentication.legacy_auth=!1,i=r.getElementsByTagNameNS?r.getElementsByTagNameNS(o.NS.STREAM,"features").length>0:r.getElementsByTagName("stream:features").length>0||r.getElementsByTagName("features").length>0;var a,s,c=r.getElementsByTagName("mechanism"),u=[];if(i){if(c.length>0)for(a=0;a<c.length;a++)s=o.getText(c[a]),this.mechanisms[s]&&u.push(this.mechanisms[s]);this._authentication.legacy_auth=r.getElementsByTagName("auth").length>0,this._authentication.legacy_auth||u.length>0?!1!==this.do_authentication&&this.authenticate(u):this._proto._no_auth_received(e)}else this._proto._no_auth_received(e)}},authenticate:function(t){var n;for(n=0;n<t.length-1;++n){for(var r=n,i=n+1;i<t.length;++i)t[i].prototype.priority>t[r].prototype.priority&&(r=i);if(r!=n){var u=t[n];t[n]=t[r],t[r]=u}}var l=!1;for(n=0;n<t.length;++n)if(t[n].prototype.test(this)){this._sasl_success_handler=this._addSysHandler(a(this._sasl_success_cb,this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(a(this._sasl_failure_cb,this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(a(this._sasl_challenge_cb,this),null,"challenge",null,null),this._sasl_mechanism=new t[n],this._sasl_mechanism.onStart(this);var f=s("auth",{xmlns:o.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var d=this._sasl_mechanism.onChallenge(this,null);f.t(e.encode(d))}this.send(f.tree()),l=!0;break}l||(null===o.getNodeFromJid(this.jid)?(this._changeConnectStatus(o.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect("x-strophe-bad-non-anon-jid")):(this._changeConnectStatus(o.Status.AUTHENTICATING,null),this._addSysHandler(a(this._auth1_cb,this),null,null,null,"_auth_1"),this.send(c({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:o.NS.AUTH}).c("username",{}).t(o.getNodeFromJid(this.jid)).tree())))},_sasl_challenge_cb:function(t){var n=e.decode(o.getText(t)),r=this._sasl_mechanism.onChallenge(this,n),i=s("response",{xmlns:o.NS.SASL});return""!==r&&i.t(e.encode(r)),this.send(i.tree()),!0},_auth1_cb:function(t){var e=c({type:"set",id:"_auth_2"}).c("query",{xmlns:o.NS.AUTH}).c("username",{}).t(o.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return o.getResourceFromJid(this.jid)||(this.jid=o.getBareJidFromJid(this.jid)+"/strophe"),e.up().c("resource",{}).t(o.getResourceFromJid(this.jid)),this._addSysHandler(a(this._auth2_cb,this),null,null,null,"_auth_2"),this.send(e.tree()),!1},_sasl_success_cb:function(t){if(this._sasl_data["server-signature"]){var n,r=e.decode(o.getText(t)).match(/([a-z]+)=([^,]+)(,|$)/);if("v"==r[1]&&(n=r[2]),n!=this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}o.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);var i=[],s=function(t,e){for(;t.length;)this.deleteHandler(t.pop());return a(this._sasl_auth1_cb,this)(e),!1};return i.push(this._addSysHandler(a(function(t){a(s,this)(i,t)},this),null,"stream:features",null,null)),i.push(this._addSysHandler(a(function(t){a(s,this)(i,t)},this),o.NS.STREAM,"features",null,null)),this._sendRestart(),!1},_sasl_auth1_cb:function(t){var e,n;for(this.features=t,e=0;e<t.childNodes.length;e++)"bind"==(n=t.childNodes[e]).nodeName&&(this.do_bind=!0),"session"==n.nodeName&&(this.do_session=!0);if(!this.do_bind)return this._changeConnectStatus(o.Status.AUTHFAIL,null),!1;this._addSysHandler(a(this._sasl_bind_cb,this),null,null,null,"_bind_auth_2");var r=o.getResourceFromJid(this.jid);return r?this.send(c({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:o.NS.BIND}).c("resource",{}).t(r).tree()):this.send(c({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:o.NS.BIND}).tree()),!1},_sasl_bind_cb:function(t){var e;if("error"==t.getAttribute("type"))return o.info("SASL binding failed."),t.getElementsByTagName("conflict").length>0&&(e="conflict"),this._changeConnectStatus(o.Status.AUTHFAIL,e),!1;var n,r=t.getElementsByTagName("bind");if(!(r.length>0))return o.info("SASL binding failed."),this._changeConnectStatus(o.Status.AUTHFAIL,null),!1;(n=r[0].getElementsByTagName("jid")).length>0&&(this.jid=o.getText(n[0]),this.do_session?(this._addSysHandler(a(this._sasl_session_cb,this),null,null,null,"_session_auth_2"),this.send(c({type:"set",id:"_session_auth_2"}).c("session",{xmlns:o.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(o.Status.CONNECTED,null)))},_sasl_session_cb:function(t){if("result"==t.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(o.Status.CONNECTED,null);else if("error"==t.getAttribute("type"))return o.info("Session creation failed."),this._changeConnectStatus(o.Status.AUTHFAIL,null),!1;return!1},_sasl_failure_cb:function(t){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(o.Status.AUTHFAIL,null),!1},_auth2_cb:function(t){return"result"==t.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(o.Status.CONNECTED,null)):"error"==t.getAttribute("type")&&(this._changeConnectStatus(o.Status.AUTHFAIL,null),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(t,e){var n=new o.TimedHandler(t,e);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(t,e,n,r,i){var a=new o.Handler(t,e,n,r,i);return a.user=!1,this.addHandlers.push(a),a},_onDisconnectTimeout:function(){return o.info("_onDisconnectTimeout was called"),this._changeConnectStatus(o.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(var t,e,n;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;)e=this.removeTimeds.pop(),(t=this.timedHandlers.indexOf(e))>=0&&this.timedHandlers.splice(t,1);var r=(new Date).getTime();for(n=[],t=0;t<this.timedHandlers.length;t++)e=this.timedHandlers[t],!this.authenticated&&e.user||(e.lastCalled+e.period-r<=0?e.run()&&n.push(e):n.push(e));this.timedHandlers=n,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(a(this._onIdle,this),100))}},o.SASLMechanism=function(t,e,n){this.name=t,this.isClientFirst=e,this.priority=n},o.SASLMechanism.prototype={test:function(t){return!0},onStart:function(t){this._connection=t},onChallenge:function(t,e){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},o.SASLAnonymous=function(){},o.SASLAnonymous.prototype=new o.SASLMechanism("ANONYMOUS",!1,10),o.SASLAnonymous.prototype.test=function(t){return null===t.authcid},o.Connection.prototype.mechanisms[o.SASLAnonymous.prototype.name]=o.SASLAnonymous,o.SASLPlain=function(){},o.SASLPlain.prototype=new o.SASLMechanism("PLAIN",!0,20),o.SASLPlain.prototype.test=function(t){return null!==t.authcid},o.SASLPlain.prototype.onChallenge=function(t){var e=t.authzid;return e+="\0",e+=t.authcid,e+="\0",e+=t.pass,r.utf16to8(e)},o.Connection.prototype.mechanisms[o.SASLPlain.prototype.name]=o.SASLPlain,o.SASLSHA1=function(){},o.SASLSHA1.prototype=new o.SASLMechanism("SCRAM-SHA-1",!0,40),o.SASLSHA1.prototype.test=function(t){return null!==t.authcid},o.SASLSHA1.prototype.onChallenge=function(i,o,s){var c=s||n.hexdigest(1234567890*Math.random()),u="n="+r.utf16to8(i.authcid);return u+=",r=",u+=c,i._sasl_data.cnonce=c,i._sasl_data["client-first-message-bare"]=u,u="n,,"+u,this.onChallenge=a(function(n,i){for(var o,a,s,c,u,l,f,d,h,p,m,g="c=biws,",v=n._sasl_data["client-first-message-bare"]+","+i+",",_=n._sasl_data.cnonce,y=/([a-z]+)=([^,]+)(,|$)/;i.match(y);){var b=i.match(y);switch(i=i.replace(b[0],""),b[1]){case"r":o=b[2];break;case"s":a=b[2];break;case"i":s=b[2]}}if(o.substr(0,_.length)!==_)return n._sasl_data={},n._sasl_failure_cb();v+=g+="r="+o,a=e.decode(a),a+="\0\0\0";var S=r.utf16to8(n.pass);for(c=l=t.core_hmac_sha1(S,a),f=1;f<s;f++){for(u=t.core_hmac_sha1(S,t.binb2str(l)),d=0;d<5;d++)c[d]^=u[d];l=u}for(c=t.binb2str(c),h=t.core_hmac_sha1(c,"Client Key"),p=t.str_hmac_sha1(c,"Server Key"),m=t.core_hmac_sha1(t.str_sha1(t.binb2str(h)),v),n._sasl_data["server-signature"]=t.b64_hmac_sha1(p,v),d=0;d<5;d++)h[d]^=m[d];return g+=",p="+e.encode(t.binb2str(h))},this),u},o.Connection.prototype.mechanisms[o.SASLSHA1.prototype.name]=o.SASLSHA1,o.SASLMD5=function(){},o.SASLMD5.prototype=new o.SASLMechanism("DIGEST-MD5",!1,30),o.SASLMD5.prototype.test=function(t){return null!==t.authcid},o.SASLMD5.prototype._quote=function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},o.SASLMD5.prototype.onChallenge=function(t,e,i){for(var o,s=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,c=i||n.hexdigest(""+1234567890*Math.random()),u="",l=null,f="";e.match(s);)switch(o=e.match(s),e=e.replace(o[0],""),o[2]=o[2].replace(/^"(.+)"$/,"$1"),o[1]){case"realm":u=o[2];break;case"nonce":f=o[2];break;case"qop":o[2];break;case"host":l=o[2]}var d=t.servtype+"/"+t.domain;null!==l&&(d=d+"/"+l);var h=r.utf16to8(t.authcid+":"+u+":"+this._connection.pass),p=n.hash(h)+":"+f+":"+c,m="AUTHENTICATE:"+d,g="";return g+="charset=utf-8,",g+="username="+this._quote(r.utf16to8(t.authcid))+",",g+="realm="+this._quote(u)+",",g+="nonce="+this._quote(f)+",",g+="nc=00000001,",g+="cnonce="+this._quote(c)+",",g+="digest-uri="+this._quote(d)+",",g+="response="+n.hexdigest(n.hexdigest(p)+":"+f+":00000001:"+c+":auth:"+n.hexdigest(m))+",",g+="qop=auth",this.onChallenge=a(function(){return""},this),g},o.Connection.prototype.mechanisms[o.SASLMD5.prototype.name]=o.SASLMD5,o.SASLOAuthBearer=function(){},o.SASLOAuthBearer.prototype=new o.SASLMechanism("OAUTHBEARER",!0,50),o.SASLOAuthBearer.prototype.test=function(t){return null!==t.authcid},o.SASLOAuthBearer.prototype.onChallenge=function(t){var e="n,a=";return e+=t.authzid,e+=",",e+="",e+="auth=Bearer ",e+=t.pass,e+="",e+="",r.utf16to8(e)},o.Connection.prototype.mechanisms[o.SASLOAuthBearer.prototype.name]=o.SASLOAuthBearer,o.SASLExternal=function(){},o.SASLExternal.prototype=new o.SASLMechanism("EXTERNAL",!0,60),o.SASLExternal.prototype.onChallenge=function(t){return t.authcid===t.authzid?"":t.authzid},o.Connection.prototype.mechanisms[o.SASLExternal.prototype.name]=o.SASLExternal,{Strophe:o,$build:s,$msg:function(t){return new o.Builder("message",t)},$iq:c,$pres:u,SHA1:t,Base64:e,MD5:n,polyfills:i}}),function(t,e){e(t.Strophe,t.$build,t.polyfills)}(this,function(t,e,n){var r=n.bind;return t.Request=function(e,n,r,i){this.id=++t._requestId,this.xmlData=e,this.data=t.serialize(e),this.origFunc=n,this.func=n,this.rid=r,this.date=NaN,this.sends=i||0,this.abort=!1,this.dead=null,this.age=function(){return this.date?(new Date-this.date)/1e3:0},this.timeDead=function(){return this.dead?(new Date-this.dead)/1e3:0},this.xhr=this._newXHR()},t.Request.prototype={getResponse:function(){var e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if("parsererror"==(e=this.xhr.responseXML.documentElement).tagName)throw t.error("invalid response received"),t.error("responseText: "+this.xhr.responseText),t.error("responseXML: "+t.serialize(this.xhr.responseXML)),"parsererror"}else if(this.xhr.responseText)throw t.error("invalid response received"),t.error("responseText: "+this.xhr.responseText),"badformat";return e},_newXHR:function(){var t=null;return window.XMLHttpRequest?(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType("text/xml; charset=utf-8"):window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t.onreadystatechange=r(this.func,null,this),t}},t.Bosh=function(t){this._conn=t,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this._requests=[]},t.Bosh.prototype={strip:null,_buildBody:function(){var n=e("body",{rid:this.rid++,xmlns:t.NS.HTTPBIND});return null!==this.sid&&n.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),n},_reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_connect:function(e,n,i){this.wait=e||this.wait,this.hold=n||this.hold,this.errors=0;var o=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":t.NS.BOSH});i&&o.attrs({route:i});var a=this._conn._connect_cb;this._requests.push(new t.Request(o.tree(),r(this._onRequestStateChange,this,r(a,this._conn)),o.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(e,n,r,i,o,a,s){this._conn.jid=e,this.sid=n,this.rid=r,this._conn.connect_callback=i,this._conn.domain=t.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=o||this.wait,this.hold=a||this.hold,this.window=s||this.window,this._conn._changeConnectStatus(t.Status.ATTACHED,null)},_restore:function(e,n,r,i,o){var a=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=a&&a.rid&&a.sid&&a.jid)||null!=e&&t.getBareJidFromJid(a.jid)!=t.getBareJidFromJid(e))throw{name:"StropheSessionError",message:"_restore: no restoreable session."};this._conn.restored=!0,this._attach(a.jid,a.sid,a.rid,n,r,i,o)},_cacheSession:function(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")},_connect_cb:function(e){var n,r,i=e.getAttribute("type");if(null!==i&&"terminate"==i)return n=e.getAttribute("condition"),t.error("BOSH-Connection failed: "+n),r=e.getElementsByTagName("conflict"),null!==n?("remote-stream-error"==n&&r.length>0&&(n="conflict"),this._conn._changeConnectStatus(t.Status.CONNFAIL,n)):this._conn._changeConnectStatus(t.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(n),t.Status.CONNFAIL;this.sid||(this.sid=e.getAttribute("sid"));var o=e.getAttribute("requests");o&&(this.window=parseInt(o,10));var a=e.getAttribute("hold");a&&(this.hold=parseInt(a,10));var s=e.getAttribute("wait");s&&(this.wait=parseInt(s,10))},_disconnect:function(t){this._sendTerminate(t)},_doDisconnect:function(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_emptyQueue:function(){return 0===this._requests.length},_hitError:function(e){this.errors++,t.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()},_no_auth_received:function(e){e=r(e||this._conn._connect_cb,this._conn);var n=this._buildBody();this._requests.push(new t.Request(n.tree(),r(this._onRequestStateChange,this,r(e,this._conn)),n.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){this._abortAllRequests()},_abortAllRequests:function(){for(var t;this._requests.length>0;)(t=this._requests.pop()).abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){}},_onIdle:function(){var e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(t.info("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){for(var n=this._buildBody(),i=0;i<e.length;i++)null!==e[i]&&("restart"===e[i]?n.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":t.NS.BOSH}):n.cnode(e[i]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new t.Request(n.tree(),r(this._onRequestStateChange,this,r(this._conn._dataRecv,this._conn)),n.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){var o=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(t.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),o>Math.floor(t.TIMEOUT*this.wait)&&(t.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(t.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}},_onRequestStateChange:function(e,n){var r;if(t.debug("request id "+n.id+"."+n.sends+" state changed to "+n.xhr.readyState),n.abort)n.abort=!1;else if(4==n.xhr.readyState){r=0;try{r=n.xhr.status}catch(t){}if(void 0===r&&(r=0),this.disconnecting&&r>=400)return void this._hitError(r);var i=this._requests[0]==n,o=this._requests[1]==n;(r>0&&r<500||n.sends>5)&&(this._removeRequest(n),t.debug("request id "+n.id+" should now be removed")),200==r?((o||i&&this._requests.length>0&&this._requests[0].age()>Math.floor(t.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(n.rid)+1),t.debug("request id "+n.id+"."+n.sends+" got 200"),e(n),this.errors=0):(t.error("request id "+n.id+"."+n.sends+" error "+r+" happened"),(0===r||r>=400&&r<600||r>=12e3)&&(this._hitError(r),r>=400&&r<500&&(this._conn._changeConnectStatus(t.Status.DISCONNECTING,null),this._conn._doDisconnect()))),r>0&&r<500||n.sends>5||this._throttledRequestHandler()}},_processRequest:function(e){var n=this,r=this._requests[e],i=-1;try{4==r.xhr.readyState&&(i=r.xhr.status)}catch(n){t.error("caught an error in _requests["+e+"], reqStatus: "+i)}if(void 0===i&&(i=-1),r.sends>this._conn.maxRetries)this._conn._onDisconnectTimeout();else{var o=r.age(),a=!isNaN(o)&&o>Math.floor(t.TIMEOUT*this.wait),s=null!==r.dead&&r.timeDead()>Math.floor(t.SECONDARY_TIMEOUT*this.wait),c=4==r.xhr.readyState&&(i<1||i>=500);if((a||s||c)&&(s&&t.error("Request "+this._requests[e].id+" timed out (secondary), restarting"),r.abort=!0,r.xhr.abort(),r.xhr.onreadystatechange=function(){},this._requests[e]=new t.Request(r.xmlData,r.origFunc,r.rid,r.sends),r=this._requests[e]),0===r.xhr.readyState){t.debug("request id "+r.id+"."+r.sends+" posting");try{var u=this._conn.options.contentType||"text/xml; charset=utf-8";r.xhr.open("POST",this._conn.service,!this._conn.options.sync),r.xhr.setRequestHeader("Content-Type",u),this._conn.options.withCredentials&&(r.xhr.withCredentials=!0)}catch(e){return t.error("XHR open failed."),this._conn.connected||this._conn._changeConnectStatus(t.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}var l=function(){if(r.date=new Date,n._conn.options.customHeaders){var t=n._conn.options.customHeaders;for(var e in t)t.hasOwnProperty(e)&&r.xhr.setRequestHeader(e,t[e])}r.xhr.send(r.data)};if(r.sends>1){var f=1e3*Math.min(Math.floor(t.TIMEOUT*this.wait),Math.pow(r.sends,3));setTimeout(function(){l()},f)}else l();r.sends++,this._conn.xmlOutput!==t.Connection.prototype.xmlOutput&&(r.xmlData.nodeName===this.strip&&r.xmlData.childNodes.length?this._conn.xmlOutput(r.xmlData.childNodes[0]):this._conn.xmlOutput(r.xmlData)),this._conn.rawOutput!==t.Connection.prototype.rawOutput&&this._conn.rawOutput(r.data)}else t.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+r.xhr.readyState)}},_removeRequest:function(e){var n;for(t.debug("removing request"),n=this._requests.length-1;n>=0;n--)e==this._requests[n]&&this._requests.splice(n,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(t){var e=this._requests[t];null===e.dead&&(e.dead=new Date),this._processRequest(t)},_reqToData:function(t){try{return t.getResponse()}catch(t){if("parsererror"!=t)throw t;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){t.info("_sendTerminate was called");var n=this._buildBody().attrs({type:"terminate"});e&&n.cnode(e.tree());var i=new t.Request(n.tree(),r(this._onRequestStateChange,this,r(this._conn._dataRecv,this._conn)),n.tree().getAttribute("rid"));this._requests.push(i),this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(r(this._conn._onIdle,this._conn),100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?t.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):t.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}},t}),function(t,e){e(t.Strophe,t.$build,t.polyfills)}(this,function(t,e,n){var r=n.bind;return t.Websocket=function(t){this._conn=t,this.strip="wrapper";var e=t.service;if(0!==e.indexOf("ws:")&&0!==e.indexOf("wss:")){var n="";"ws"===t.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==e.indexOf("/")?n+=window.location.pathname+e:n+=e,t.service=n}},t.Websocket.prototype={_buildStream:function(){return e("open",{xmlns:t.NS.FRAMING,to:this._conn.domain,version:"1.0"})},_check_streamerror:function(e,n){var r;if(0===(r=e.getElementsByTagNameNS?e.getElementsByTagNameNS(t.NS.STREAM,"error"):e.getElementsByTagName("stream:error")).length)return!1;for(var i=r[0],o="",a="",s=0;s<i.childNodes.length;s++){var c=i.childNodes[s];if("urn:ietf:params:xml:ns:xmpp-streams"!==c.getAttribute("xmlns"))break;"text"===c.nodeName?a=c.textContent:o=c.nodeName}var u="WebSocket stream error: ";return u+=o||"unknown",a&&(u+=" - "+o),t.error(u),this._conn._changeConnectStatus(n,o),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=r(this._onOpen,this),this.socket.onerror=r(this._onError,this),this.socket.onclose=r(this._onClose,this),this.socket.onmessage=r(this._connect_cb_wrapper,this)},_connect_cb:function(e){if(this._check_streamerror(e,t.Status.CONNFAIL))return t.Status.CONNFAIL},_handleStreamStart:function(e){var n=!1,r=e.getAttribute("xmlns");"string"!=typeof r?n="Missing xmlns in <open />":r!==t.NS.FRAMING&&(n="Wrong xmlns in <open />: "+r);var i=e.getAttribute("version");return"string"!=typeof i?n="Missing version in <open />":"1.0"!==i&&(n="Wrong version in <open />: "+i),!n||(this._conn._changeConnectStatus(t.Status.CONNFAIL,n),this._conn._doDisconnect(),!1)},_connect_cb_wrapper:function(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){var n=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===n)return;var i=(new DOMParser).parseFromString(n,"text/xml").documentElement;this._conn.xmlInput(i),this._conn.rawInput(e.data),this._handleStreamStart(i)&&this._connect_cb(i)}else if(0===e.data.indexOf("<close ")){this._conn.rawInput(e.data),this._conn.xmlInput(e);var o=e.getAttribute("see-other-uri");o?(this._conn._changeConnectStatus(t.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=o,this._connect()):(this._conn._changeConnectStatus(t.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect())}else{var a=this._streamWrap(e.data),s=(new DOMParser).parseFromString(a,"text/xml").documentElement;this.socket.onmessage=r(this._onMessage,this),this._conn._connect_cb(s,null,e.data)}},_disconnect:function(n){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){n&&this._conn.send(n);var r=e("close",{xmlns:t.NS.FRAMING});this._conn.xmlOutput(r);var i=t.serialize(r);this._conn.rawOutput(i);try{this.socket.send(i)}catch(e){t.info("Couldn't send <close /> tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){t.info("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(t){return"<wrapper>"+t+"</wrapper>"},_closeSocket:function(){if(this.socket)try{this.socket.close()}catch(t){}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(){this._conn.connected&&!this._conn.disconnecting?(t.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):t.info("Websocket closed")},_no_auth_received:function(e){t.error("Server did not send any auth methods"),this._conn._changeConnectStatus(t.Status.CONNFAIL,"Server did not send any auth methods"),e&&(e=r(e,this._conn))(),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_abortAllRequests:function(){},_onError:function(e){t.error("Websocket error "+e),this._conn._changeConnectStatus(t.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()},_onIdle:function(){var e=this._conn._data;if(e.length>0&&!this._conn.paused){for(var n=0;n<e.length;n++){var r,i;if(null!==e[n])r="restart"===e[n]?this._buildStream().tree():e[n],i=t.serialize(r),this._conn.xmlOutput(r),this._conn.rawOutput(i),this.socket.send(i)}this._conn._data=[]}},_onMessage:function(e){var n,r,i='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===i)return this._conn.rawInput(i),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(n=(new DOMParser).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(n))return}else r=this._streamWrap(e.data),n=(new DOMParser).parseFromString(r,"text/xml").documentElement;return this._check_streamerror(n,t.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===n.firstChild.nodeName&&"unavailable"===n.firstChild.getAttribute("type")?(this._conn.xmlInput(n),void this._conn.rawInput(t.serialize(n))):void this._conn._dataRecv(n,e.data)},_onOpen:function(){t.info("Websocket open");var e=this._buildStream();this._conn.xmlOutput(e.tree());var n=t.serialize(e);this._conn.rawOutput(n),this.socket.send(n)},_reqToData:function(t){return t},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),r(this._conn._onIdle,this._conn)()}},t})},function(t,e){var n,r,i={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(t){return this._connection=t,this._muc_handler=null,Strophe.addNamespace("MUC_OWNER",Strophe.NS.MUC+"#owner"),Strophe.addNamespace("MUC_ADMIN",Strophe.NS.MUC+"#admin"),Strophe.addNamespace("MUC_USER",Strophe.NS.MUC+"#user"),Strophe.addNamespace("MUC_ROOMCONF",Strophe.NS.MUC+"#roomconfig"),Strophe.addNamespace("MUC_REGISTER","jabber:iq:register")},join:function(t,e,n,i,o,a,s,c){var u,l,f;return l=this.test_append_nick(t,e),u=$pres({from:this._connection.jid,to:l}).c("x",{xmlns:Strophe.NS.MUC}),null!=s&&(u=u.c("history",s).up()),null!=a&&u.cnode(Strophe.xmlElement("password",[],a)),null!=c&&u.up().cnode(c),null==this._muc_handler&&(this._muc_handler=this._connection.addHandler((f=this,function(e){var n,r,i,o,a,s,c,u;if(!(n=e.getAttribute("from")))return!0;if(s=n.split("/")[0],!f.rooms[s])return!0;if(t=f.rooms[s],r={},"message"===e.nodeName)r=t._message_handlers;else if("presence"===e.nodeName&&(u=e.getElementsByTagName("x")).length>0)for(i=0,a=u.length;i<a;i++)if((c=u[i].getAttribute("xmlns"))&&c.match(Strophe.NS.MUC)){r=t._presence_handlers;break}for(o in r)(0,r[o])(e,t)||delete r[o];return!0}))),this.rooms.hasOwnProperty(t)||(this.rooms[t]=new r(this,t,e,a),i&&this.rooms[t].addHandler("presence",i),n&&this.rooms[t].addHandler("message",n),o&&this.rooms[t].addHandler("roster",o),this.roomNames.push(t)),this._connection.send(u)},leave:function(t,e,n,r){var i,o,a,s;return i=this.roomNames.indexOf(t),delete this.rooms[t],i>=0&&(this.roomNames.splice(i,1),0===this.roomNames.length&&(this._connection.deleteHandler(this._muc_handler),this._muc_handler=null)),s=this.test_append_nick(t,e),a=this._connection.getUniqueId(),o=$pres({type:"unavailable",id:a,from:this._connection.jid,to:s}),null!=r&&o.c("status",r),null!=n&&this._connection.addHandler(n,null,"presence",null,a),this._connection.send(o),a},message:function(t,e,n,r,i,o){var a,s,c;return c=this.test_append_nick(t,e),i=i||(null!=e?"chat":"groupchat"),o=o||this._connection.getUniqueId(),(a=$msg({to:c,from:this._connection.jid,type:i,id:o}).c("body").t(n)).up(),null!=r&&(a.c("html",{xmlns:Strophe.NS.XHTML_IM}).c("body",{xmlns:Strophe.NS.XHTML}).h(r),0===a.node.childNodes.length?(s=a.node.parentNode,a.up().up(),a.node.removeChild(s)):a.up().up()),a.c("x",{xmlns:"jabber:x:event"}).c("composing"),this._connection.send(a),o},groupchat:function(t,e,n,r){return this.message(t,null,e,n,void 0,r)},invite:function(t,e,n){var r,i;return i=this._connection.getUniqueId(),r=$msg({from:this._connection.jid,to:t,id:i}).c("x",{xmlns:Strophe.NS.MUC_USER}).c("invite",{to:e}),null!=n&&r.c("reason",n),this._connection.send(r),i},multipleInvites:function(t,e,n){var r,i,o,a,s;for(a=this._connection.getUniqueId(),i=$msg({from:this._connection.jid,to:t,id:a}).c("x",{xmlns:Strophe.NS.MUC_USER}),r=0,o=e.length;r<o;r++)s=e[r],i.c("invite",{to:s}),null!=n&&(i.c("reason",n),i.up()),i.up();return this._connection.send(i),a},directInvite:function(t,e,n,r){var i,o,a;return a=this._connection.getUniqueId(),i={xmlns:"jabber:x:conference",jid:t},null!=n&&(i.reason=n),null!=r&&(i.password=r),o=$msg({from:this._connection.jid,to:e,id:a}).c("x",i),this._connection.send(o),a},queryOccupants:function(t,e,n){var r,i;return r={xmlns:Strophe.NS.DISCO_ITEMS},i=$iq({from:this._connection.jid,to:t,type:"get"}).c("query",r),this._connection.sendIQ(i,e,n)},configure:function(t,e,n){var r;return r=$iq({to:t,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).tree(),this._connection.sendIQ(r,e,n)},cancelConfigure:function(t){var e;return e=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"}).tree(),this._connection.sendIQ(e)},saveConfiguration:function(t,e,n,r){var i,o,a,s,c;if(a=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}),void 0!==Strophe.x&&void 0!==Strophe.x.Form&&e instanceof Strophe.x.Form)e.type="submit",a.cnode(e.toXML());else for(a.c("x",{xmlns:"jabber:x:data",type:"submit"}),o=0,s=e.length;o<s;o++)i=e[o],a.cnode(i).up();return c=a.tree(),this._connection.sendIQ(c,n,r)},createInstantRoom:function(t,e,n){var r;return r=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"}),this._connection.sendIQ(r.tree(),e,n)},createConfiguredRoom:function(t,e,n,r){var o,a,s;for(o in(a=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"})).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),e)i.call(e,o)&&(s=e[o],a.c("field",{var:o}).c("value").t(s).up().up());return this._connection.sendIQ(a.tree(),n,r)},setTopic:function(t,e){var n;return n=$msg({to:t,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e),this._connection.send(n.tree())},_modifyPrivilege:function(t,e,n,r,i){var o;return o=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_ADMIN}).cnode(e.node),null!=n&&o.c("reason",n),this._connection.sendIQ(o.tree(),r,i)},modifyRole:function(t,e,n,r,i,o){var a;return a=$build("item",{nick:e,role:n}),this._modifyPrivilege(t,a,r,i,o)},kick:function(t,e,n,r,i){return this.modifyRole(t,e,"none",n,r,i)},voice:function(t,e,n,r,i){return this.modifyRole(t,e,"participant",n,r,i)},mute:function(t,e,n,r,i){return this.modifyRole(t,e,"visitor",n,r,i)},op:function(t,e,n,r,i){return this.modifyRole(t,e,"moderator",n,r,i)},deop:function(t,e,n,r,i){return this.modifyRole(t,e,"participant",n,r,i)},modifyAffiliation:function(t,e,n,r,i,o){var a;return a=$build("item",{jid:e,affiliation:n}),this._modifyPrivilege(t,a,r,i,o)},ban:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"outcast",n,r,i)},member:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"member",n,r,i)},revoke:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"none",n,r,i)},owner:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"owner",n,r,i)},admin:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"admin",n,r,i)},changeNick:function(t,e){var n,r;return r=this.test_append_nick(t,e),n=$pres({from:this._connection.jid,to:r,id:this._connection.getUniqueId()}),this._connection.send(n.tree())},setStatus:function(t,e,n,r){var i,o;return o=this.test_append_nick(t,e),i=$pres({from:this._connection.jid,to:o}),null!=n&&i.c("show",n).up(),null!=r&&i.c("status",r),this._connection.send(i.tree())},registrationRequest:function(t,e,n){var r;return r=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER}),this._connection.sendIQ(r,function(t){var n,r,i,o,a,s;for((r=t.getElementsByTagName("field")).length,o={required:[],optional:[]},a=0,s=r.length;a<s;a++)i={var:(n=r[a]).getAttribute("var"),label:n.getAttribute("label"),type:n.getAttribute("type")},n.getElementsByTagName("required").length>0?o.required.push(i):o.optional.push(i);return e(o)},n)},submitRegistrationForm:function(t,e,n,r){var i,o,a;for(o in(i=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER})).c("x",{xmlns:"jabber:x:data",type:"submit"}),i.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up(),e)a=e[o],i.c("field",{var:o}).c("value").t(a).up().up();return this._connection.sendIQ(i,n,r)},listRooms:function(t,e,n){var r;return r=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.DISCO_ITEMS}),this._connection.sendIQ(r,e,n)},test_append_nick:function(t,e){return Strophe.escapeNode(Strophe.getNodeFromJid(t))+"@"+Strophe.getDomainFromJid(t)+(null!=e?"/"+e:"")}}),r=function(){function t(t,e,n,r){this.client=t,this.name=e,this.nick=n,this.password=r,this._roomRosterHandler=o(this._roomRosterHandler,this),this._addOccupant=o(this._addOccupant,this),this.roster={},this._message_handlers={},this._presence_handlers={},this._roster_handlers={},this._handler_ids=0,this.client.muc&&(this.client=this.client.muc),this.name=Strophe.getBareJidFromJid(this.name),this.addHandler("presence",this._roomRosterHandler)}return t.prototype.join=function(t,e,n){return this.client.join(this.name,this.nick,t,e,n,this.password)},t.prototype.leave=function(t,e){return this.client.leave(this.name,this.nick,t,e),delete this.client.rooms[this.name]},t.prototype.message=function(t,e,n,r){return this.client.message(this.name,t,e,n,r)},t.prototype.groupchat=function(t,e){return this.client.groupchat(this.name,t,e)},t.prototype.invite=function(t,e){return this.client.invite(this.name,t,e)},t.prototype.multipleInvites=function(t,e){return this.client.invite(this.name,t,e)},t.prototype.directInvite=function(t,e){return this.client.directInvite(this.name,t,e,this.password)},t.prototype.configure=function(t){return this.client.configure(this.name,t)},t.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)},t.prototype.saveConfiguration=function(t){return this.client.saveConfiguration(this.name,t)},t.prototype.queryOccupants=function(t,e){return this.client.queryOccupants(this.name,t,e)},t.prototype.setTopic=function(t){return this.client.setTopic(this.name,t)},t.prototype.modifyRole=function(t,e,n,r,i){return this.client.modifyRole(this.name,t,e,n,r,i)},t.prototype.kick=function(t,e,n,r){return this.client.kick(this.name,t,e,n,r)},t.prototype.voice=function(t,e,n,r){return this.client.voice(this.name,t,e,n,r)},t.prototype.mute=function(t,e,n,r){return this.client.mute(this.name,t,e,n,r)},t.prototype.op=function(t,e,n,r){return this.client.op(this.name,t,e,n,r)},t.prototype.deop=function(t,e,n,r){return this.client.deop(this.name,t,e,n,r)},t.prototype.modifyAffiliation=function(t,e,n,r,i){return this.client.modifyAffiliation(this.name,t,e,n,r,i)},t.prototype.ban=function(t,e,n,r){return this.client.ban(this.name,t,e,n,r)},t.prototype.member=function(t,e,n,r){return this.client.member(this.name,t,e,n,r)},t.prototype.revoke=function(t,e,n,r){return this.client.revoke(this.name,t,e,n,r)},t.prototype.owner=function(t,e,n,r){return this.client.owner(this.name,t,e,n,r)},t.prototype.admin=function(t,e,n,r){return this.client.admin(this.name,t,e,n,r)},t.prototype.changeNick=function(t){return this.nick=t,this.client.changeNick(this.name,nick)},t.prototype.setStatus=function(t,e){return this.client.setStatus(this.name,this.nick,t,e)},t.prototype.addHandler=function(t,e){var n;switch(n=this._handler_ids++,t){case"presence":this._presence_handlers[n]=e;break;case"message":this._message_handlers[n]=e;break;case"roster":this._roster_handlers[n]=e;break;default:return this._handler_ids--,null}return n},t.prototype.removeHandler=function(t){return delete this._presence_handlers[t],delete this._message_handlers[t],delete this._roster_handlers[t]},t.prototype._addOccupant=function(t){var e;return e=new n(t,this),this.roster[e.nick]=e,e},t.prototype._roomRosterHandler=function(e){var n,r,i,o,a;switch(o=(n=t._parsePresence(e)).nick,i=n.newnick||null,n.type){case"error":return!0;case"unavailable":i&&(n.nick=i,this.roster[o]&&this.roster[i]&&(this.roster[o].update(this.roster[i]),this.roster[i]=this.roster[o]),this.roster[o]&&!this.roster[i]&&(this.roster[i]=this.roster[o].update(n))),delete this.roster[o];break;default:this.roster[o]?this.roster[o].update(n):this._addOccupant(n)}for(r in a=this._roster_handlers)(0,a[r])(this.roster,this)||delete this._roster_handlers[r];return!0},t._parsePresence=function(t){var e,n,r,i,o,a,s,c,u;for((r={}).nick=Strophe.getResourceFromJid(t.getAttribute("from")),r.type=t.getAttribute("type"),r.states=[],i=0,a=(c=t.childNodes).length;i<a;i++)switch((e=c[i]).nodeName){case"status":r.status=e.textContent||null;break;case"show":r.show=e.textContent||null;break;case"x":if(e.getAttribute("xmlns")===Strophe.NS.MUC_USER)for(o=0,s=(u=e.childNodes).length;o<s;o++)switch((n=u[o]).nodeName){case"item":r.affiliation=n.getAttribute("affiliation"),r.role=n.getAttribute("role"),r.jid=n.getAttribute("jid"),r.newnick=n.getAttribute("nick");break;case"status":n.getAttribute("code")&&r.states.push(n.getAttribute("code"))}}return r},t}(),function(){function t(t){this.parse=o(this.parse,this),null!=t&&this.parse(t)}t.prototype.parse=function(t){var e,n,r,i,o,a,s,c,u,l,f,d,h;for(d=t.getElementsByTagName("query")[0].childNodes,this.identities=[],this.features=[],this.x=[],o=0,u=d.length;o<u;o++)switch(n=(r=d[o]).attributes,r.nodeName){case"identity":for(a={},s=0,l=n.length;s<l;s++)a[(e=n[s]).name]=e.textContent;this.identities.push(a);break;case"feature":this.features.push(r.getAttribute("var"));break;case"x":if("FORM_TYPE"===!r.childNodes[0].getAttribute("var")||"hidden"===!r.childNodes[0].getAttribute("type"))break;for(c=0,f=(h=r.childNodes).length;c<f;c++)(i=h[c]).attributes.type||this.x.push({var:i.getAttribute("var"),label:i.getAttribute("label")||"",value:i.firstChild.textContent||""})}return{identities:this.identities,features:this.features,x:this.x}}}(),n=function(){function t(t,e){this.room=e,this.update=o(this.update,this),this.admin=o(this.admin,this),this.owner=o(this.owner,this),this.revoke=o(this.revoke,this),this.member=o(this.member,this),this.ban=o(this.ban,this),this.modifyAffiliation=o(this.modifyAffiliation,this),this.deop=o(this.deop,this),this.op=o(this.op,this),this.mute=o(this.mute,this),this.voice=o(this.voice,this),this.kick=o(this.kick,this),this.modifyRole=o(this.modifyRole,this),this.update(t)}return t.prototype.modifyRole=function(t,e,n,r){return this.room.modifyRole(this.nick,t,e,n,r)},t.prototype.kick=function(t,e,n){return this.room.kick(this.nick,t,e,n)},t.prototype.voice=function(t,e,n){return this.room.voice(this.nick,t,e,n)},t.prototype.mute=function(t,e,n){return this.room.mute(this.nick,t,e,n)},t.prototype.op=function(t,e,n){return this.room.op(this.nick,t,e,n)},t.prototype.deop=function(t,e,n){return this.room.deop(this.nick,t,e,n)},t.prototype.modifyAffiliation=function(t,e,n,r){return this.room.modifyAffiliation(this.jid,t,e,n,r)},t.prototype.ban=function(t,e,n){return this.room.ban(this.jid,t,e,n)},t.prototype.member=function(t,e,n){return this.room.member(this.jid,t,e,n)},t.prototype.revoke=function(t,e,n){return this.room.revoke(this.jid,t,e,n)},t.prototype.owner=function(t,e,n){return this.room.owner(this.jid,t,e,n)},t.prototype.admin=function(t,e,n){return this.room.admin(this.jid,t,e,n)},t.prototype.update=function(t){return this.nick=t.nick||null,this.affiliation=t.affiliation||null,this.role=t.role||null,this.jid=t.jid||null,this.status=t.status||null,this.show=t.show||null,this},t}()},function(t,e){Strophe.addConnectionPlugin("receipts",{_conn:null,_msgQueue:{},_retries:{},_resendCount:10,_resendTime:9e3,_requestCallbacks:{},init:function(t){this._conn=t,Strophe.addNamespace("RECEIPTS","urn:xmpp:receipts")},statusChanged:function(t){if(t===Strophe.Status.CONNECTED||t===Strophe.Status.ATTACHED){var e=this;setTimeout(function(){e.resendQueue()},4e3)}},sendMessage:function(t,e,n){var r=t.tree().getAttribute("id");r||(r=+new Date,t.tree().setAttribute("id",r));var i=Strophe.xmlElement("request",{xmlns:Strophe.NS.RECEIPTS});return t.tree().appendChild(i),this._msgQueue[r]=t,this._retries[r]=0,(e||n)&&(this._requestCallbacks[r]=[e,n]),this._conn.send(t),n||this.resendMessage(r),r},resendMessage:function(t){var e=this;setTimeout(function(){if(e._msgQueue[t]){if(!e._conn.connected)return void e.resendMessage(t);if(e._retries[t]++,e._retries[t]>e._resendCount)return;e._msgQueue[t].tree().setAttribute("from",e._conn.jid),e._conn.send(e._msgQueue[t]),e.resendMessage(t)}},this._resendTime)},addReceiptHandler:function(t,e,n,r){var i=this;this._conn.addHandler(function(e){var n=t(e);return i._processReceipt(e,n),n},Strophe.NS.RECEIPTS,"message",e,null,n,r)},_processReceipt:function(t,e){var n=t.getAttribute("id"),r=t.getAttribute("from"),i=t.getElementsByTagName("request"),o=t.getElementsByTagName("received"),a="error"===t.getAttribute("type"),s=this;if(i.length>0&&!a&&(e&&"object"==typeof e&&"done"in e?e.done(function(){s.sendReceipt(r,n)}):this.sendReceipt(r,n)),o.length>0){var c=o[0].getAttribute("id");if(c&&(delete this._msgQueue[c],delete this._retries[c],c in this._requestCallbacks)){var u=this._requestCallbacks[c][a?1:0];u&&u.apply(null),delete this._requestCallbacks[c]}}},sendReceipt:function(t,e){var n=$msg({to:t,from:this._conn.jid,id:this._conn.getUniqueId()}),r=Strophe.xmlElement("received",{xmlns:Strophe.NS.RECEIPTS,id:e});n.tree().appendChild(r),this._conn.send(n)},resendQueue:function(){if(this._conn.connected)for(var t in this._msgQueue)this._msgQueue.hasOwnProperty(t)&&(this._msgQueue[t].tree().setAttribute("from",this._conn.jid),this._conn.send(this._msgQueue[t]));else{var e=this;setTimeout(function(){e.resendQueue()},4e3)}},getUnreceivedMsgs:function(){var t=[];for(var e in this._msgQueue)this._msgQueue.hasOwnProperty(e)&&t.push(this._msgQueue[e]);return t},clearMessages:function(){this._msgQueue={}}})},function(t,e){t.exports=function(t){t.addConnectionPlugin("fileupload",{connection:null,init:function(t){this.connection=t},requestSlot:function(e,n,r,i){var o=$iq({id:this.connection.getUniqueId(),from:this.connection.jid,to:"upload."+t.getDomainFromJid(this.connection.jid),type:"get"}).c("request",{xmlns:"urn:xmpp:http:upload"}).c("filename",{},e.name).c("size",{},e.size).c("content-type",{},e.contentType);this.connection.sendIQ(o,n,r,i)}})}},function(t,e){t.exports=function(t){t.addConnectionPlugin("outofband",{_conn:null,init:function(e){this._conn=e,t.addNamespace("OUTOFBAND","jabber:iq:oob")},sendIq:function(e,n){var r=null;return $(e).filter("iq").each(function(){var e=$(this).find("url:first").text(),i=$(this).find("desc:first").text();switch(n){case null:r=$iq({to:$(this).attr("from"),from:$(this).attr("to"),type:"result",id:$(this).attr("id")});break;case"404":r=$iq({to:$(this).attr("from"),from:$(this).attr("to"),type:"error",id:$(this).attr("id")}).c("query",{xmlns:t.NS.OUTOFBAND}).c("url",{},e).c("desc",{},i).up().c("error",{code:"404",type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"});break;case"406":r=$iq({to:$(this).attr("from"),from:$(this).attr("to"),type:"error",id:$(this).attr("id")}).c("query",{xmlns:t.NS.OUTOFBAND}).c("url",{},e).c("desc",{},i).up().c("error",{code:"406",type:"modify"}).c("not-acceptable",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"});break;default:console.log("Unhandled errorcode: a response has not been sent")}}),r&&(console.log(r.toString()),this._conn.send(r)),r},sendUrl:function(e,n,r){var i=$iq({id:this._conn.getUniqueId(),type:"set",from:this._conn.jid,to:e}).c("query",{xmlns:t.NS.OUTOFBAND}).c("url",{},n).c("desc",{},r);this._conn.send(i)},addOutOfBandHandler:function(e,n,r,i){this._conn.addHandler(e,t.NS.OUTOFBAND,"iq",n,null,r,i)}})}},function(t,e,n){"use strict";var r=n(6);t.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="",this.barejid="",this.resources=[],r.assign(this,e)}},function(t,e,n){var r=n(570),i=iAdvize.$;function o(t){r.call(this,t);var e=this,n=i(t),o=n.find("error");this.text=o.length?o.find("text").text():[],this.fromUsername=(n.attr("from")||"").split("@")[0],this.code=parseInt(o.attr("code"),10),this.retry=0,i.each(n.find("x"),function(t,n){"https://iadvize.com/schemas/retry"===n.getAttribute("xmlns")&&(e.retry=parseInt(n.getAttribute("retry"),10))})}o.prototype=r.prototype,o.constructor=o,o.prototype.canRetry=function(){return this.retry<3},t.exports=o},function(t,e,n){"use strict";t.exports=function(t){var e=[];return{get:function(){var n=t.Deferred();return e.push(n),n.promise()},reject:function(t){e.map(function(e){e.reject(t)}),e=[]},resolve:function(){var t=arguments;e.map(function(e){e.resolve.apply(e,t)}),e=[]}}}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t,e,n,i,o,a,s,c,u,l){var f=o.$,d=0,h=0,p=!1,g=!1,v=function(){return r.isObject(window.WebSocket)&&o.ws_enabled},_=function(){return v()&&!p?o.ws_url:o.bosh_url},y=new t.Connection(_());window.traceXMPP&&window.localStorage&&window.localStorage.getItem("traceXMPP")&&(y.xmlInput=function(t){window.traceXMPP(t,!0)},y.xmlOutput=function(t){window.traceXMPP(t,!1)});var b=!1,S=null,T=null,E={},C={jid:null,nick:null},w=function(r){if(y.connected||b)return S.promise();S=S&&"pending"===S.state()?S:f.Deferred(),b=!0;var i={website_id:iAdvize.website_id,vuid:iAdvize.vuid};return o.popout&&(i.pop=1),f.ajax(o.chaturl+"api/connect?callback=?",{data:i,dataType:"json",timeout:5e3}).done(function(r){var i=r.nick,a=r.pass,s=r.vhost;if(""===i||""===a||""===s)return S.reject("Unable to retrieve valid credentials");y.connect(i+"@"+s+"/"+ +new Date,a,function(r){return r===t.Status.ATTACHED||r===t.Status.CONNECTED?(!v()||g||p||(g=!0),e.emit(n.OnXmppConnectionConnected)):r===t.Status.DISCONNECTED&&(e.emit(n.OnXmppConnectionDisconnected),u.urgent_error("livechat.xmpp.connect.error","","Disconnected from xmpp for visitor",{vuid:o.vuid})),!0})}).fail(function(){u.urgent_error("livechat.xmpp.connect.error","","Connect to xmpp for visitor failed",{vuid:o.vuid}),r?e.emit(n.OnXmppConnectionDisconnected):S.reject("Error while retrieving credentials")}),S.promise()},A=function(e){return function(n){var r=new c(n);return u.error("livechat.xmpp.stanza.error".replace("stanza",e),t.serialize(n),r.text,{id:n.id,code:parseInt(r.code,10),rooms:y.muc.roomNames,conversationId:r.fromUsername}),!0}},O=function(t){var e=new c(t);return e.from!==o.conversationJid||406!==e.code&&404!==e.code||D(e),!0},x=function(t){var e=new c(t);return i.reject(e),e.from!==o.conversationJid||406!=e.code&&404!=e.code||!C.jid||N(C.jid,C.nick,0).catch(function(){}),!0},R=function(r){var i=new a(r);if((t.getResourceFromJid(i.from)!==o.vuid&&Array.prototype.slice.call(i.raw.context.childNodes).forEach(function(t){try{var r=l(t.namespaceURI);e.emit(n[r],i)}catch(t){}}),i.x.length>0)&&"jabber:x:delay"===i.x[0].getAttribute("xmlns"))return!0;try{i.isChat()?o.chat.onMessage(i):i.isCommand()&&o.chat.onCommand(i)}catch(t){u.error("livechat.xmpp.handler.onMessage",t,i)}return!0},I=function(e){var n=f(e).attr("from").toLowerCase(),r=t.getResourceFromJid(n),i=e.childNodes[0].localName;return o.chat.onChatStates(r,i),!0},N=function(t,r,o){var a=i.get(),s={seconds:o||0};C.jid=t,C.nick=r;return y.muc.join(t,r,null,null,null,null,s),y.muc.rooms[t].addHandler("presence",function(r){if(!r)return!0;var o=f(r).find("status"),a=f.map(o,function(t){return parseInt(f(t).attr("code"),10)});return!(-1!==f.inArray(110,a)&&(e.emit(n.OnXmppRoomJoined),i.resolve(t),U(t),1))}),a},M=function(t){var e=f.Deferred();if(E[t.id]&&E[t.id].reject("desk.publish.error.outside",t,e.promise()),!t.canRetry())return u.error("livechat.xmpp.retry.error",t,"Max retry reached",{code:parseInt(t.code,10),rooms:y.muc.roomNames,conversationId:t.fromUsername}),e.reject("livechat.publish.error.retry.max",t);var n=$msg({to:t.from,from:y.jid,type:"groupchat",id:t.id}).c("body").t(t.body).up();n.c("x",{xmlns:"https://iadvize.com/schemas/retry",retry:t.retry+1});var r=+new Date;return y.muc.rooms[t.from].addHandler("message",P(e,t.id,r,t)),y.send(n),E[t.id]=e,e.promise()},P=function(t,e,n,i){return function(o){var a=f(o).attr("id"),s=+new Date;if(a===e){i&&u.info("livechat.xmpp.retry.success","Successfully retried "+i.id,r.merge(i,{conversationId:i.fromUsername}));var c=s-n;return u.info("livechat.xmpp.message.latency","Successfully delivered in "+c+" ms",{id:e,latency:c}),t.resolve(e),!1}return!0}},D=function t(e){if(C.jid){!function(t){j();var e=y.muc.roomNames.indexOf(t);delete y.muc[t],e>=0&&(y.muc.roomNames.splice(e,1),0===y.muc.roomNames.length&&(y.deleteHandler(y.muc._muc_handler),y.muc._muc_handler=null))}(e.from);var n=N(C.jid,C.nick,0);e.body&&n.done(function(){if(e.body)return M(e)}).fail(function(){t(e)})}},k=function(t){var e=new a(t);return o.chat.onMessageReceipt(e),!0},j=function(){clearInterval(T)},U=function(t){j(),T=setInterval(function(){!function(t){var e=y.getUniqueId(),n=$msg({to:t,from:y.jid,type:"groupchat",id:e}).c("ping",{xmlns:"urn:xmpp:ping"});n.up(),y.send(n)}(t)},6e4)};return e.on(n.OnXmppConnectionDisconnected,function(){if(b=!1,o.chat.connected=!1,++d>=5){if(v()&&(p||g)||!v())return e.emit(n.OnXmppReconnectionFailed),S.reject();p=!0,d=1,y.reset(),y=new t.Connection(_()),window.traceXMPP&&window.localStorage&&window.localStorage.getItem("traceXMPP")&&(y.xmlInput=function(t){traceXMPP(m,!0)},y.xmlOutput=function(t){traceXMPP(m,!1)})}clearTimeout(h),h=setTimeout(function(){w(!0)},d>1?3e3:2300)}),e.on(n.OnXmppConnectionConnected,function(){b=!1,S.resolve(),o.chat.connected=!0,y.addHandler(R,null,"message","chat"),y.addHandler(R,null,"message","groupchat"),y.addHandler(R,null,"message","command"),y.addHandler(A("presence"),null,"presence","error"),y.addHandler(A("message"),null,"message","error"),y.addHandler(O,null,"message","error"),y.addHandler(x,null,"presence","error"),y.addHandler(I,"http://jabber.org/protocol/chatstates","message","groupchat"),y.receipts.addReceiptHandler(k),d=0}),{sendChatState:function(t){y.connected&&y.send&&y.send($msg({to:o.conversationJid,from:y.jid,type:"groupchat"}).c(t).attrs({xmlns:"http://jabber.org/protocol/chatstates"}))},getConnection:function(){return y},connect:w,room:{groupchat:function(t,e){var n=f.Deferred(),r=e||y.getUniqueId(),i=function(){var e=+new Date;y.muc.rooms[C.jid].addHandler("message",P(n,r,e)),y.muc.groupchat(C.jid,t,null,r)};return E[r]=n,y.muc.rooms[C.jid]?i():N(C.jid,C.nick,0).always(i),n.promise()},leave:function(t,e){j(),y.muc.leave(t,e),C.jid=C.nick=null},join:N}}}},function(t,e,n){"use strict";var r=n(146);t.exports=function(t,e,i,o,a){var s=iAdvize,c=s.$,u=n(833),l=n(834),f={};i().outofband.addOutOfBandHandler(function(n){var o=c(n),a=o.attr("id"),s=o.attr("from"),u=(o.attr("to"),o.find("url").text()),l=o.find("desc").text();try{var f=JSON.parse(l),d=f.type,h=f.data;iAdvize.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&iAdvize.orchestrator.receiveMessage((0,r.fromOobToRfcMessage)(s,a,d,h)),t.emit(e.OnXmppOOBReceived,a,"operator",null,d,u,h),i().send($iq({type:"result",id:a,to:s}).c("query",{xmlns:Strophe.NS.OUTOFBAND}))}catch(n){t.emit(e.OnTextMessage,a,"operator",u),i().send($iq({type:"error",id:a,to:s}).c("query",{xmlns:Strophe.NS.OUTOFBAND})),console.error(n)}return!0},"set"),t.on(e.OnConversationChatUploadFilesChecked,function(n){var r=n.name+0;t.emit(e.OnConversationChatUploadStarted,n,r),i().fileupload.requestSlot({name:a+"/"+n.name,size:n.size,contentType:n.type},function(a){var l=function(t){try{var e={},n=t.childNodes[0].childNodes;return e[n[0].tagName]=decodeURIComponent(n[0].textContent),e[n[1].tagName]=decodeURIComponent(n[1].textContent),e.id=c(t).attr("id"),e}catch(t){throw new u(t.message)}}(a);f[r]=o.upload(n,l.put,function(n){t.emit(e.OnConversationChatUploadProgress,n,r)}).then(function(){var o={type:"upload",data:{url:l.get,type:n.type,name:n.name}},a=JSON.stringify(o);t.emit(e.OnConversationChatUploadCompleted,r),t.emit(e.OnXmppOOBReceived,l.id,"visitor",null,"upload",l.get,o.data),i().outofband.sendUrl(iAdvize.operator.barejid+"/operators",l.get,a),s.chat.updateHistory(s.chat.MESSAGE_TYPES.VISITOR_RICH_CONTENT,JSON.stringify(o),l.id)}).catch(function(n){var i=s.T("livechat.conversations.upload.error");"AbortUploadError"===n.name&&(i=s.T("livechat.conversations.upload.abort")),t.emit(e.OnConversationChatUploadFailed,r,i)})},function(n){throw t.emit(e.OnConversationChatUploadFailed,r,s.T("livechat.conversations.upload.error")),new l(n.message)},1e4)}),t.on(e.OnConversationChatUploadAborted,function(t){f[t]&&f[t].abort()})}},function(t,e,n){"use strict";function r(t){this.stack=(new Error).stack,this.message=t||"Failed to get an upload slot from Xmpp server",this.name="XmppSlotParseError"}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e,n){"use strict";function r(t){this.stack=(new Error).stack,this.message=t||"Failed to upload file",this.name="XmppUploadError"}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e,n){"use strict";t.exports=function(t,e,n,r){var i=n.$;r().addHandler(function(t){var e=i(t).attr("from"),n=Strophe.getBareJidFromJid(e);return r().send($pres({to:n,type:"subscribed"})),r().send($pres({to:n,type:"subscribe"})),!0},Strophe.NS.CLIENT,"presence","subscribe",null,null),r().addHandler(function(t){var e=i(t).attr("from"),n=Strophe.getBareJidFromJid(e);return r().send($pres({to:n,type:"unsubscribed"})),r().send($pres({to:n,type:"unsubscribe"})),!0},Strophe.NS.CLIENT,"presence","unsubscribe",null,null)}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t,e,n,i,o){var a=n.$,s=[],c=function(t){return r.find(s,function(e){return e.barejid===t})};return i().addHandler(function(t){var e=a(t).find("item");return r.forEach(e,function(t){var e=a(t).attr("jid"),n=Strophe.getBareJidFromJid(e);"from"===a(t).attr("subscription")&&s.push(new o({barejid:n}))}),i().send($iq({type:"result",id:a(t).attr("id")})),!0},Strophe.NS.ROSTER,"iq","set"),i().addHandler(function(t){var e=a(t).attr("from"),n=Strophe.getBareJidFromJid(e);return r.remove(s,function(t){return t.barejid===n}),!0},Strophe.NS.CLIENT,"presence","unsubscribe",null,null),i().addHandler(function(n){var i=a(n).attr("type");if(r.includes.unsubscribe,i)return!0;var o=a(n).attr("from"),s=Strophe.getBareJidFromJid(o),u=Strophe.getResourceFromJid(o),l=c(s);return!l||(0===l.resources.length&&t.emit(e.OnXmppRosterUserAvailable,s),l.resources.push(u),!0)},Strophe.NS.CLIENT,"presence",null,null,null),i().addHandler(function(n){var i=a(n).attr("from"),o=Strophe.getBareJidFromJid(i),s=Strophe.getResourceFromJid(i),u=c(o);return!u||(r.remove(u.resources,function(t){return s===t}),0===u.resources.length&&t.emit(e.OnXmppRosterUserUnavailable,o),!0)},Strophe.NS.CLIENT,"presence","unavailable",null,null),t.on(e.OnXmppConnectionConnected,function(){i().sendIQ($iq({type:"get"}).c("query",{xmlns:Strophe.NS.ROSTER}),function(t){var e=a(t).find("item");s=r.filter(e,function(t){return"both"===a(t).attr("subscription")}).map(function(t){var e=a(t).attr("jid"),n=Strophe.getBareJidFromJid(e);return new o({barejid:n})}),r.filter(e,function(t){return"from"===a(t).attr("subscription")&&"subscribe"!==a(t).attr("ask")}).forEach(function(t){var e=a(t).attr("jid");i().send($pres({to:e,type:"subscribe"}))}),n.doInit()})}),{isOnline:function(t){var e=c(t);return!!e&&e.resources.length>0}}}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t,e,n,i){var o=n.$;return i().addHandler(function(t){return!0},Strophe.NS.MUC_USER,"message",null),{sendEngage:function(t,e,n,a,s,c,u){var l=o.Deferred(),f=$msg({from:i().jid,to:a+"/operators",type:"chat"});return f.c("event",{xmlns:"http://iadvize.com/protocol/events#visitor_engaged",room:n,websiteId:s,historyId:c,channel:u||"chat"}),i().receipts.sendMessage(f,(0,r.partial)(l.resolve,t),l.reject),l.promise()},setFirstMessageId:function(t){t}}}},function(t,e,n){"use strict";t.exports=function(t,e,r){var i=n(839)({baseUrl:t.static_url+"images/emojis",blackList:["reversed-hand-with-middle-finger-extended","registered-sign","copyright-sign","trade-mark-sign"]});return t.$.get(i.getJSONUrl("apple"),function(t){i.setEmojis("apple",t),e.emit(r.OnConversationEmojisLoaded)}),t.define("emojis-service",function(){return i}),i}},function(t,e,n){"use strict";t.exports=n(840)},function(t,e,n){"use strict";var r=n(6),i=n(841).split,o=n(847),a=n(848);t.exports=function(t){var e=r.get(t,"baseUrl","/"),n=r.get(t,"blackList",[]),s=/:([a-z0-9-]+):/gm,c=r.chain(r.clone(a)).mapKeys(function(t,e){return e.replace("\\","\\\\").replace(")","\\)").replace(":","\\:").replace(";","\\;").replace("-","\\-").replace("*","\\*").replace("|","\\|").replace("(","\\(").replace("/","\\/")}).keys().value().join("|"),u=new RegExp("(\\s|^)("+c+")(?:(?=\\s|$))","mg"),l={recents:"idz-icon-emojis-recent",people:"idz-icon-emojis-people",nature:"idz-icon-emojis-animals-plants","food-drink":"idz-icon-emojis-food",objects:"idz-icon-emojis-objects","travel-places":"idz-icon-emojis-car",activity:"idz-icon-emojis-activity",symbols:"idz-icon-emojis-symbols",flags:"idz-icon-emojis-flag"},f={},d={},h={},p={},m={},g=function(t){for(var e=0,n=0,r=0,i=[];e<t.length;)n=t.charCodeAt(e++),r?(i.push((65536+(r-55296<<10)+(n-56320)).toString(16)),r=0):n>=55296&&n<=56319?r=n:i.push(n.toString(16));return i.join("-")},v=function(t,n){var r=p[t][n];return e+"/"+t+"/"+r.category+"/"+n+".png"},_=function(t){var e=r.get(o.get("emojis"),t,{name:"recents",emojis:[{char:"no recent",shortname:"noRecent",category:"recent",count:0}],fullName:"Recents"});return e.emojis=r.chain(e.emojis).sortBy(function(t){return t.count}).reverse().value(),e},y=function(t){return t.replace(u,function(t,e,n){return e+":"+a[n]+":"})},b=function(t,e){var n=i(e);return!1===n?y(e):(n=r.map(n,function(e){var n=g(e);return r.has(m[t],n)?":"+h[t][n]+":":r.has(m.apple,n)?":"+h.apple[n]+":":e}),y(n.join("")))},S=function(t,e,n){var i='<img src="<%url%>" data-char="<%char%>" data-shortname="<%shortname%>" class="emoji idzEmoji'+(n?" emojiBig":"")+'" alt="<%char%>"/>';return e=e.replace(s,function(e,n){var o=e;return r.has(d.apple,n)&&(o=i.replace(/<%char%>/g,d.apple[n]).replace(/<%url%>/g,v("apple",n)).replace(/<%shortname%>/g,n)),r.has(d[t],n)&&(o=i.replace(/<%char%>/g,d[t][n]).replace(/<%url%>/g,v(t,n)).replace(/<%shortname%>/g,n)),o})};return{getUnicode:g,getEmojiUrl:v,getSpriteUrl:function(t){return e+"/"+t+"/"+t+".png"},getJSONUrl:function(t){return e+"/"+t+"/"+t+".json"},getHistory:_,updateHistory:function(t,e){var n,i,a,s=o.get("emojis"),c=_(t).emojis;r.remove(c,{shortname:"noRecent"}),-1===r.findIndex(c,function(t){return t.unicode===e.unicode})?c=c.concat({shortname:e.shortname,char:e.char,category:"recent",count:1,unicode:e.unicode}):r.find(c,function(t){return t.unicode===e.unicode}).count+=1,r.size(c)>14&&(c=r.chain(c).sortBy("count").drop().value()),o.set("emojis",r.assign({},s,(n={},i=t,a=r.assign(_(t),{emojis:c}),i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n)))},getEmojis:function(t,e){var n=f[t]||{};return e&&(n=r.assign(n,{recents:_(t)})),n},setEmojis:function(t,e){var i=function(t){var e=r.assign({},t);return r.forEach(e,function(t){t.emojis=r.filter(t.emojis,function(t){return!r.includes(n,t.shortname)})}),e}(e);return f[t]=r.merge(f[t]||{},i),function(t,e){h[t]={},d[t]={},p[t]={},m[t]={},r.each(e,function(e){"recents"!==e.name&&r.each(e.emojis,function(e){h[t][e.unicode]=e.shortname,d[t][e.shortname]=e.char,p[t][e.shortname]=e,m[t][e.unicode]=e,r.has(e,"modifiers")&&r.each(e.modifiers,function(e){h[t][e.unicode]=e.shortname,d[t][e.shortname]=e.char,p[t][e.shortname]=e,m[t][e.unicode]=e})})})}(t,i),f[t]},hasTheme:function(t){return r.has(f,t)},getIcons:function(){return l},replaceUtf8ToImage:function(t,e){var n=i(e),r=n&&1===n.length;return S(t,b(t,e),r)},replaceUtf8ToShortname:b,replaceAliasesToShortname:y,replaceShortnameToImage:S,replaceShortnameToUtf8:function(t,e){var n=y(e);return n=n.replace(s,function(e,n){var i=e;return r.has(d.apple,n)&&(i=d.apple[n]),r.has(d[t],n)&&(i=d[t][n]),i})}}}},function(t,e,n){"use strict";e.consoleFormat=n(842);var r=e.isEmoji=n(571),i=e.split=n(575).parse;e.withoutEmoji=function(t){var e=i(t);return e?e.filter(function(t){return!r(t)}):e},e.onlyEmoji=function(t){var e=i(t);return e?e.filter(function(t){return r(t)}):e}},function(t,e,n){"use strict";var r=n(571),i=n(575).parse;t.exports=function(t){var e=i(t),n="";return e.forEach(function(t){n+=r(t)?t+" ":t}),n}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(844),i=n(845),o=n(846);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=d(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|h(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):d(t,e);if("Buffer"===e.type&&o(e.data))return d(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(l(e),t=s(t,e<0?0:0|h(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|h(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function p(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(r)return B(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o,a=1,s=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(t,o)===u(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var f=!0,d=0;d<c;d++)if(u(t,o+d)!==u(e,d)){f=!1;break}if(f)return o}return-1}function _(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function y(t,e,n,r){return H(B(e,t.length-n),t,n,r)}function b(t,e,n,r){return H(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function S(t,e,n,r){return b(t,e,n,r)}function T(t,e,n,r){return H(F(e),t,n,r)}function E(t,e,n,r){return H(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function C(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function w(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,c,u=t[i],l=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=A));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return f(null,t)},c.allocUnsafeSlow=function(t){return f(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?w(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,n);case"utf8":case"utf-8":return w(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return x(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=t.slice(e,n),f=0;f<s;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return y(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return S(this,t,e,n);case"base64":return T(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function x(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function R(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=L(t[o]);return i}function I(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function N(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function P(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function k(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(t,e,n,r,o){return o||k(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function U(t,e,n,r,o){return o||k(t,0,n,8),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},c.prototype.readUInt8=function(t,e){return e||N(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||N(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||N(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||N(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||N(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||N(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||N(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||N(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||N(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):P(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):P(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):P(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):P(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return j(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return j(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=c.isBuffer(t)?t:B(new c(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var z=/[^+\/0-9A-Za-z-_]/g;function L(t){return t<16?"0"+t.toString(16):t.toString(16)}function B(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(z,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(21))},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=u(t),r=n[0],a=n[1],s=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,a)),c=0,l=a>0?r-4:r,f=0;f<l;f+=4)e=i[t.charCodeAt(f)]<<18|i[t.charCodeAt(f+1)]<<12|i[t.charCodeAt(f+2)]<<6|i[t.charCodeAt(f+3)],s[c++]=e>>16&255,s[c++]=e>>8&255,s[c++]=255&e;2===a&&(e=i[t.charCodeAt(f)]<<2|i[t.charCodeAt(f+1)]>>4,s[c++]=255&e);1===a&&(e=i[t.charCodeAt(f)]<<10|i[t.charCodeAt(f+1)]<<4|i[t.charCodeAt(f+2)]>>2,s[c++]=e>>8&255,s[c++]=255&e);return s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(t,a,a+16383>s?s:a+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,f=n?i-1:0,d=n?-1:1,h=t[e+f];for(f+=d,o=h&(1<<-l)-1,h>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=u}return(h?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),(e+=a+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(a++,c/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*c-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[n+h]=255&a,h+=p,a/=256,u-=8);t[n+h-p]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";(function(n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){var t,e={},r="undefined"!=typeof window?window:n,i=r.document,o="localStorage";if(e.disabled=!1,e.version="1.3.20",e.set=function(t,e){},e.get=function(t,e){},e.has=function(t){return void 0!==e.get(t)},e.remove=function(t){},e.clear=function(){},e.transact=function(t,n,r){null==r&&(r=n,n=null),null==n&&(n={});var i=e.get(t,n);r(i),e.set(t,i)},e.getAll=function(){},e.forEach=function(){},e.serialize=function(t){return JSON.stringify(t)},e.deserialize=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t||void 0}},function(){try{return o in r&&r[o]}catch(t){return!1}}())t=r[o],e.set=function(n,r){return void 0===r?e.remove(n):(t.setItem(n,e.serialize(r)),r)},e.get=function(n,r){var i=e.deserialize(t.getItem(n));return void 0===i?r:i},e.remove=function(e){t.removeItem(e)},e.clear=function(){t.clear()},e.getAll=function(){var t={};return e.forEach(function(e,n){t[e]=n}),t},e.forEach=function(n){for(var r=0;r<t.length;r++){var i=t.key(r);n(i,e.get(i))}};else if(i&&i.documentElement.addBehavior){var a,s;try{(s=new ActiveXObject("htmlfile")).open(),s.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),s.close(),a=s.w.frames[0].document,t=a.createElement("div")}catch(e){t=i.createElement("div"),a=i.body}var c=function(n){return function(){var r=Array.prototype.slice.call(arguments,0);r.unshift(t),a.appendChild(t),t.addBehavior("#default#userData"),t.load(o);var i=n.apply(e,r);return a.removeChild(t),i}},u=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),l=function(t){return t.replace(/^d/,"___$&").replace(u,"___")};e.set=c(function(t,n,r){return n=l(n),void 0===r?e.remove(n):(t.setAttribute(n,e.serialize(r)),t.save(o),r)}),e.get=c(function(t,n,r){n=l(n);var i=e.deserialize(t.getAttribute(n));return void 0===i?r:i}),e.remove=c(function(t,e){e=l(e),t.removeAttribute(e),t.save(o)}),e.clear=c(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(o);for(var n=e.length-1;n>=0;n--)t.removeAttribute(e[n].name);t.save(o)}),e.getAll=function(t){var n={};return e.forEach(function(t,e){n[t]=e}),n},e.forEach=c(function(t,n){for(var r,i=t.XMLDocument.documentElement.attributes,o=0;r=i[o];++o)n(r.name,e.deserialize(t.getAttribute(r.name)))})}try{var f="__storejs__";e.set(f,f),e.get(f)!=f&&(e.disabled=!0),e.remove(f)}catch(t){e.disabled=!0}return e.enabled=!e.disabled,e})?r.apply(e,i):r)||(t.exports=o)}).call(this,n(21))},function(t,e,n){"use strict";t.exports={"<3":"heavy-black-heart","</3":"broken-heart",":)":"slightly-smiling-face","(:":"slightly-smiling-face",":-)":"slightly-smiling-face",":D":"grinning-face",":-D":"grinning-face",";)":"winking-face",";-)":"winking-face","):":"slightly-frowning-face",":(":"slightly-frowning-face",":-(":"slightly-frowning-face",":'(":"crying-face","=)":"smiling-face-with-open-mouth","=-)":"smiling-face-with-open-mouth",":*":"kissing-face",":-*":"kissing-face",":>":"grinning-face",":->":"grinning-face","8)":"smiling-face-with-sunglasses",":\\":"confused-face",":-\\":"confused-face",":/":"confused-face",":-/":"confused-face",":|":"neutral-face",":-|":"neutral-face",":O":"face-with-open-mouth",":-o":"face-with-open-mouth",">:(":"angry-face",">:-(":"angry-face",":-p":"face-with-stuck-out-tongue",":P":"face-with-stuck-out-tongue",":-P":"face-with-stuck-out-tongue",":-b":"face-with-stuck-out-tongue",";p":"face-with-stuck-out-tongue-and-winking-eye",";-p":"face-with-stuck-out-tongue-and-winking-eye",";b":"face-with-stuck-out-tongue-and-winking-eye",";-b":"face-with-stuck-out-tongue-and-winking-eye",";P":"face-with-stuck-out-tongue-and-winking-eye",";-P":"face-with-stuck-out-tongue-and-winking-eye",":o)":"monkey-face",":fu:":"reversed-hand-with-middle-finger-extended",xD:"rolling-on-the-floor-laughing"}},function(t,e,n){"use strict";t.exports=function(t,e,r,i){n(850)(e,r),n(853)(e,r),n(854)(t,e,r,i),n(855)(t,e,r),n(856)(t,e,r,i.roster),n(857)(t,e,r,i)}},function(t,e,n){"use strict";var r=n(851),i=n(852);t.exports=function(t,e){t.on(e.OnXmppOOBReceived,function(n,o,a,s,c,u,l,f){switch(s){case"upload":var d=new r(c,u);t.emit(e.OnUploadMessage,n,o,a,d,l,f);break;case"product":var h=new i(c,u);t.emit(e.OnProductMessage,n,o,a,h,l,f);break;case"message-with-multiple-choices":t.emit(e.OnMessageWithMultipleChoicesMessage,n,o,a,u,l,f)}})}},function(t,e,n){"use strict";var r=function(t,e){this.url=t||"",this.name=e.name||"unknown",this.mimeType=e.type||"unknown"};r.prototype.getUrl=function(){return this.url},r.prototype.getName=function(){return this.name},r.prototype.getMimeType=function(){return this.mimeType},t.exports=r},function(t,e,n){"use strict";var r=function(t,e){this.url=e.productUrl||"",this.title=e.title||"",this.imageUrl=e.imageUrl||"",this.priceCatalog=e.priceCatalog||"",this.pricePromotion=e.pricePromotion||"",this.isAvailable=!!e.available};r.prototype.getUrl=function(){return this.url},r.prototype.getTitle=function(){return this.title},r.prototype.getPrice=function(){return""!==this.pricePromotion?this.pricePromotion:this.priceCatalog},r.prototype.getImage=function(){return this.imageUrl},r.prototype.getPriceOriginal=function(){return""!==this.pricePromotion?this.priceCatalog:""},r.prototype.getIsAvailable=function(){return this.isAvailable},t.exports=r},function(t,e,n){"use strict";t.exports=function(t,e){var n=iAdvize,r=!1;t.on(e.OnConversationChatFileSelected,function(n){for(var r=n.target.files,i=0;i<r.length;i++){var o=r[i];o.size>3e7?t.emit(e.OnConversationChatUploadMaxSizeReached,3e7,o):/image\//.test(o.type)||/application\/pdf/.test(o.type)?t.emit(e.OnConversationChatUploadFilesChecked,o):t.emit(e.OnConversationChatUploadBadMimeType,o)}}),t.on(e.OnXmppConnectionConnected,function(){window.File&&window.FileList&&window.FileReader&&void 0!==window.FormData&&n.Templates.upload&&!r&&(n.Templates.upload.initialize(),r=!0,t.emit(e.OnConversationChatUploadInitialized))})}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t,e,n,i){var o=t.$,a=/\b(3[47]\d{2}([ -]?)(?!(\d)\3{5}|123456|234567|345678)\d{6}\2(?!(\d)\4{4})\d{5}|((4\d|5[1-5]|65)\d{2}|6011)([ -]?)(?!(\d)\8{3}|1234|3456|5678)\d{4}\7(?!(\d)\9{3})\d{4}\7\d{4})\b/g,s=[t.T("POSER_VOTRE_QUESTION_ICI"),t.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA"),t.customize["chatbar_txt2_"+t.curlang]],c="1"===t.preferences.bankcard_number_hidden;e.on(n.OnXmppRoomJoined,function(){o("#idz_msgmsg").on("change paste keyup",(0,r.throttle)(function(){t.operator.barejid&&"i_will_be_back"!==t.operator.barejid&&l(o(this).val())},2500))});var u=(0,r.throttle)(function(e){t.operator.barejid&&"i_will_be_back"!==t.operator.barejid&&l(e&&e.payload&&e.payload.message?e.payload.message:"")},2500);e.on("onMessageComposed",u),e.on("onMessageSubmitted",u);var l=function(e){var n=i.connection.getConnection(),o=(0,r.flow)([f,d,r.trim])(e),a=$msg({to:Strophe.getBareJidFromJid(t.operator.barejid)+"/operators",from:n.jid,type:"command",website:t.website_id}).c("body").t("!preview "+o);n.send(a)},f=function(t){return c?t.replace(a,"xxxx-xxxx-xxxx-xxxx"):t},d=function(t){return(0,r.includes)(s,t)?"":t}}},function(t,e,n){"use strict";t.exports=function(t,e,n){e.on(n.OnConversationChatEmojiSelected,function(e,n){var r,i,o,a;r=":"+e.shortname+":",i=t.$("#idz_msgmsg").get(0),o=i.selectionStart,a=[i.value.substr(0,i.selectionStart),r,i.value.substr(i.selectionStart,i.value.length-1)].join(""),t.$(i).val(a).focus().trigger("change"),i.setSelectionRange(o+r.length,o+r.length)})}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t,e,i,o){var a=n(576)(t).isAsyncChatEnabled,s=t.$,c=null,u=0,l=!1;1===t.preferences.mirroring_enabled&&(c=t.require("mirror"));var f=function(e){return t.operator.barejid===e&&2===t.chat.status},d=function(e,n){t.operator.nick+"@"+t.bosh_host===n&&(t.operator.is_online=e,t.operator.barejid=n,0===e&&c&&c.disable&&c.disable())};e.on(i.OnXmppRosterUserAvailable,function(e){if(f(e))return u>0?(clearTimeout(u),void(u=0)):void(l&&(a()||t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("OPERATEUR_RECONNECTION")).replace(/\{TIME\}/g,t.chat.getMsgTime())),l=!1))}),e.on(i.OnXmppRosterUserUnavailable,function(e){f(e)&&(u=r.delay(function(e){u=0,o.isOnline(e)||(a()||t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("OPERATEUR_DECONNECTION")).replace(/\{TIME\}/g,t.chat.getMsgTime())),s(".idz_writting").html(" "),l=!0)},1e4,e))}),e.on(i.OnXmppRosterUserUnavailable,r.partial(d,0)),e.on(i.OnXmppRosterUserAvailable,r.partial(d,1))}},function(t,e,n){var r=d(n(858)),i=d(n(859)),o=d(n(860)),a=d(n(861)),s=d(n(862)),c=d(n(863)),u=d(n(864)),l=d(n(865)),f=d(n(866));function d(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t,e,d,h){n(867)(t,e,d,h,r.default),n(868)(t,e,d,h,o.default),n(869)(t,e,d,h,a.default),n(870)(t,e,d,h,s.default),n(871)(t,e,d,h,u.default),n(872)(t,e,d,h,c.default),n(873)(t,e,d,h,i.default),n(874)(t,e,d,h),n(875)(t,e,d),n(876)(t,e,d,h,l.default),n(877)(t,e,d,h),n(878)(t,e,d,h),n(879)(t,e,d,h),n(880)(t,e,d,h),n(881)(t,e,d,h),n(883)(t,e,d,h),n(884)(t,e,d,h),n(885)(t,e,d,h),n(886)(t,e,d),n(887)(t,e,d,h,f.default)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).getTime();!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e}return n(t,[{key:"build",value:function(t,e){return new t("event",{xmlns:e.event_conversation_closed})}}]),t}();e.default=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.customData=e}return n(t,[{key:"build",value:function(t,e){var n=new t("event",{xmlns:e.event_custom_data_sent});return n.c("custom-data",{},this.customData),n}}]),t}();e.default=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"build",value:function(t,e){return new t("event",{xmlns:e.event_cobrowsing_stopped})}}]),t}();e.default=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"build",value:function(t,e){return new t("event",{xmlns:e.event_cobrowsing_started})}}]),t}();e.default=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"build",value:function(t,e){return new t("event",{xmlns:e.event_cobrowsing_asked})}}]),t}();e.default=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"build",value:function(t,e){return new t("event",{xmlns:e.event_cobrowsing_refused})}}]),t}();e.default=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"build",value:function(t,e){return new t("event",{xmlns:e.event_cobrowsing_accepted})}}]),t}();e.default=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rule=e}return n(t,[{key:"build",value:function(t,e){return new t("event",{xmlns:e.event_engagement_rule_triggered,name:this.rule.label})}}]),t}();e.default=r},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(6);var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lang=e.lang||"",this.name=e.name||"",this.vuid=e.vuid||"",this.browser=this._default(this.buildBrowser(e)),this.geoloc=this._default(this.buildGeoLoc(e)),this.activity=this._default(this.buildActivity(e)),this.profile=e}return r(t,[{key:"_default",value:function(t){return(0,i.mapValues)(t,function(t){return isNaN(Number(t))?t||"":Number(t)})}},{key:"buildBrowser",value:function(t){return{actualURI:t.actualURI,referrerLastPage:t.referrerLastPage,actualScreen:t.actualScreen,winWidth:t.winWidth,winHeight:t.winHeight,browserInfo:t.browserInfo,deviceInfo:t.deviceInfo,userAgent:t.userAgent,ip:t.ip,deviceType:t.deviceType,originSite:t.originSite,origin:t.origin,refEngine:t.refEngine,refKeyword:t.refKeyword,sessionId:t.sessionId,pageView:t.pageView}}},{key:"buildGeoLoc",value:function(t){return{country:t.country_name,lat:t.lat,locality:t.city,lon:t.long}}},{key:"buildActivity",value:function(t){return{chatcount:t.chatcount,connectionTime:t.connectionTime,day:t.day,hour:t.hour,lastMove:t.lastMove,navTime:t.navTime,nbrVisite:t.nbrVisite,timeElapsed:t.timeElapsed}}},{key:"build",value:function(t,e){var n=new t("event",{xmlns:e.event_visitor_profile_sent}),r=n.c("visitor-profile",{},null),i=new t("geoloc",{xmlns:"http://jabber.org/protocol/geoloc"});i.c("country",{},this.geoloc.country).c("lat",{},this.geoloc.lat).c("locality",{},this.geoloc.locality).c("lon",{},this.geoloc.lon);var o=new t("browser",this.browser),a=new t("activity",this.activity);return r.c("lang",{},this.lang).c("name",{},this.name).c("vuid",{},this.vuid).cnode(i.tree()).up().cnode(o.tree()).up().cnode(a.tree()),n}}]),t}();e.default=o},function(t,e){t.exports=function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4e3,a=o,s=function(){return t.featureFlags["iadvize.conversations.asynchronous-livechat"]},c=function(){if(t.flags.operator_closed=1,t.JSONStore.saveData({operator_closed:t.flags.operator_closed}),2===t.chat.status||3===t.chat.status){t.$("#idz_msgmsg, #idz_postmsg").prop("disabled",!0),t.flags.visio_status&&e.emit(n.OnConversationVisioClosed),s()||t.chat.putOpAlert(t.T("FIN_DISCUSSION")),t.callbacks.onChatEnded({id:t.chat.history_id,endedBy:"operator"}),delete t.operator.barejid;var r=+t.flags.visio_status&&1==t.preferences.param_visio_satisfaction||!+t.flags.visio_status&&1==t.preferences.param_satisfaction;setTimeout(function(){t.$("#idz_msgmsg, #idz_postmsg").prop("disabled",!1),s()&&e.once(n.OnAsyncConversationClosed,function(){t.Templates.hideUI(),t.JSONStore.saveData({chat_status:1,satisfaction_status:0})}),-1!==t.operator.id&&1!==t.virtualOP&&r&&0===t.chat.satisfaction&&!t.blocked?(t.chat.satisfaction=1,e.emit(n.OnDisplaySurveyForm),t.callbacks.onSatisfactionDisplayed()):(t.Templates.hideDialog(),s()&&e.emit(n.OnAsyncConversationClosed))},a)}t.flags.popup_mode&&delete t.flags.popup_mode,t.chat.EndOfChat()};e.on(n.OnEventConversationClosed,function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:""}).from)c();else{var e=new i,n=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});n.cnode(e.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(n);var o=e.id;1!=t.chat.status&&(t.chat.status=3,t.flags.visitor_closed=1,t.chat.sendPresence("available"),t.JSONStore.saveData({visitor_closed:t.flags.visitor_closed,chat_status:t.chat.status}),t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR_ALERT,"VISITOR_CHAT_CLOSE",o))}})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventCobrowsingStopped,function(){var e=new i,n=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});n.cnode(e.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(n),t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR_ALERT,"COBROWSING_STOP")})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventCobrowsingStarted,function(){var e=new i,n=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});n.cnode(e.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(n)})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventCobrowsingAsked,function(){var e=new i,n=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});n.cnode(e.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(n)})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventCobrowsingAccepted,function(){var e=new i,n=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});n.cnode(e.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(n)})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventCobrowsingRefused,function(){var e=new i,n=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});n.cnode(e.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(n)})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventCustomDataRequested,function(e){e.from;var n=t.vStats.customData(),o=new i(n),a=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});a.cnode(o.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(a)})}},function(t,e){function n(t){if(null==t)throw new TypeError("Cannot destructure undefined")}t.exports=function(t,e,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=function(){t.JSONStore.saveData({on_call:t.on_call,chat_status:t.chat.status,history_id:t.chat.history_id,chatbox_state:t.chatbox_state})};e.on(r.OnEventCallOperatorAnswered,function(r){var s=Array.prototype.slice.call(r.raw.context.childNodes).filter(function(t){return t.namespaceURI===i.namespaces.event_call_operator_answered}).reduce(function(t,e){return n(t),{room:e.getAttribute("room"),historyId:e.getAttribute("historyId")}},{});i.connection.room.join(s.room,t.vuid),t.conversationJid=s.room;var c=r.barejid;t.callbacks.onCallStarted(),1===t.preferences.c2c_callvisitorfirst?document.querySelector(".c2cpopin_label").innerHTML='<div class="c2cpopin_label_phone"></div>'+t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT2"):document.querySelector(".c2cpopin_label").innerHTML='<div class="c2cpopin_label_phone"></div>'+t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT3"),1!==t.preferences.call_offline_enabled&&(t.on_call=1),t.opOffline=0,t.chat.status=2,t.chat.history_id=parseInt(s.historyId,10),t.vStats.history_id=parseInt(s.historyId,10),t.chat.dialogCount(),t.operator=t.c2coperator,t.c2coperator.barejid&&t.c2coperator.barejid.toLowerCase()===c.toLowerCase()||(t.c2coperator.barejid=c.toLowerCase(),t.operator.barejid=c.toLowerCase(),t.util.addScript("getop",t.chaturl+"rpc/getop.php?sid="+t.website_id+"&u="+t.vuid+"&getop="+c)),t.flags.proactif_alert&&""!=t.flags.proactif_alert&&t.chat.sendAlert(t.flags.proactif_alert,t.flags.message,!0),t.c2cTimeout=setTimeout(function(){e.emit("engagement.callBox.reset")},1e4*o),a()}),e.on(r.OnEventCallStarted,function(e){var r=Array.prototype.slice.call(e.raw.context.childNodes).filter(function(t){return t.namespaceURI===i.namespaces.event_call_started}).reduce(function(t,e){return n(t),{number:e.getAttribute("number"),historyId:e.getAttribute("historyId")}},{});document.querySelector(".c2cpopin_label").innerHTML='<div class="c2cpopin_label_phone"></div>'+t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT3"),t.chat.dialogCount(),1!==t.preferences.call_offline_enabled&&(t.on_call=1),t.opOffline=0,t.chat.status=2,t.chat.history_id=parseInt(r.historyId,10),setTimeout(function(){t.chat.closeC2cPopin()},7e3*o),a()}),e.on(r.OnEventCallStopped,function(n){i.connection.room.leave(t.conversationJid,t.vuid),t.callbacks.onCallEnded();var s=document.querySelector(".c2cpopin_label");s&&(s.innerHTML='<div class="c2cpopin_label_phone"></div>'+t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT1")),t.on_call=0,t.chat.status=3,t.chat.history_id=0,t.chatbox_state=t.chat.CHATBAR_HIDDEN,t.activeCall=null,setTimeout(function(){t.chat.closeC2cPopin()},7e3*o),"1"==t.preferences.param_satisfaction&&0==t.chat.satisfaction&&(t.chat.buildChat(),t.chat.satisfaction=1,e.emit(r.OnDisplaySurveyForm),t.callbacks.onSatisfactionDisplayed()),a()}),e.on(r.OnEventCallErrored,function(e){t.chat.showC2cError(t.T("call.error.try.again")),t.on_call=0,t.chat.status=1,a()})}},function(t,e){t.exports=function(t,e,n){e.on(n.OnEventEngageReceived,function(){if(t.routing.enabled&&t.logMailer("conversations.routing.operator.engage.acknowledge","Routing acknowledge received",{vuid:t.vuid,barejid:t.operator.barejid,historyId:t.chat.history_id,conversationJid:t.conversationJid}),2!==t.chat.status){var e="visitor";(t.flags.proactif_alert||t.flags.proactif_invit)&&(e="proactif"),t.callbacks.onChatStarted({id:t.chat.history_id,startedBy:e})}t.chat.status=2,t.chat.sendProactifAlert()})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventEngagementRuleTriggered,function(){if(t.flags.proactif_alert&&""!=t.flags.proactif_alert){var e=t.ProActif._datas.filter(function(e){return e.id===t.flags.proactif_activatedId});if(!e.length)return;var n=new i(e[0]),o=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,from:r.connection.getConnection().jid,type:"groupchat"});o.cnode(n.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(o)}})}},function(t,e){t.exports=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:800,o=function(e){var n={url:"",name:"",pushed:!1},i=n;return e.getCommand().param1&&(i.url=t.util.nl2br(decodeURIComponent(e.getCommand().param1))),e.getCommand().param2&&(i.name=e.getCommand().param2,i.pushed="push"===e.getCommand().name),Array.prototype.slice.call(e.raw.context.childNodes).filter(function(t){return t.namespaceURI===r.namespaces.event_link_sent}).reduce(function(e,n){e.name,e.description,e.image,e.pushed;return{name:n.querySelector("name").textContent,url:t.util.nl2br(decodeURIComponent(n.querySelector("url").textContent)),pushed:!!JSON.parse(n.getAttribute("pushed"))}},n)},a=function(){return t.noOfferPanelTemplate=t.Templates.isResponsive,t.noOfferPanelTemplate};e.on(n.OnEventLinkSent,function(r){var s="",c=o(r),u=c.pushed?"PUSH":"LINKS";t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR_ALERT,u+" "+c.url+" "+c.name),t.callbacks.onLinkReceived({name:c.name,url:c.url,push:c.pushed}),-1===c.url.indexOf(t.website_url)?s=" target='_blank'":c.pushed&&setTimeout(function(){window.parent.location.assign(c.url)},i);var l=t.Templates.putLinkItem(c.url,c.name,s);a()?t.chat.put_dialog(l):t.chat.putOpAlert(t.T(c.pushed?"OPERATEUR_PUSHLINK":"OPERATEUR_SENDLINK")),t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.emit(n.OnEventLinkSentReceived,r,c)})}},function(t,e){t.exports=function(t,e,n,r){arguments.length>4&&void 0!==arguments[4]&&arguments[4];var i=function(t){var e={url:"",name:"",description:"",image:""},n=t.getCommand().param2;if(n){var i=["url","name","description","image"];return(t.getCommand().param1+"|"+n).split("|").reduce(function(t,e,n){return t[i[n]]=e,t},e)}return Array.prototype.slice.call(t.raw.context.children).filter(function(t){return t.namespaceURI===r.namespaces.event_offer_sent}).reduce(function(t,e){return{name:e.querySelector("name").textContent,description:e.querySelector("description")?e.querySelector("description").textContent:"",image:e.querySelector("image").textContent,url:e.querySelector("url")?e.querySelector("url").textContent:""}},e)},o=function(){return t.noOfferPanelTemplate=t.Templates.isResponsive,t.noOfferPanelTemplate};e.on(n.OnEventOfferSent,function(r){var a="",s=i(r);t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR_ALERT,"OFFERS "+t.util.htmlspecialchars(s.url)+" "+t.util.htmlspecialchars([s.name,s.description,s.image].join("|"))),-1===s.url.indexOf(t.website_url)&&(a=" target='_blank'");var c=t.Templates.putOfferItem(t.util.htmlspecialchars(s.url),t.util.htmlspecialchars([s.name,s.description,s.image].join("|")),a);o()?t.chat.put_dialog(c):t.chat.putOpAlert(t.T("OPERATEUR_SENDOFFER")),t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.emit(n.OnEventOfferSentReceived,r,s),t.callbacks.onOfferReceived({name:s.name,url:s.url})})}},function(t,e,n){var r=n(146),i=n(577);t.exports=function(t,e,n){var o=function(t){return(0,i.parseCard)(t.raw.find("card:first"))};t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.on(n.OnEventCardSent,function(e){return t.orchestrator.receiveMessage((0,r.toRfcMessage)(e,[(0,r.toRfcCardAttachment)(o(e))]))})}},function(t,e,n){var r=n(146),i=n(577);t.exports=function(t,e,n){var o=function(t){return{cards:(0,i.parseCards)(t.raw)}};t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.on(n.OnEventCardBundleSent,function(e){return t.orchestrator.receiveMessage((0,r.toRfcMessage)(e,[(0,r.toRfcCardBundleAttachment)(o(e))]))})}},function(t,e,n){var r=n(146),i=n(580);t.exports=function(t,e,n){var o=function(t){return(0,i.parseProductOffer)(t.raw.find("product-offer:first"))};t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.on(n.OnEventProductOfferSent,function(e){return t.orchestrator.receiveMessage((0,r.toRfcMessage)(e,[(0,r.toRfcProductOfferAttachment)(o(e))]))})}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.parseAvailability=function(t){if(t.length)return{status:t.attr("status")}}},function(t,e,n){var r=n(146),i=n(580);t.exports=function(t,e,n){var o=function(t){return{productOffers:(0,i.parseProductOffers)(t.raw)}};t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.on(n.OnEventProductOfferBundleSent,function(e){return t.orchestrator.receiveMessage((0,r.toRfcMessage)(e,[(0,r.toRfcProductOfferBundleAttachment)(o(e))]))})}},function(t,e,n){var r=n(146);t.exports=function(t,e,n){var i=function(t){return{fileName:t.raw.find("file:first > filename:first").text(),mimeType:t.raw.find("file:first > mime-type:first").text(),url:t.raw.find("file:first > url:first").text()}};t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.on(n.OnEventFileSent,function(e){return t.orchestrator.receiveMessage((0,r.toRfcMessage)(e,[(0,r.toRfcFileAttachment)(i(e))]))})}},function(t,e,n){var r=n(146);t.exports=function(t,e,n){var i=function(e){return{message:e.raw.find("quick-replies:first > message:first").text(),choices:e.raw.find("quick-replies:first > choices:first > choice").map(function(e,n){return t.$(n).text()}).get()}};t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&e.on(n.OnEventQuickRepliesSent,function(e){return t.orchestrator.receiveMessage((0,r.toRfcMessage)(e,[(0,r.getQuickReplyMenuMessageAttachment)(i(e))]))})}},function(t,e){t.exports=function(t,e,n){e.on(n.OnEventVisitorBlocked,function(){2===t.chat.status?(t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("OPERATEUR_DECONNECTION")).replace(/\{TIME\}/g,t.chat.getMsgTime())),t.blocked=!0):t.Templates.hideUI()})}},function(t,e){t.exports=function(t,e,n,r,i){e.on(n.OnEventVisitorProfileRequested,function(e){e.from;var n=t.vStats.getProfile(),o=JSON.parse(n),a=new i(o),s=new r.stanzaBuilder("message",{id:r.connection.getConnection().getUniqueId(),to:t.conversationJid,type:"groupchat"});s.cnode(a.build(r.stanzaBuilder,r.namespaces).tree()),r.connection.getConnection().send(s)})}},function(t,e,n){t.exports=function(t,e,r,i){return{renderingController:n(889)(t,e,r,i),gdpr:n(891)(t,e,r)}}},function(t,e,n){"use strict";var r=n(890);t.exports=function(t,e,n,i){var o=function(){if(n.Templates&&n.Templates.emojis){if(0!==n.$(".idzEmojisPopupToggler").length||0===Object.keys(i.getEmojis("apple",!1)).length)return;if(!n.$("#idz_msgmsg").length)return;var r=!1,o=i.getEmojis("apple",!0),a=i.getIcons(),s=n.$("#idz_chatglobal"),c=n.Templates.emojis.getEmojisPopupDOM(),u=c.find(".idzFloatingPopupArrow"),l=c.find(".idzEmojisList"),f=c.find(".idzEmojisCategories"),d=n.Templates.emojis.getTogglerDOM();for(var h in a){var p=o[h].fullName,m=o[h].emojis,g=n.Templates.emojis.getEmojisCategoryDOM(p,h),v=n.Templates.emojis.getCategoryTabDOM(h,a[h]);for(var _ in m){var y=n.Templates.emojis.getEmojiDOM(m[_].shortname);g.find(".idzEmojisCategoryEmojis").append(y),"noRecent"!==m[_].shortname&&y.on("click",function(r){var i=n.$(this).data("emoji");t.emit(e.OnConversationChatEmojiSelected,i,r),d.click()}).data("emoji",m[_])}v.on("click",function(t){var e=n.$(this).data("category");l.animate({scrollTop:n.$('.idzEmojisCategory[data-category="'+e+'"]').get(0).offsetTop},500),t.preventDefault()}),c.find(".idzEmojisList").append(g),f.append(v)}var b=f.find(".idzEmojiCategoryChar"),S=l.find(".idzEmojisCategory");b.first().addClass("selected"),l.on("scroll",function(t){var e=parseInt(l.css("padding-top"),10),r=l.get(0).scrollTop+e+1;n.$(".idzEmojiCategoryChar").removeClass("selected");for(var i=0;i<S.length;i++){var o=S[i],a={top:o.offsetTop,bottom:o.offsetTop+o.offsetHeight};r>a.top&&r<a.bottom&&n.$(b[i]).addClass("selected")}t.stopPropagation()});var T=n.$("#idz_chat_actions"),E=n.$("#idz_msgmsg");d.on("click",function(t){r=!r;var e=s.get(0).getBoundingClientRect(),i=n.$(this).get(0).getBoundingClientRect(),o=Math.abs(e.top-i.top),a=Math.abs(e.left-i.left),l=o-c.height()-10,f=e.width-c.width();c.css({bottom:"auto",right:"auto",left:f,top:l}).toggleClass("opened"),u.css({left:a-f+2}),d.toggleClass("active"),t.stopPropagation()}),s.append(c),T.prepend(d);var C=T.width();E.css({paddingRight:C,width:E.get(0).offsetWidth-C}),c.find(".idzEmojiChar").css("background-image","url("+i.getSpriteUrl("apple")+")"),n.$(document).on("click.emojis",function(t){var e=c.get(0);e&&e.contains(t.target)||!r||(t.stopPropagation(),t.preventDefault(),d.click())})}};t.on(e.OnUploadMessage,function(t,e,r,i,o,a){if(n.Templates.upload&&n.Templates.upload.getUploadedFileDOM){var s="",c=r||n.chat.getMsgTime();if(a)s="VISITOR"===a.type?n.T("VOUS"):a.nickName;else switch(e){case"operator":n.operator&&n.operator.pseudo&&(s=n.operator.pseudo);break;case"visitor":s=n.T("VOUS")}var u=n.Templates.upload.getUploadedFileDOM(s,e,c,i.getName(),i.getMimeType(),i.getUrl());u.attr("data-id",t),o?o.append(u):n.chat.putOpFile(t,u)}else n.chat.putOpMsg(t,i.getUrl(),0)}),t.on(e.OnTextMessage,function(t,e,r,i,o){switch(e){case"operator":n.chat.putOpMsg(t,i,0)}}),t.on(e.OnProductMessage,function(t,e,r,i,o,a){var s=r||n.chat.getMsgTime(),c="";if(a)c="VISITOR"===a.type?n.T("VOUS"):a.nickName;else switch(e){case"operator":n.operator&&n.operator.pseudo&&(c=n.operator.pseudo)}if(n.Templates.products&&n.Templates.products.getProductDOM){var u=n.Templates.products.getProductDOM(i.getImage(),i.getTitle(),i.getPrice(),i.getPriceOriginal(),i.getIsAvailable(),i.getUrl(),c,s,n.T("chatbox.products.link_label"));o?o.append(u):n.chat.putOpProduct(t,u)}else""!=i.getUrl()&&n.chat.putOpMsg(t,i.getUrl(),0)}),t.on(e.OnMessageWithMultipleChoicesMessage,function(t,e,r,i,o,a){var s=r||n.chat.getMsgTime(),c="";if(c=a?a.nickName?a.nickName+" : ":"":n.operator.pseudo?n.operator.pseudo+" : ":"",n.Templates.messageWithMultipleChoices&&n.Templates.messageWithMultipleChoices.getDOM){var u=n.Templates.messageWithMultipleChoices.getDOM(i.message,i.choices,s,c,a?a.pictureUrl:n.chat.getOperatorAvatarUrl());n.chat.putOpMessageWithMultipleChoices(t,u,null,o)}}),t.on(e.OnConversationChatUploadMaxSizeReached,function(t,e){var i=n.T("livechat.conversations.upload.fileTooBig").replace("%maxSize%",r(t)).replace("%fileName%",e.name),o=n.Templates.upload.getUploadErrorMessageDOM(i);n.chat.putOpFile("error",o)}),t.on(e.OnConversationChatUploadBadMimeType,function(t){var e=t.name+": "+n.T("livechat.conversations.upload.badType"),r=n.Templates.upload.getUploadErrorMessageDOM(e);n.chat.putOpFile("error",r)}),t.on(e.OnConversationChatUploadStarted,function(t,e){var r,i=n.Templates.upload.getUploadProgressDOM(((r=t.name).length>29&&(r=r.substring(0,18-"...".length)+"..."+r.substring(r.length-11,r.length)),r),e);n.chat.putOpFile(e,i)}),t.on(e.OnConversationChatUploadProgress,function(t,e){n.$('.idz_upload[data-id="'+e+'"]').find(".idz_progress").css("width",t+"%")}),t.on(e.OnConversationChatUploadCompleted,function(t){n.$('.idz_upload[data-id="'+t+'"]').remove()}),t.on(e.OnConversationChatUploadFailed,function(t,e){n.$('.idz_upload[data-id="'+t+'"]').addClass("idz_upload_error").html(e)}),t.on(e.OnConversationChatUploadInitialized,function(){if(n.Templates.hasUpload&&n.Templates.upload&&n.Templates.dragNDrop){var r=n.$("#idz_chatbox").find(".chatboxDropZoneContainer"),i=function(){n.$(window).focus(),r.removeClass("displayed"),r.find(".chatboxDropZone").removeClass("active")},o=n.Templates.dragNDrop.getDropZone();o.on("dragenter dragover",function(){var t=n.$(this).addClass("active").find("img");t.attr("src",t.data("src-on"))}).on("dragleave",function(){var t=n.$(this).removeClass("active").find("img");t.attr("src",t.data("src-off"))}),o.find("input").on("change",function(r){t.emit(e.OnConversationChatFileSelected,r),n.$(this).val(""),i()}),o.find(".chatFileUploader").on("click",function(t){n.$(t.target).find("input").click()});var a=o.find("img");a.attr("src",a.data("src-off")),n.$(window).on("dragenter",function(){n.$(window).focus(),r.addClass("displayed")}),n.$(window).on("mouseleave",i),r.append(o)}}),t.on(e.OnXmppConnectionConnected,o),t.on(e.OnConversationEmojisLoaded,o)}},function(t,e,n){"use strict";(function(e){
/**
 * filesize
 *
 * @copyright 2018 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 3.6.1
 */
!function(e){var n=/^(b|B)$/,r={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},i={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};function o(t){var e,o,a,s,c,u,l,f,d,h,p,m,g,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_=[],y=0,b=void 0,S=void 0;if(isNaN(t))throw new Error("Invalid arguments");return o=!0===v.bits,d=!0===v.unix,e=v.base||2,f=void 0!==v.round?v.round:d?1:2,h=void 0!==v.separator&&v.separator||"",p=void 0!==v.spacer?v.spacer:d?"":" ",g=v.symbols||v.suffixes||{},m=2===e&&v.standard||"jedec",l=v.output||"string",s=!0===v.fullform,c=v.fullforms instanceof Array?v.fullforms:[],b=void 0!==v.exponent?v.exponent:-1,a=e>2?1e3:1024,(u=(S=Number(t))<0)&&(S=-S),(-1===b||isNaN(b))&&(b=Math.floor(Math.log(S)/Math.log(a)))<0&&(b=0),b>8&&(b=8),0===S?(_[0]=0,_[1]=d?"":r[m][o?"bits":"bytes"][b]):(y=S/(2===e?Math.pow(2,10*b):Math.pow(1e3,b)),o&&(y*=8)>=a&&b<8&&(y/=a,b++),_[0]=Number(y.toFixed(b>0?f:0)),_[1]=10===e&&1===b?o?"kb":"kB":r[m][o?"bits":"bytes"][b],d&&(_[1]="jedec"===m?_[1].charAt(0):b>0?_[1].replace(/B$/,""):_[1],n.test(_[1])&&(_[0]=Math.floor(_[0]),_[1]=""))),u&&(_[0]=-_[0]),_[1]=g[_[1]]||_[1],"array"===l?_:"exponent"===l?b:"object"===l?{value:_[0],suffix:_[1],symbol:_[1]}:(s&&(_[1]=c[b]?c[b]:i[m][b]+(o?"bit":"byte")+(1===_[0]?"":"s")),h.length>0&&(_[0]=_[0].toString().replace(".",h)),_.join(p))}o.partial=function(t){return function(e){return o(e,t)}},t.exports=o}("undefined"!=typeof window&&window)}).call(this,n(21))},function(t,e,n){var r=n(147),i=n(892);t.exports=function(t,e,n){var o=n.$,a=function(){return n.featureFlags["iadvize.conversations.asynchronous-livechat"]},s=function(t){n.flags.proactif_activatedId=t},c=function(t){var e=(n.customizeTranslate||{})[t]||{};return e[n.curlang]||e.en||""},u=function(t){var e=iAdvize.featureFlags["iadvize.livechat.auto-engage-on-rules"];return-1!==(e&&"false"!==e?e.split(","):[]).indexOf(t.toString())},l=!1;t.on(e.showChatbox,function(t,e,r){s(r),n.Templates.showDialog(),u(r)?n.chat.startChat():l||(a()?n.chat.putOpAlert(n.T("SAISIR_UN_MESSAGE"),void 0,""):n.chat.putOpAlert(n.T("SAISIR_UN_MESSAGE")),l=!0)});var f=function(t,e,n,r){s(n),iAdvize.Templates.showDialog();var i=iAdvize.util.nl2br(iAdvize.util.htmlspecialchars(r)),o=iAdvize.chat.getOpMsg(i);iAdvize.chat.put_dialog(o)};t.on(e.showMessage,f);var d=function(){return{button:n.$("#idz_postmsg"),textarea:n.$("#idz_msgmsg")}},h=function(){var t=d(),e=t.button,n=t.textarea;e.prop("disabled",!0),n.prop("disabled",!0),n.prop("valueBackup",n.val()),n.val("")},p=function(t){var e=d(),n=e.button,r=e.textarea;r.val(r.prop("valueBackup")),r.prop("disabled",!1),n.prop("disabled",!1),t&&r.focus()},m=function(){return""+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")+ +new Date},g=function(r,i,a,u){s(u),n.Templates.showDialog(),h();var l=c("livechat.conversations.consent.legal.openingMessage"),f=n.T("livechat.conversations.consent.moreInfo"),d=l+'<div><a href="javascript:void(0);" class="idz_gdpr_moreinfo">'+f+"</a></div>",p=[n.T("livechat.conversations.consent.startConversation"),n.T("livechat.conversations.consent.stopConversation")],g=[function(){return t.emit(e.GDPRAccepted,i,a,u)},function(){return t.emit(e.GDPRRefused,i,a,u)}];if(n.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&iAdvize.orchestrator.askGDPRConsent({message:l,moreInfos:{label:f,event:function(){return t.emit(e.showLegalInformationPopin)}},choices:[{label:n.T("livechat.conversations.consent.startConversation"),event:function(){return t.emit(e.GDPRAccepted,i,a,u)}},{label:n.T("livechat.conversations.consent.stopConversation"),event:function(){return t.emit(e.GDPRRefused,i,a,u)}}]}),n.Templates.messageWithMultipleChoices&&n.Templates.messageWithMultipleChoices.getDOM){var v=n.Templates.messageWithMultipleChoices.getDOM(d,p,"","","");n.chat.putOpMessageWithMultipleChoices(m(),v,g),o("#idz_dialogbox").animate({scrollTop:0},0),o(".idz_gdpr_moreinfo").off("click"),o(".idz_gdpr_moreinfo").on("click",function(){t.emit(e.showLegalInformationPopin)})}};t.on(e.showChatboxWithGDPRWorkflow,g);t.on(e.showMessageWithGDPRWorkflow,function(t,e,n,r,i){f(0,0,r,i),g(0,e,n,r)});t.on(e.showLegalInformationPopin,function(){var t,e,o,a,s=(t=n.T("livechat.conversations.consent.legal.explanations.duration.days"),e=n.T("livechat.conversations.consent.legal.explanations.duration.years"),o=n.preferences.anonymization_delay||1080,a=o>=360?e.replace("{DURATION}",o/360):t.replace("{DURATION}",o),{fixedTranslations:{title:n.T("livechat.conversations.consent.legal.title"),explanation:n.T("livechat.conversations.consent.legal.explanations").replace("{DURATION}",a),contactDataController:n.T("livechat.conversations.consent.legal.contactDataController"),contactDataProtectionOfficer:n.T("livechat.conversations.consent.legal.contactDataProtectionOfficer"),purposes:n.T("livechat.conversations.consent.legal.purposes"),recipients:n.T("livechat.conversations.consent.legal.recipients"),dataTransfers:n.T("livechat.conversations.consent.legal.dataTransfers"),yourRights:n.T("livechat.conversations.consent.legal.yourRights"),otherInformation:n.T("livechat.conversations.consent.legal.otherInformation")},translations:{contactDataController:c("livechat.conversations.consent.legal.contactDataController"),contactDataProtectionOfficer:c("livechat.conversations.consent.legal.contactDataProtectionOfficer"),purposes:c("livechat.conversations.consent.legal.purposes"),recipients:c("livechat.conversations.consent.legal.recipients"),dataTransfers:c("livechat.conversations.consent.legal.dataTransfers"),yourRights:c("livechat.conversations.consent.legal.yourRights"),otherInformation:c("livechat.conversations.consent.legal.otherInformation")}}),u=s.translations,l=s.fixedTranslations,f=getComputedStyle(document.getElementById("idz_chatbox_top")).backgroundColor,d=getComputedStyle(document.getElementById("idz_freet_client")).color,h=getComputedStyle(document.querySelector("#idz_chatbox_main .bbar.bbar_close")).backgroundImage,p=(0,i.buildLegalInformationPopin)(f,d,h,l,u);(0,r.render)(p,document.getElementById("idzGDPRContainer"),!0)});t.on(e.showChatboxWithAcceptedGDPRWorkflow,function(t,e,r){p(!0);var i=m("visitor"),o=n.T("livechat.conversations.consent.startConversation");n.chat.putVmsg(o,i),u(r)?n.chat.startChat():a()?n.chat.putOpAlert(n.T("SAISIR_UN_MESSAGE"),void 0,""):setTimeout(function(){return n.chat.putOpAlert(n.T("SAISIR_UN_MESSAGE"))},500)});t.on(e.showChatboxWithRefusedGDPRWorkflow,function(){var t=m("visitor"),e=n.T("livechat.conversations.consent.stopConversation"),r=n.T("FIN_DISCUSSION");n.chat.putVmsg(e,t),setTimeout(h,100),setTimeout(function(){return n.chat.putOpAlert(r)},500),setTimeout(function(){return p(!1)},5500),setTimeout(function(){n.$("#idz_dialogbox > *:not(#idz_dialogbox_bottom)").remove()},5550),setTimeout(function(){return n.Templates.hideUI()},5600)});t.on(e.showCallModal,function(e,n,r,i){s(i),t.emit("engagement.callBox.open",e,r)})}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.buildLegalInformationPopin=void 0;var r=a(n(169)),i=a(n(170)),o=n(147);function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){return"<a href="+t+' target="_blank" rel="noopener noreferrer">'+t+"</a>"},c=(0,i.default)(function(t){return(""+t).replace(/(?:\r\n|\r|\n)/g,"<br />")},function(t){return(""+t).replace(/((?:(?:https?):\/\/|www\.)[^\s<]*)/g,s)}),u=function(t){return"idzLegalInformationPopin_"+t};e.buildLegalInformationPopin=function(t,e,n,i,a){var s={"font-size":"17px","font-weight":"600",color:e,"text-align":"center",margin:"0",padding:"10px"},l={"background-color":t,position:"relative"},f={display:"block",height:"20px",width:"20px",position:"absolute",top:"9px",right:"9px",background:n+" no-repeat top left","background-position":"-90px 0"},d=i.explanation,h=d.indexOf("-"),p=d.substr(0,h),m=d.substr(h,d.length).split("-").filter(function(t){return t}),g=function(t,e){return(0,r.default)(e)?null:(0,o.html)("div",{style:{"padding-top":"10px"}},(0,o.html)("div",null,(0,o.html)("b",null,t,": ")),(0,o.html)("p",{dangerouslySetInnerHTML:{__html:c(e)}}))},v=function(){iAdvize.$("#"+u("container")).remove()};return(0,o.html)("div",{id:u("container"),style:{position:"fixed","z-index":"2147483647",height:"100%",width:"100%"}},(0,o.html)("style",{dangerouslySetInnerHTML:{__html:"\n  @media (max-width: 450px) {\n    .idzLegalInformationPopin_popin {\n      height: 100% !important;\n      width: 100% !important;\n      transform: none !important;\n      left: 0 !important;\n      top: 0 !important;\n    }\n\n    .idzLegalInformationPopin_content {\n      max-height: 100% !important;\n    }\n\n    .idzLegalInformationPopin_header {\n      color: white !important;\n    }\n\n    .idzLegalInformationPopin_h1 {\n      color: black !important;\n    }\n\n    .idzLegalInformationPopin_closeA {\n      background: black;\n    }\n  }\n"}}),(0,o.html)("div",{class:u("backdrop"),style:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%","z-index":"1000000004",background:"black",opacity:"0.2",cursor:"pointer"},onClick:v}),(0,o.html)("div",{class:u("popin"),style:{position:"fixed",width:"420px",padding:"0",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1000000004","line-height":"1.3",color:"#34393F",background:"white"}},(0,o.html)("div",{class:u("header"),style:l},(0,o.html)("h1",{style:s,class:u("h1")},i.title),(0,o.html)("a",{class:u("closeA"),style:f,href:"javascript:void(0)",role:"button",title:"",onClick:v})),(0,o.html)("div",{class:u("content"),style:{"max-height":"300px","overflow-y":"auto"}},(0,o.html)("p",{style:{padding:"20px"}},p,(0,o.html)("ul",null,m.map(function(t){return(0,o.html)("li",null,t.trim())}))),(0,o.html)("hr",{style:{margin:"0 auto","text-align":"center",width:"85%","margin-bottom":"30px"}}),(0,o.html)("div",{style:{padding:"0 20px"}},g(i.contactDataController,a.contactDataController),g(i.contactDataProtectionOfficer,a.contactDataProtectionOfficer),g(i.purposes,a.purposes),g(i.recipients,a.recipients),g(i.dataTransfers,a.dataTransfers),g(i.yourRights,a.yourRights),g(i.otherInformation,a.otherInformation)))))}},function(t,e,n){t.exports=function(t,e,r){var i=n(894)(t,e,r);n(895)(t,e,i)}},function(t,e){t.exports=function(t,e,n){var r=t.$;return e.on("call.phone.callOperator",function(e,i){var o=r("#c2cpopin_flag_selector div").attr("rel"),a=void 0!==window.idzCustomData?window.idzCustomData:{};r.each(a,function(t,e){"city_cp"===t?a.city=e:"name_firstname"===t?a.name=e:"extID"===t&&(a.extid=e)});var s={customData:a};n.connection.connect().done(function(){var a={sid:t.website_id,operator:e,vphone:i,u:t.vuid,visitorCountryCode:o,visitorLocale:t.visitor.locale,r:t.flags.proactif_activatedId,dep:t.forceDep,vnick:Strophe.getBareJidFromJid(n.connection.getConnection().jid),lang:t.curlang,forcedLang:t.forcedLang};t.util.addScript("IDZc2cCall",t.chaturl+"rpc/c2c_routing_operator.php?"+r.param(a)+"&"+r.param(s))})}),{initCall:function(e,i){if(!t.ringing){t.activeCall=e,t.ringing=!0;var o=void 0!==window.idzCustomData?window.idzCustomData:{};r.each(o,function(t,e){"city_cp"===t?o.city=e:"name_firstname"===t?o.name=e:"extID"===t&&(o.extid=e)});var a={customData:o},s=t.routing.enabled?"c2c_routing.php":"c2c.php";n.connection.connect().done(function(){var o={sid:t.website_id,oid:t.c2coperator.id,vphone:e,u:t.vuid,visitorCountryCode:i,visitorLocale:t.visitor.locale,r:t.flags.proactif_activatedId,dep:t.forceDep,vnick:Strophe.getBareJidFromJid(n.connection.getConnection().jid),lang:t.curlang,forcedLang:t.forcedLang};t.util.addScript("IDZc2cCall",t.chaturl+"rpc/"+s+"?"+r.param(o)+"&"+r.param(a))})}}}}},function(t,e,n){var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=n(6),o=n(896),a=n(147),s=n(898),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(118));t.exports=function(t,e,u){var l=t.$,f=function(){return{instantOrOffline:{enabled:t.callInstant.enabled||t.callOffline.enabled,available:t.callInstant.available||t.callOffline.available},meeting:r({},t.callMeeting)}},d=function(t,e){return"+"+t.calling_code+e},h=function(t,e){var n=l.Deferred();if(t.number_pattern&&!new RegExp(t.number_pattern).test(e))return n.reject(),n.promise();return parseInt(t.zero_prefixed,10)?(n.resolve(d(t,e.substr(1))),n.promise()):(n.resolve(d(t,e)),n.promise())},p=function(e){var n=(t.customizeTranslate||{})[e]||{};return n[t.curlang]||n.en||""};function m(n,r,i,a,u,f){var d={contactDataController:p("livechat.conversations.consent.legal.contactDataController"),contactDataProtectionOfficer:p("livechat.conversations.consent.legal.contactDataProtectionOfficer"),purposes:p("livechat.conversations.consent.legal.purposes"),recipients:p("livechat.conversations.consent.legal.recipients"),dataTransfers:p("livechat.conversations.consent.legal.dataTransfers"),yourRights:p("livechat.conversations.consent.legal.yourRights"),otherInformation:p("livechat.conversations.consent.legal.otherInformation")},m={title:t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT"),explanation:t.T("livechat.conversations.consent.legal.explanation"),contactDataController:t.T("livechat.conversations.consent.legal.contactDataController"),contactDataProtectionOfficer:t.T("livechat.conversations.consent.legal.contactDataProtectionOfficer"),purposes:t.T("livechat.conversations.consent.legal.purposes"),recipients:t.T("livechat.conversations.consent.legal.recipients"),dataTransfers:t.T("livechat.conversations.consent.legal.dataTransfers"),yourRights:t.T("livechat.conversations.consent.legal.yourRights"),otherInformation:t.T("livechat.conversations.consent.legal.otherInformation"),labelCallboxClose:t.T("livechat.callbox.close.title"),labelCallboxPhoneNumber:t.T("livechat.callbox.phoneNumber.label"),label1:t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT1"),labelError:t.T("UNE_ERREUR_EST_SURVENUE"),labelCallMe:t.T("APPELEZ_MOI"),labelCallVisitorFirst:1===t.preferences.c2c_callvisitorfirst?t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT5"):t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT2"),labelCallBack:t.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT4"),labelInvalidPhoneNumber:t.T("INVALID_PHONE_NUMBER"),tradOu:t.T("callmeeting.button.separator"),tradRendezVous:t.T("callmeeting.button.label"),anErrorOccured:t.T("UNE_ERREUR_EST_SURVENUE"),chooseDateRange:t.T("callmeeting.select_slot_screen.label"),evening:t.T("evening"),morning:t.T("morning"),today:t.T("today"),tomorrow:t.T("tomorrow"),back:t.T("callmeeting.select_slot_screen.button.back"),confirm:t.T("callmeeting.select_slot_screen.button.confirm"),tradOkUnderstand:t.T("callmeeting.confirm_screen.button.confirm.label"),callMeetingConfirmScreen:t.T("callmeeting.confirm_screen.title"),callMeetingTitle:t.T("callmeeting.select_slot_screen.title"),labelGdprCheckbox:t.T("livechat.conversations.consent.textInfo"),labelGdprCheckboxShowMore:t.T("livechat.conversations.consent.moreInfo"),labelGdprCheckboxNotCheckedError:t.T("livechat.conversations.consent.notGivenError"),labelGdprLegalInformationTitle:t.T("livechat.conversations.consent.legal.title")};return t.Templates.loadChatCss(),(0,o.createCallModal)(l,iAdvize.engagement.gdprConsent.enabled,s.state,function(n,r,i,o){o?h(n,r).then(function(r){(0,s.setFormattedPhoneNumber)(r),e.emit(c.callModalSaveConsent,t.vuid,s.state.actionId,{selectedCountry:n,formattedNumber:r,callButtonTypeClicked:i})}).fail(function(){clearTimeout(t.c2cTimeout),v(!0,m.labelInvalidPhoneNumber)}):v(!0,m.labelGdprCheckboxNotCheckedError)},s.setConsent,function(){(0,s.resetState)(),t.ringing=!1},function(){(0,s.setStep)("phoneNumber"),v(!1,f)},function(){S(s.state.formattedPhoneNumber,s.state.phoneNumber,s.state.selectedCountry,s.state.date,s.state.slot)},function(){(0,s.setStep)("chooseDateRange"),v(!1,f)},function(){g()},function(t,e){(0,s.setDate)(t),(0,s.setSlot)(e)},function(t){return(0,s.setPhoneNumber)(t)},function(t){return(0,s.setSelectedCountry)(t)},t.static_url,a,n,r,i,t.timeSlots,m,d,u,f||t.T("INVALID_PHONE_NUMBER"))}var g=function(){return l("#idzc2c").remove()},v=function(e,n){var r=t.call.countries,i=t.visitor.country.toLowerCase(),o=t.curlang;g();var s=m(r,i,o,f(),e,n);(0,a.render)(s,document.body)};e.on("engagement.callBox.close",g),e.on("engagement.callBox.open",function(e,n){(0,s.setActionId)(n),(0,s.setConsent)(e);var r=t.call.countries,o=t.visitor.country.toLowerCase(),c=t.curlang;t.ringing=!1;var u,d,h,p,g,v=m(r,o,c,f());if(t.callMeeting&&t.callMeeting.enabled)return u=function(){return(0,a.render)(v,document.body)},d=t.util.date.formatDate(new Date,"yyyy-mm-dd"),h=t.util.date.formatDate(new Date,"hh:ii"),p=t.chaturl+"channel/call/meeting/"+t.website_id+"/",g={startDate:d,timezone:_.determine().name()},void l.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",url:p,data:g}).done(function(e){t.timeSlots=[],(0,i.forEach)(e.slots,function(e,n){var r=n.substr(0,10),i=r===d?e.filter(function(t){return t.startTime.substr(0,5)>h}):e;t.timeSlots.push({date:{value:r},slots:i})}),"function"==typeof u&&u()});(0,a.render)(v,document.body),t.$(window.idz_btn).hide()}),e.on("engagement.callBox.showBusy",function(t){return v(!0,t)}),e.on("engagement.callBox.showError",function(t){return v(!0,t)}),e.on("engagement.callBox.reset",function(){(0,s.resetState)(),g()}),e.on(c.showCallModalWithAcceptedGDPRWorkflow,function(t){var e=t.selectedCountry,n=t.formattedNumber;"callMeeting"===t.callButtonTypeClicked?(0,s.setStep)("chooseDateRange"):((0,s.setStep)("loader"),u.initCall(n,e.country_code)),v(!1,null)}),e.on(c.showCallModalSaveConsentFailedWorkflow,function(){v(!0,t.T("UNE_ERREUR_EST_SURVENUE"))});var _=n(899),y=e.events,b=function(t,e){t?((0,s.setStep)("callMeetingConfirm"),v(!1,"")):((0,s.setStep)("callMeetingError"),(0,s.setCallMeetingErrorKey)(e||"callmeeting.confirm_screen.error.generic"),v(!1,""))};var S=function(n,r,i,o,a){if(o=o.date,a&&o){for(var s=o.value.substr(0,10),c=a.startDay+" "+a.startTime,u=a.endDay+" "+a.endTime,f=t.flags.proactif_activatedId,d=void 0,h=0;h<t.ProActif._datas.length;++h){var p=t.ProActif._datas[h];if(p.id===f&&p.skill){d=p.skill.id;break}}var m=t.forcedLang?t.forcedLang:t.visitor.locale,g=t.chaturl+"channel/call/meeting/"+t.website_id+"/create/",v={vuid:t.vuid,phoneNumber:n,startDate:c,endDate:u,ruleId:f,skillId:d,timezone:_.determine().name(),visitorLocale:m,visitorCountryCode:i.country_code};l.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",url:g,data:v}).done(function(t){t&&t.success?(e.emit(y.callMeetingConfirmed),b(!0,{day:s,startTime:a.startTime,endTime:a.endTime,phone:r})):b(!1,t.error)}).fail(function(){b(!1)})}}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.createCallModal=void 0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=f(n(172)),o=f(n(74)),a=f(n(169)),s=f(n(5)),c=n(147),u=n(581),l=n(897);function f(t){return t&&t.__esModule?t:{default:t}}e.createCallModal=function(t,e,n,f,d,h,p,m,g,v,_,y,b,S,T,E,C,w,A,O,x,R,I){var N=(0,i.default)(E),M=n.selectedCountry||(0,o.default)(E,C,(0,o.default)(E,w,N[0])),P=(0,c.html)("img",{src:""+S+M.icon_path}),D=(0,c.html)("div",{class:"flag flag_"+M.country_code,rel:M.country_code,style:{background:"none"}},P);b(M);var k=function(t){var e=t.icon_path,n=t.country_code;(0,u.setClassTosreactComponent)(D,"flag flag_"+n),D.render().setAttribute("rel",n),P.render().src=""+S+e,b(t)},j=(0,c.html)("ul",null,N.map(function(t){return function(t,e,n){var r=e.icon_path,i=e.country_code,o=e.calling_code;return(0,c.html)("li",{id:i,onClick:function(){return n(e)}},(0,c.html)("img",{class:i,src:""+t+r}),"+",o)}(S,t,k)})),U=(0,c.html)("input",{type:"text",name:"c2c_phone",class:"c2cpopin_phone",id:"c2cpopin_phone",value:n.phoneNumber,"aria-label":O.labelCallboxPhoneNumber}),z=U.render();z.addEventListener("blur",function(t){return y(t.target.value)}),z.addEventListener("keyup",function(t){return y(t.target.value)});var L=function(t,e){return(0,a.default)(e)?null:(0,c.html)("div",{style:{"padding-top":"10px"}},(0,c.html)("div",null,(0,c.html)("b",null,t,": ")),(0,c.html)("p",{dangerouslySetInnerHTML:{__html:(n=e,(""+n).replace(/(?:\r\n|\r|\n)/g,"<br />"))}}));var n},B=O.explanation,F=B.indexOf("-"),H=B.substr(0,F),q=B.substr(F,B.length).split("-").filter(function(t){return t}),G=(0,c.html)("div",{style:{display:"none","max-height":"220px","overflow-y":"auto"}},(0,c.html)("hr",null),(0,c.html)("div",{style:{"max-height":"220px","overflow-y":"auto"}},(0,c.html)("h1",{style:{"text-align":"center"}},O.labelGdprLegalInformationTitle)),(0,c.html)("div",{style:{}},(0,c.html)("p",{style:{padding:"20px"}},H,(0,c.html)("ul",null,q.map(function(t){return(0,c.html)("li",null,t.trim())}))),(0,c.html)("hr",{style:{margin:"0 auto","text-align":"center",width:"85%","margin-bottom":"30px"}}),(0,c.html)("div",{style:{padding:"0 20px"}},L(O.contactDataController,x.contactDataController),L(O.contactDataProtectionOfficer,x.contactDataProtectionOfficer),L(O.purposes,x.purposes),L(O.recipients,x.recipients),L(O.dataTransfers,x.dataTransfers),L(O.yourRights,x.yourRights),L(O.otherInformation,x.otherInformation)))),V={"margin-right":"10px",display:"inline","font-weight":"normal"},Y=n.hasConsent?(0,c.html)("input",{type:"checkbox",id:"idzGdprCallCheckbox",style:V,name:"idzGdprCallCheckbox",checked:!0}):(0,c.html)("input",{type:"checkbox",id:"idzGdprCallCheckbox",style:V,name:"idzGdprCallCheckbox"});Y.render().addEventListener("change",function(e){d(e.target.checked),t("#idzCallBoxCallInstantButton").css(K(n.hasConsent)),t("#idzCallBoxCallMeetingButton").css(K(n.hasConsent))});var W,$,J=function(t){f(n.selectedCountry,n.phoneNumber,t,n.hasConsent||!e)},X=(0,c.html)("div",{style:{padding:"10px 20px"}},Y,(0,c.html)("label",{for:"idzGdprCallCheckbox"},O.labelGdprCheckbox,(0,c.html)("a",{href:"javascript:void(0)",style:{color:"#0099FF"},onClick:function(){(0,u.showsreactComponent)(G)}}," ",O.labelGdprCheckboxShowMore))),K=function(t){return{opacity:t?"1":"0.3",cursor:t?"pointer":"not-allowed"}},Q=(0,c.html)("div",{id:"c2cpopin_step1",class:(0,s.default)({call_meeting:T.meeting.enabled,c2cpopin_error:R}),style:{display:"phoneNumber"===n.step?"block":"none"}},(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_auto c2cpopin_m_t"},O.label1),(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_error c2cpopin_m_t",role:"status"},I),(0,c.html)("div",{class:"c2cpopin_selecnum"},(0,c.html)("div",{class:(0,s.default)("c2cpopin_selectphone",{instantAndMeeting:T.meeting.available&&T.instantOrOffline.available})},(0,c.html)("div",{class:"c2cpopin_flag"},(0,c.html)("div",{id:"c2cpopin_flag_selector",onClick:function(e){t("#c2cpopin_flag_list").show(),e.stopPropagation()}},D),(0,c.html)("div",{id:"c2cpopin_flag_list",style:{display:"none"}},j)),U,(0,c.html)("div",{class:"idz_clearer"})),(0,c.html)("div",{class:"idz_clearer"}),e&&X,(0,c.html)("div",{class:"idz_clearer"}),(0,c.html)("div",{class:"c2cpopin_call",onClick:function(){return J("callInstant")},style:{display:T.instantOrOffline.enabled&&T.instantOrOffline.available?"block":"none"}},(0,c.html)("a",{id:"idzCallBoxCallInstantButton",href:"javascript:void(0)",class:"btn_med_green btn_med_green_phone",style:K(n.hasConsent)},(0,c.html)("span",null),O.labelCallMe)),T.meeting.available?(0,c.html)(c.Fragment,null,T.instantOrOffline.enabled&&T.instantOrOffline.available?(0,c.html)("span",{class:"c2cpopin_or"},O.tradOu):null,(0,c.html)("div",{class:"c2cpopin_callMeeting",onClick:function(){return J("callMeeting")}},(0,c.html)("a",{id:"idzCallBoxCallMeetingButton",href:"javascript:void(0)",class:"btn_med_green btn_med_green_phone",style:K(n.hasConsent)},(0,c.html)("span",null),O.tradRendezVous))):null,(0,c.html)("div",{class:"idz_clearer"}),e&&G)),Z=(0,c.html)("div",{id:"c2cpopin_step2",class:"c2cpopin_error",style:{display:"loader"===n.step?"block":"none"}},R?(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_error c2cpopin_m_t",role:"status"},I):(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_loading",role:"status"},(0,c.html)("div",{class:"c2cpopin_label_phone"}),O.labelCallVisitorFirst)),tt=(0,c.html)("div",{id:"c2cpopin_step3",class:"c2cpopin_error",style:{display:3===n.step?"block":"none"}},(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_valid"},O.labelCallBack)),et=(0,c.html)("div",{class:"c2cpopin_backToDefault",onClick:p},(0,c.html)("a",{href:"javascript:void(0)",class:"btn_med_green "},(0,c.html)("span",null),O.back)),nt=(0,c.html)("div",{class:"c2cpopin_confirmTimeSlot",onClick:function(){return m(n.date,n.slot)}},(0,c.html)("a",{href:"javascript:void(0)",class:"btn_med_green "},(0,c.html)("span",null),O.confirm)),rt=(0,c.html)("div",null),it=(0,c.html)("div",{style:{display:"chooseDateRange"===n.step?"block":"none"}},(W=O.chooseDateRange,$=O.anErrorOccured,(0,c.html)(c.Fragment,null,(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_auto c2cpopin_m_t"},W),(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_error c2cpopin_m_t",role:"status"},$))),(0,l.dayPicker)(A,iAdvize.T("callmeeting.select_slot_screen.date_slot_selector.place_holder.default"),function(t){(0,c.render)((0,l.timePicker)(t,iAdvize.T("callmeeting.select_slot_screen.time_slot_selector.place_holder"),function(e){_(t,e),(0,u.addClassTosreactComponent)(nt,"enabled")}),rt.render(),!0)}),rt,(0,c.html)("div",{id:"c2cButtons"},et,nt)),ot=null;if("callMeetingConfirm"===n.step){var at=n.date.date.value.substr(0,10),st=parseInt(at.substr(0,4),10),ct=parseInt(at.substr(5,2),10)-1,ut=parseInt(at.substr(8,2),10),lt=new Date(st,ct,ut),ft=iAdvize.T("callmeeting.confirm_screen.label").split(/%\d/g).filter(function(t){return t}),dt=r(ft,4),ht=dt[0],pt=dt[1],mt=dt[2],gt=dt[3],vt=(0,c.html)("div",null,ht,(0,c.html)("b",null,iAdvize.util.date.formatDate(lt,"Dd* d* Mm*")),pt,(0,c.html)("b",null,n.slot.startTime.substr(0,5),mt,n.slot.endTime.substr(0,5)),gt,n.phoneNumber);ot=(0,c.html)("div",{style:{display:"callMeetingConfirm"===n.step?"block":"none"}},(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_auto c2cpopin_m_t"},vt),(0,c.html)("div",{id:"c2cButtons"},(0,c.html)("div",{class:"c2cpopin_backToSlotSelection",onClick:g},(0,c.html)("a",{href:"javascript:void(0)",class:"btn_med_green"},(0,c.html)("span",null),O.back)),(0,c.html)("div",{class:"c2cpopin_confirmUnderStand",onClick:v},(0,c.html)("a",{href:"javascript:void(0)",class:"btn_med_green"},(0,c.html)("span",null),O.tradOkUnderstand))))}var _t=(0,c.html)("div",{style:{display:"callMeetingError"===n.step?"block":"none"}},(0,c.html)("div",{class:"c2cpopin_label c2cpopin_label_error c2cpopin_m_t",style:{display:"block"}},iAdvize.T(n.callMeetingErrorKey)),(0,c.html)("div",{id:"c2cButtons"},(0,c.html)("div",{class:"c2cpopin_backToSlotSelection",onClick:g},(0,c.html)("a",{href:"javascript:void(0)",class:"btn_med_green"},(0,c.html)("span",null),O.back)),(0,c.html)("div",{class:"c2cpopin_confirmUnderStand",onClick:v},(0,c.html)("a",{href:"javascript:void(0)",class:"btn_med_green"},(0,c.html)("span",null),O.tradOkUnderstand)))),yt=function(){switch(n.step){case"chooseDateRange":return O.callMeetingTitle;case"callMeetingConfirm":case"callMeetingError":return O.callMeetingConfirmScreen;default:return O.title}}();return(0,c.html)("div",{id:"idzc2c",onClick:function(){t("#c2cpopin_flag_list").hide()}},(0,c.html)("div",{id:"c2coverlay",style:{height:"100%"}}),(0,c.html)("div",{id:"c2cpopin",class:"chooseDateRange"===n.step||"callMeetingConfirm"===n.step||"callMeetingError"===n.step?"call_meeting":"",role:"dialog","aria-labelledby":"c2cpopin_title","aria-modal":"true"},(0,c.html)("div",{id:"c2cpopin_inner"},(0,c.html)("a",{id:"c2cpopin_close",href:"javascript:void(0)",onClick:function(){t("#idzc2c").remove(),h()},title:O.labelCallboxClose}),(0,c.html)("div",{class:"c2cpopin_title",id:"c2cpopin_title"},yt),(0,c.html)("div",{class:"c2cpopin_ctn"},(0,c.html)("div",{class:"c2cpopin_ctn_inner"},Q,Z,tt,it,ot,_t)))))}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.timePicker=e.dayPicker=void 0;var r=n(147),i=n(581),o=function(t){var e=parseInt(t.substr(0,4),10),n=parseInt(t.substr(5,2),10)-1,r=parseInt(t.substr(8,2),10),i=new Date(e,n,r),o=parseInt(window.iAdvize.util.date.formatDate(i,"yyyymmdd"),10)-parseInt(window.iAdvize.util.date.formatDate(new Date,"yyyymmdd"),10);return 0===o?iAdvize.T("today"):1===o?iAdvize.T("tomorrow"):window.iAdvize.util.date.formatDate(i,"Ddd. dd/mm")},a=function(t){return{date:t.date.value,timeRangeList:(t.slots||[]).reduce(function(t,e){var n=e.endTime.replace(":","").substr(0,4),r=e.startTime.replace(":","").substr(0,4),i=parseInt(r,10),o=parseInt(n,10);return t.morning=t.morning||i<1200,t.afternoon=t.afternoon||i<1800&&o>1200,t.evening=t.evening||o>1800,t},{morning:!1,afternoon:!1,evening:!1})}},s=function(t,e,n,i,o,a,s){return(0,r.html)("div",{class:"option",onClick:s},(0,r.html)("div",{class:"col1"},t),(0,r.html)("div",{class:"col2"},(0,r.html)("div",null,e),(0,r.html)("div",{class:"dateTimeSlot morning "+i}),(0,r.html)("div",{class:"dateTimeSlot "+o}),(0,r.html)("div",{class:"dateTimeSlot evening "+a}),(0,r.html)("div",null,n)))},c=(e.dayPicker=function(t,e,n){var c,u={isOpen:!1,value:null},l=(0,r.html)("div",{class:"list",style:{display:"none"}},function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return t.map(function(t){var n=a(t),r=n.date,i=n.timeRangeList;return s(o(r),iAdvize.T("morning"),iAdvize.T("evening"),i.morning?"available":"",i.afternoon?"available":"",i.evening?"available":"",function(){return e(t)})})}(t,function(t){m(),u.value=t;var e=a(t),i=e.date,c=e.timeRangeList,l=s(o(i),iAdvize.T("morning"),iAdvize.T("evening"),c.morning?"available":"",c.afternoon?"available":"",c.evening?"available":"",function(){});(0,r.render)(l,h.render(),!0),n(u.value)})),f=(0,r.html)("div",{class:"arrowDown"}),d=(0,r.html)("input",{name:"dateSlot",class:"dropDownValue",type:"hidden",value:""}),h=(0,r.html)("div",{class:"placeHolder"},(0,r.html)("span",null,e)),p=void 0,m=function(){if((0,i.removeClassTosreactComponent)(f,"arrowDown"),(0,i.removeClassTosreactComponent)(f,"arrowUp"),u.isOpen=!u.isOpen,u.isOpen)(0,i.addClassTosreactComponent)(f,"arrowUp"),(0,i.showsreactComponent)(l),(0,i.addClassTosreactComponent)(p,"open"),(0,r.render)((0,r.html)("span",null,e),h.render(),!0);else if((0,i.addClassTosreactComponent)(f,"arrowDown"),(0,i.hidesreactComponent)(l),(0,i.removeClassTosreactComponent)(p,"open"),u.value){var t=a(u.value),n=t.date,c=t.timeRangeList,d=s(o(n),iAdvize.T("morning"),iAdvize.T("evening"),c.morning?"available":"",c.afternoon?"available":"",c.evening?"available":"",function(){});(0,r.render)(d,h.render(),!0)}};return c=(0,r.html)("div",{class:"display",onClick:m},h,(0,r.html)("div",{class:"arrow"},f)),p=(0,r.html)("div",{id:"js-c2cDateSlot",class:"dropDown"},d,c,l)},function(t,e){return(0,r.html)("div",{class:"option",onClick:e},(0,r.html)("span",null,t))});e.timePicker=function(t,e,n){var o,a={isOpen:!1,value:null},s=(0,r.html)("div",{class:"list",style:{display:"none"}},function(t,e){return t.slots.map(function(t){return c(iAdvize.T("callmeeting.select_slot_screen.time_slot_selector.list.label").replace("%1",t.startTime.substr(0,5)).replace("%2",t.endTime.substr(0,5)),function(){return e(t)})})}(t,function(t){h(),a.value=t;var e=c(iAdvize.T("callmeeting.select_slot_screen.time_slot_selector.list.label").replace("%1",a.value.startTime.substr(0,5)).replace("%2",a.value.endTime.substr(0,5)));(0,r.render)(e,f.render(),!0),n(a.value)})),u=(0,r.html)("div",{class:"arrowDown"}),l=(0,r.html)("input",{name:"timeSlot",class:"dropDownValue",type:"hidden",value:""}),f=(0,r.html)("div",{class:"placeHolder"},(0,r.html)("span",null,e)),d=void 0,h=function(){if((0,i.removeClassTosreactComponent)(u,"arrowDown"),(0,i.removeClassTosreactComponent)(u,"arrowUp"),a.isOpen=!a.isOpen,a.isOpen)(0,i.addClassTosreactComponent)(u,"arrowUp"),(0,i.showsreactComponent)(s),(0,i.addClassTosreactComponent)(d,"open"),(0,r.render)((0,r.html)("span",null,e),f.render(),!0);else if((0,i.addClassTosreactComponent)(u,"arrowDown"),(0,i.hidesreactComponent)(s),(0,i.removeClassTosreactComponent)(d,"open"),a.value){var t=c(iAdvize.T("callmeeting.select_slot_screen.time_slot_selector.list.label").replace("%1",a.value.startTime.substr(0,5)).replace("%2",a.value.endTime.substr(0,5)));(0,r.render)(t,f.render(),!0)}};return o=(0,r.html)("div",{class:"display",onClick:h},f,(0,r.html)("div",{class:"arrow"},u)),d=(0,r.html)("div",{id:"js-c2cTimeSlot",class:"dropDown"},l,o,s)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r={actionId:null,selectedCountry:null,phoneNumber:"",step:"phoneNumber",hasConsent:!1,date:null,slot:null,formattedPhoneNumber:"",callMeetingErrorKey:""},i=e.state=n({},r);e.setActionId=function(t){i.actionId=t},e.setSelectedCountry=function(t){i.selectedCountry=n({},t)},e.setPhoneNumber=function(t){i.phoneNumber=t},e.setFormattedPhoneNumber=function(t){i.formattedPhoneNumber=t},e.setStep=function(t){i.step=t},e.setConsent=function(t){i.hasConsent=t},e.setDate=function(t){i.date=t},e.setSlot=function(t){i.slot=t},e.setCallMeetingErrorKey=function(t){i.callMeetingErrorKey=t},e.resetState=function(){e.state=i=n({},r)}},function(t,e,n){t.exports=n(900)},function(t,e,n){var r,i;(i=function(){"use strict";var t={DAY:864e5,HOUR:36e5,MINUTE:6e4,SECOND:1e3,BASELINE_YEAR:2014,MAX_SCORE:864e6,AMBIGUITIES:{"America/Denver":["America/Mazatlan"],"Europe/London":["Africa/Casablanca"],"America/Chicago":["America/Mexico_City"],"America/Asuncion":["America/Campo_Grande","America/Santiago"],"America/Montevideo":["America/Sao_Paulo","America/Santiago"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Europe/Helsinki","Asia/Damascus","Africa/Cairo","Asia/Gaza","Europe/Minsk"],"Pacific/Auckland":["Pacific/Fiji"],"America/Los_Angeles":["America/Santa_Isabel"],"America/New_York":["America/Havana"],"America/Halifax":["America/Goose_Bay"],"America/Godthab":["America/Miquelon"],"Asia/Dubai":["Asia/Yerevan"],"Asia/Jakarta":["Asia/Krasnoyarsk"],"Asia/Shanghai":["Asia/Irkutsk","Australia/Perth"],"Australia/Sydney":["Australia/Lord_Howe"],"Asia/Tokyo":["Asia/Yakutsk"],"Asia/Dhaka":["Asia/Omsk"],"Asia/Baku":["Asia/Yerevan"],"Australia/Brisbane":["Asia/Vladivostok"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Majuro":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk","Europe/Moscow"],"Asia/Karachi":["Asia/Yekaterinburg"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]}},e=function(t){var e=-t.getTimezoneOffset();return null!==e?e:0},n=function(t){for(var e=new Date(t,0,1,0,0,1,0).getTime(),n=new Date(t,12,31,23,59,59).getTime(),i=e,o=new Date(i).getTimezoneOffset(),a=null,s=null;i<n-864e5;){var c=new Date(i),u=c.getTimezoneOffset();u!==o&&(u<o&&(a=c),u>o&&(s=c),o=u),i+=864e5}return!(!a||!s)&&{s:r(a).getTime(),e:r(s).getTime()}},r=function e(n,r,i){void 0===r&&(r=t.DAY,i=t.HOUR);for(var o=new Date(n.getTime()-r).getTime(),a=n.getTime()+r,s=new Date(o).getTimezoneOffset(),c=o,u=null;c<a-i;){var l=new Date(c);if(l.getTimezoneOffset()!==s){u=l;break}c+=i}return r===t.DAY?e(u,t.HOUR,t.MINUTE):r===t.HOUR?e(u,t.MINUTE,t.SECOND):u},o=function(e){var r=function(){for(var t=[],e=0;e<i.olson.dst_rules.years.length;e++){var r=n(i.olson.dst_rules.years[e]);t.push(r)}return t}();return function(t){for(var e=0;e<t.length;e++)if(!1!==t[e])return!0;return!1}(r)?function(e,n){for(var r=function(r){for(var i=0,o=0;o<e.length;o++)if(r.rules[o]&&e[o]){if(!(e[o].s>=r.rules[o].s&&e[o].e<=r.rules[o].e)){i="N/A";break}if(i=0,i+=Math.abs(e[o].s-r.rules[o].s),(i+=Math.abs(r.rules[o].e-e[o].e))>t.MAX_SCORE){i="N/A";break}}return i=function(t,e,n,r){if("N/A"!==n)return n;if("Asia/Beirut"===e){if("Africa/Cairo"===r.name&&13983768e5===t[6].s&&14116788e5===t[6].e)return 0;if("Asia/Jerusalem"===r.name&&13959648e5===t[6].s&&14118588e5===t[6].e)return 0}else if("America/Santiago"===e){if("America/Asuncion"===r.name&&14124816e5===t[6].s&&1397358e6===t[6].e)return 0;if("America/Campo_Grande"===r.name&&14136912e5===t[6].s&&13925196e5===t[6].e)return 0}else if("America/Montevideo"===e){if("America/Sao_Paulo"===r.name&&14136876e5===t[6].s&&1392516e6===t[6].e)return 0}else if("Pacific/Auckland"===e&&"Pacific/Fiji"===r.name&&14142456e5===t[6].s&&13961016e5===t[6].e)return 0;return n}(e,n,i,r)},o={},a=i.olson.dst_rules.zones,s=a.length,c=t.AMBIGUITIES[n],u=0;u<s;u++){var l=a[u],f=r(a[u]);"N/A"!==f&&(o[l.name]=f)}for(var d in o)if(o.hasOwnProperty(d))for(var h=0;h<c.length;h++)if(c[h]===d)return d;return n}(r,e):e};return{determine:function(){var n,r,a,s=function(){var t,e;if("undefined"!=typeof Intl&&void 0!==Intl.DateTimeFormat&&void 0!==(t=Intl.DateTimeFormat())&&void 0!==t.resolvedOptions)return(e=t.resolvedOptions().timeZone)&&(e.indexOf("/")>-1||"UTC"===e)?e:void 0}();return s||(s=i.olson.timezones[(n=e(new Date(t.BASELINE_YEAR,0,2)),r=e(new Date(t.BASELINE_YEAR,5,2)),a=n-r,a<0?n+",1":a>0?r+",1,s":n+",0")],void 0!==t.AMBIGUITIES[s]&&(s=o(s))),{name:function(){return s}}}}}()).olson=i.olson||{},i.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-660,1,s":"Pacific/Apia","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Asuncion","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Majuro","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},i.olson.dst_rules={years:[2008,2009,2010,2011,2012,2013,2014],zones:[{name:"Africa/Cairo",rules:[{e:12199572e5,s:12090744e5},{e:1250802e6,s:1240524e6},{e:12858804e5,s:12840696e5},!1,!1,!1,{e:14116788e5,s:1406844e6}]},{name:"Africa/Casablanca",rules:[{e:12202236e5,s:12122784e5},{e:12508092e5,s:12438144e5},{e:1281222e6,s:12727584e5},{e:13120668e5,s:13017888e5},{e:13489704e5,s:1345428e6},{e:13828392e5,s:13761e8},{e:14142888e5,s:14069448e5}]},{name:"America/Asuncion",rules:[{e:12050316e5,s:12243888e5},{e:12364812e5,s:12558384e5},{e:12709548e5,s:12860784e5},{e:13024044e5,s:1317528e6},{e:1333854e6,s:13495824e5},{e:1364094e6,s:1381032e6},{e:13955436e5,s:14124816e5}]},{name:"America/Campo_Grande",rules:[{e:12032172e5,s:12243888e5},{e:12346668e5,s:12558384e5},{e:12667212e5,s:1287288e6},{e:12981708e5,s:13187376e5},{e:13302252e5,s:1350792e6},{e:136107e7,s:13822416e5},{e:13925196e5,s:14136912e5}]},{name:"America/Goose_Bay",rules:[{e:122559486e4,s:120503526e4},{e:125704446e4,s:123648486e4},{e:128909886e4,s:126853926e4},{e:13205556e5,s:129998886e4},{e:13520052e5,s:13314456e5},{e:13834548e5,s:13628952e5},{e:14149044e5,s:13943448e5}]},{name:"America/Havana",rules:[{e:12249972e5,s:12056436e5},{e:12564468e5,s:12364884e5},{e:12885012e5,s:12685428e5},{e:13211604e5,s:13005972e5},{e:13520052e5,s:13332564e5},{e:13834548e5,s:13628916e5},{e:14149044e5,s:13943412e5}]},{name:"America/Mazatlan",rules:[{e:1225008e6,s:12074724e5},{e:12564576e5,s:1238922e6},{e:1288512e6,s:12703716e5},{e:13199616e5,s:13018212e5},{e:13514112e5,s:13332708e5},{e:13828608e5,s:13653252e5},{e:14143104e5,s:13967748e5}]},{name:"America/Mexico_City",rules:[{e:12250044e5,s:12074688e5},{e:1256454e6,s:12389184e5},{e:12885084e5,s:1270368e6},{e:1319958e6,s:13018176e5},{e:13514076e5,s:13332672e5},{e:13828572e5,s:13653216e5},{e:14143068e5,s:13967712e5}]},{name:"America/Miquelon",rules:[{e:12255984e5,s:12050388e5},{e:1257048e6,s:12364884e5},{e:12891024e5,s:12685428e5},{e:1320552e6,s:12999924e5},{e:13520016e5,s:1331442e6},{e:13834512e5,s:13628916e5},{e:14149008e5,s:13943412e5}]},{name:"America/Santa_Isabel",rules:[{e:12250116e5,s:1207476e6},{e:12564612e5,s:12389256e5},{e:12885156e5,s:12703752e5},{e:13199652e5,s:13018248e5},{e:13514148e5,s:13332744e5},{e:13828644e5,s:13653288e5},{e:1414314e6,s:13967784e5}]},{name:"America/Santiago",rules:[{e:1206846e6,s:1223784e6},{e:1237086e6,s:12552336e5},{e:127035e7,s:12866832e5},{e:13048236e5,s:13138992e5},{e:13356684e5,s:13465584e5},{e:1367118e6,s:13786128e5},{e:13985676e5,s:14100624e5}]},{name:"America/Sao_Paulo",rules:[{e:12032136e5,s:12243852e5},{e:12346632e5,s:12558348e5},{e:12667176e5,s:12872844e5},{e:12981672e5,s:1318734e6},{e:13302216e5,s:13507884e5},{e:13610664e5,s:1382238e6},{e:1392516e6,s:14136876e5}]},{name:"Asia/Amman",rules:[{e:1225404e6,s:12066552e5},{e:12568536e5,s:12381048e5},{e:12883032e5,s:12695544e5},{e:13197528e5,s:13016088e5},!1,!1,{e:14147064e5,s:13959576e5}]},{name:"Asia/Damascus",rules:[{e:12254868e5,s:120726e7},{e:125685e7,s:12381048e5},{e:12882996e5,s:12701592e5},{e:13197492e5,s:13016088e5},{e:13511988e5,s:13330584e5},{e:13826484e5,s:1364508e6},{e:14147028e5,s:13959576e5}]},{name:"Asia/Dubai",rules:[!1,!1,!1,!1,!1,!1,!1]},{name:"Asia/Gaza",rules:[{e:12199572e5,s:12066552e5},{e:12520152e5,s:12381048e5},{e:1281474e6,s:126964086e4},{e:1312146e6,s:130160886e4},{e:13481784e5,s:13330584e5},{e:13802292e5,s:1364508e6},{e:1414098e6,s:13959576e5}]},{name:"Asia/Irkutsk",rules:[{e:12249576e5,s:12068136e5},{e:12564072e5,s:12382632e5},{e:12884616e5,s:12697128e5},!1,!1,!1,!1]},{name:"Asia/Jerusalem",rules:[{e:12231612e5,s:12066624e5},{e:1254006e6,s:1238112e6},{e:1284246e6,s:12695616e5},{e:131751e7,s:1301616e6},{e:13483548e5,s:13330656e5},{e:13828284e5,s:13645152e5},{e:1414278e6,s:13959648e5}]},{name:"Asia/Kamchatka",rules:[{e:12249432e5,s:12067992e5},{e:12563928e5,s:12382488e5},{e:12884508e5,s:12696984e5},!1,!1,!1,!1]},{name:"Asia/Krasnoyarsk",rules:[{e:12249612e5,s:12068172e5},{e:12564108e5,s:12382668e5},{e:12884652e5,s:12697164e5},!1,!1,!1,!1]},{name:"Asia/Omsk",rules:[{e:12249648e5,s:12068208e5},{e:12564144e5,s:12382704e5},{e:12884688e5,s:126972e7},!1,!1,!1,!1]},{name:"Asia/Vladivostok",rules:[{e:12249504e5,s:12068064e5},{e:12564e8,s:1238256e6},{e:12884544e5,s:12697056e5},!1,!1,!1,!1]},{name:"Asia/Yakutsk",rules:[{e:1224954e6,s:120681e7},{e:12564036e5,s:12382596e5},{e:1288458e6,s:12697092e5},!1,!1,!1,!1]},{name:"Asia/Yekaterinburg",rules:[{e:12249684e5,s:12068244e5},{e:1256418e6,s:1238274e6},{e:12884724e5,s:12697236e5},!1,!1,!1,!1]},{name:"Asia/Yerevan",rules:[{e:1224972e6,s:1206828e6},{e:12564216e5,s:12382776e5},{e:1288476e6,s:12697272e5},{e:13199256e5,s:13011768e5},!1,!1,!1]},{name:"Australia/Lord_Howe",rules:[{e:12074076e5,s:12231342e5},{e:12388572e5,s:12545838e5},{e:12703068e5,s:12860334e5},{e:13017564e5,s:1317483e6},{e:1333206e6,s:13495374e5},{e:13652604e5,s:1380987e6},{e:139671e7,s:14124366e5}]},{name:"Australia/Perth",rules:[{e:12068136e5,s:12249576e5},!1,!1,!1,!1,!1,!1]},{name:"Europe/Helsinki",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]},{name:"Europe/Minsk",rules:[{e:12249792e5,s:12068352e5},{e:12564288e5,s:12382848e5},{e:12884832e5,s:12697344e5},!1,!1,!1,!1]},{name:"Europe/Moscow",rules:[{e:12249756e5,s:12068316e5},{e:12564252e5,s:12382812e5},{e:12884796e5,s:12697308e5},!1,!1,!1,!1]},{name:"Pacific/Apia",rules:[!1,!1,!1,{e:13017528e5,s:13168728e5},{e:13332024e5,s:13489272e5},{e:13652568e5,s:13803768e5},{e:13967064e5,s:14118264e5}]},{name:"Pacific/Fiji",rules:[!1,!1,{e:12696984e5,s:12878424e5},{e:13271544e5,s:1319292e6},{e:1358604e6,s:13507416e5},{e:139005e7,s:1382796e6},{e:14215032e5,s:14148504e5}]},{name:"Europe/London",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]}]},void 0!==t.exports?t.exports=i:null!==n(901)&&null!=n(432)?void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r):window.jstz=i},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=c(n(433)),a=c(n(903)),s=n(146);function c(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}!function(t,e){var c=function(){return t.chat.status===a.CHATTING},u=n(576)(t),l=u.isAsyncChatEnabled,f=u.isChatboxV2Enabled,d=u.isHistoryv2Enabled;if(!iAdvize.lock){var h=n(6),p=n(567)(t.$,t.chaturl,t.vuid,t.website_id,d()),m=t.require("xmpp"),g=t.require("logger"),v=t.require("eventManager"),_=v.events,y=t.require("emojis-service"),b=e.Deferred(),S=b.promise();b.resolve();var T,E=function(){return t.chat.status===a.CHATTING_BUT_VISITOR_CLOSED_THE_CHATBOX&&0===Number(t.flags.operator_closed)&&1===Number(t.flags.visitor_closed)};v.on(_.OnXmppRoomJoined,function(){m.sendChatState("paused")}),v.on(_.OnXmppConnectionDisconnected,function(){!function(){"use strict";!0!==e("#idz_postmsg").prop("disabled")&&(e("#idz_postmsg").prop("disabled",!0),e(".idz_writting").html(t.T("livechat.xmpp.connection.disconnected")),I())}()}),v.on(_.OnXmppReconnectionFailed,function(){!function(){"use strict";e(".idz_writting").html(""),t.chat.putOpAlert(t.T("CONNECTION_ERREUR")),I()}()}),v.on(_.OnXmppConnectionConnected,function(){!function(){"use strict";e("#idz_postmsg").prop("disabled",!1),e(".idz_writting").html(""),t.chat.disableLoading(),f()&&(t.orchestrator.removeThreadNotification("chatbox.notifications.connection.problem"),t.orchestrator.enableComposeZone())}()}),1==t.preferences.mirroring_enabled&&(T=t.require("mirror"))&&T.listen&&T.listen(v,{translations:{stopCobrowsing:t.T("livechat.conversations.mirroring.stopCobrowsing")}}),t.visio.enabled&&t.require("visio"),t.define("emitter",function(){function t(t){var e=[];function n(){for(var n=-1,r=e.length;++n<r;)e[n].apply(this,arguments);return t}return n.on=function(n){return e.push(n),t},n}return function(){for(var e=-1,n=arguments.length,r={};++e<n;)r[arguments[e]]=t(r);return r.on=function(t,e){return r[t].on(e)},r}}),t.noDefaultScrollTemplate="iphone"==t.customize.layout||"mobile"==t.customize.layout||"tablette"==t.customize.layout||"chomette"==t.customize.layout||"monoprix2"==t.customize.layout||"interflora-uk"==t.customize.layout||"natixis-caissedepargne-espaceclient"==t.customize.layout||"nexecur"==t.customize.layout||"vvf"==t.customize.layout||"sfr3"==t.customize.layout||"boursorama3"==t.customize.layout||"fortuneo2"==t.customize.layout||"mecatechnic2"==t.customize.layout||"mecatechnic3"==t.customize.layout||"carglass"==t.customize.layout||"autosphere2"==t.customize.layout||"nordnet2"==t.customize.layout||"flowercampings"==t.customize.layout||"neckermannreisen"==t.customize.layout||"dermacenter"==t.customize.layout||"cdiscountv4"==t.customize.layout||"groupalia"==t.customize.layout||"entega2"==t.customize.layout;var C=function(){return t.noOfferPanelTemplate=t.Templates.isResponsive,t.noOfferPanelTemplate};t.initSession=!1;var w=function(t,e){return t&&e?t.toLowerCase()===e.toLowerCase():t===e},A=function(){if(1!==t.chat.satisfaction){if(t.chat.status===a.CHATTING||E()){if(t.Templates.disableVisitorClosingConfirmation||window.confirm(t.T("VISITOR_CONFIRM_CLOSE"))){t.flags.visio_status&&v.emit(_.OnConversationVisioClosed);var e=t.flags.visio_status&&1==t.preferences.param_visio_satisfaction||!t.flags.visio_status&&1==t.preferences.param_satisfaction;-1!==t.operator.id&&1!==t.virtualOP&&e&&2!==t.chat.satisfaction&&t.chat.status===a.CHATTING&&!t.blocked?(t.chat.satisfaction=1,v.emit(_.OnDisplaySurveyForm),t.callbacks.onSatisfactionDisplayed()):t.Templates.hideUI(),t.chat.sendChatClose(),t.callbacks.onChatEnded({id:t.chat.history_id,endedBy:"visitor"})}}else t.Templates.hideUI();t.chatbox_state=t.chat.CHATBOX_STATES.CHATBAR_HIDDEN,l()&&v.emit(_.OnAsyncConversationClosed)}else t.Templates.removeSatisfaction(),l()&&v.emit(_.OnAsyncConversationClosed)};t.playSound=function(n){var r='<embed src="'+t.chaturl+"sounds/swf.php?s="+t.website_id+"&q="+n+'" width="1" height="1" quality="high" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash">';e("#idz_sound_container").html(r)},t.onCoreLoaded=function(n){return t.coreloaded?("function"==typeof n&&n(),!1):(t.coreloaded=!0,e(document).keypress(function(t){27==t.keyCode&&t.preventDefault()}),t.hasFocus=1,t.blinktm=null,t.oTitle=document.title,e(window).bind("scroll.activity",function(){t.onActivity()}),e(window.document).bind("keypress.activity",function(){t.onActivity()}),e("body").bind("mousemove.activity",function(){t.onActivity()}),e(window).focus(function(){t.hasFocus=1,null!==t.blinktm&&(clearInterval(t.blinktm),t.blinktm=null,document.title=t.oTitle)}),e(window).blur(function(){t.hasFocus=0,t.vStats.activeSince=null}),t.onChatLoaded(n),!0)},t.onChatLoaded=function(n){var r=!1;if(!t.chatloaded){t.chatloaded=!0,t.proactif_timeElapsed=t.flags.proactif_timeElapsed,t.proactif_activated=t.flags.proactif_activated,t.conversationJid=t.flags.conversationJid,t.callbacks.onScriptLoaded(),t.chat.bindWidgetEvents();var i=E();t.chat.history_id>0&&(t.chat.status===a.CHATTING||i)&&(v.on(_.OnXmppConnectionConnected,function(){m.room.join(t.conversationJid,t.vuid)}),m.connect(!0).fail(t.chat.showConnectionError));try{t.Templates&&t.Templates.restoreState&&t.Templates.restoreState(),(t.chat.history_id>0||t.chat.prev_history>0)&&(r=!0,t.chat.reloadHistory(function(){n()})),t.chat.status===a.CHATTING&&"1"===t.flags.visio_status&&v.emit(_.OnConversationVisioRequestedBeforeBundle),t.chat.status===a.CHATTING&&null!==t.operator.id&&v.on(_.OnXmppRoomJoined,function(){v.emit(_.OnEventVisitorProfileRequested,{from:t.operator.barejid})}),e.each(["hideUI","hideDialog","minimizeChatbar"],function(e,n){var r=t.Templates[n];t.Templates[n]=function(){r.apply(t.Templates),t.callbacks.onChatHidden()}})}catch(e){t.errorMailer("onChatLoaded try to connect: ",e,"")}}"function"!=typeof n||r||n()};t.routing.enabled?t.transfer=function(e){l()||t.chat.putOpAlert(t.T("OPERATEUR_TRANSFER")),e.pseudo=e.pseudo.replace(/_/g," "),t.operator=e,t.c2coperator=t.operator,f()&&t.orchestrator.setCurrentOperator((0,s.getAuthorFromLegacyOperator)(t.operator)),!0===t.operator.isExpert&&t.chat.putOpAlert(t.chat.getExpertDisclaimer()),t.callbacks.onVisitorTransferred({operatorId:t.operator.id,historyId:t.chat.history_id})}:t.transfer=function(n){var r=e.parseJSON(n);t.chat.putOpAlert(t.T("OPERATEUR_TRANSFER")),r.operator.pseudo=r.operator.pseudo.replace(/_/g," "),t.operator=r.operator,t.c2coperator=t.operator,f()&&t.orchestrator.setCurrentOperator((0,s.getAuthorFromLegacyOperator)(t.operator)),t.chat.history_id=r.newConversationID,t.vStats.history_id=r.newConversationID,!0===t.operator.isExpert&&t.chat.putOpAlert(t.chat.getExpertDisclaimer());var i=j();e("#idz_button_print").attr("href",t.chaturl+"gethistory.php?id="+r.newConversationID+"&u="+t.vuid),e("#idz_button_mail").attr("href",t.chaturl+"gethistory_mail.php?id="+r.newConversationID+"&u="+t.vuid+"&timezoneAbbr="+i),t.chat.sendPresence("available"),t.callbacks.onVisitorTransferred({operatorId:t.operator.id,historyId:t.chat.history_id})},t.createConversation=function(n,r,i,o,s){if(t.initSession)return e.Deferred().reject().promise();t.initSession=!0;var c=t.JSONStore.save({custProfile:t.Store.get("custProfile")||"",email:t.Store.get("custEmail")||""}),u={sid:t.website_id,vuid:t.vuid,dep:t.forceDep,lang:t.curlang,r:t.flags.proactif_activatedId||0,nick:Strophe.getNodeFromJid(m.getConnection().jid),msg:r?encodeURIComponent(r):"",messageId:s,op:t.operator.id||0,o:t.forceAgent?t.forceAgent:0,h:t.forceAgent&&t.vStats.merpHash?t.vStats.merpHash:"",br:t.vStats.browserInfo||""};if(void 0!==window.idzCustomData&&(idzCustomData.page_type&&(u.pt=encodeURIComponent(idzCustomData.page_type)),idzCustomData.brand&&(u.pb=encodeURIComponent(idzCustomData.brand)),idzCustomData.rayon&&(u.pr=encodeURIComponent(idzCustomData.rayon)),idzCustomData.univers&&(u.pu=encodeURIComponent(idzCustomData.univers)),idzCustomData.cust_name&&(u.pcna=encodeURIComponent(idzCustomData.cust_name)),idzCustomData.cust_firstname&&(u.pcfn=encodeURIComponent(idzCustomData.cust_firstname)),idzCustomData.cust_address&&(u.pcad=encodeURIComponent(idzCustomData.cust_address)),idzCustomData.cust_city&&(u.pcci=encodeURIComponent(idzCustomData.cust_city)),idzCustomData.cust_zipcode&&(u.pczc=encodeURIComponent(idzCustomData.cust_zipcode)),idzCustomData.cust_country&&(u.pcco=encodeURIComponent(idzCustomData.cust_country)),idzCustomData.cust_phonenumber&&(u.pcpn=encodeURIComponent(idzCustomData.cust_phonenumber)),idzCustomData.cust_email&&(u.pcem=encodeURIComponent(idzCustomData.cust_email))),"visio"===n||"1"===t.flags.visio_status)return e.getJSON(t.chaturl+"rpc/visio.php",u).then(O);u.cd=window.idzCustomData||[],u.h&&(t.routing.enabled=!1);var l=t.routing.enabled?"init_routing.php":"init_session.php";return(S=c.then(function(){return e.getJSON(t.chaturl+"rpc/"+l+"?lang="+t.curlang+"&log_uuid="+i+"&callback=?",u)})).then(function(n){return t.routing.enabled?function(n,r,i){t.urgentErrorMailer("livechat.routing",{vuid:t.vuid,routing:n},""),m.invitation.setFirstMessageId(i);var o=n.status,s=e.Deferred();if(t.opOffline=o.opOffline,t.c2cOffline=o.c2cOffline,t.opWatching=o.opWatching,t.opBusy=o.opBusy,t.initSession=!1,!o.opOffline){t.chat.history_id=n.chatId,t.vStats.history_id=n.chatId,t.chat.status=a.CHATTING,t.conversationJid=n.conversationJid,m.room.join(t.conversationJid,t.vuid,10).done(function(){r&&m.room.groupchat(r,i),s.resolve()},function(){return t.errorMailer("xmpp room join while routing: ",{conversationJid:t.conversationJid,vuid:t.vuid},""),s.reject()}),setTimeout(function(){m.getConnection().connected&&t.chat.sendPresence("dnd")},2500);var c=j();e("#idz_button_print").attr("href",t.chaturl+"gethistory.php?id="+n.chatId+"&u="+t.vuid),e("#idz_button_mail").attr("href",t.chaturl+"gethistory_mail.php?id="+n.chatId+"&u="+t.vuid+"&timezoneAbbr="+c),v.emit("conversation.chat.started",n.chatId)}return(o.opOffline||o.opBusy)&&s.reject(),s.promise()}(n,r,s):P(n)})};var O=function(e){t.initSession=!1,t.flags.conversationKey=e.conversationKey,t.flags.visio_status=e.visio_status,t.conversationJid=e.conversationJid,t.chat.history_id=e.historyId,t.chat.status=a.CHATTING,t.c2vOffline=t.opOffline=0};t.doInit=function(){t.chat.status!=a.CHATTING?t.chat.sendPresence("available"):t.chat.sendPresence("dnd"),t.chat.connected=!0};var x=[],R=[];t.chat=i({},t.chat,{MESSAGE_TYPES:{OPERATOR:1,VISITOR:2,OPERATOR_ALERT:3,VISITOR_ALERT:4,VISITOR_NAVIGATION:5,OPERATOR_RICH_CONTENT:6,VISITOR_RICH_CONTENT:7},CHATBOX_STATES:o,chatbox_state:o.HIDDEN,composing:0,watch:0,connected:!1,reconnecting:!1,started:!1,offercount:1,automatedStartMessageId:555,automatedEndMessageId:777,buildChat:function(){try{if(t.chatbuilt)return;t.chatbuilt=!0,t.Templates.loadChatCss(),v.emit("events.chatBuilt")}catch(t){}try{t.Templates.appendChat();var r=document.createElement("div");r.setAttribute("id","idz_sound_container"),e("body").append(r);var i=t.Templates.append2header();""!=i&&e("head").append(i)}catch(e){t.errorMailer("buildChat 2: ",e,"")}try{var o=t.T("BESOIN_AIDE"),a=t.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA"),s="message";if(t.customize["chatbar_txt1_"+t.curlang]&&0!=t.customize["chatbar_txt1_"+t.curlang].length&&(o=t.customize["chatbar_txt1_"+t.curlang]),t.customize["chatbar_txt2_"+t.curlang]&&0!=t.customize["chatbar_txt2_"+t.curlang].length){a=t.customize["chatbar_txt2_"+t.curlang];s="message_edit"}var c=t.Templates.getChatContent().replace(/\{CHATBAR_TXT1\}/g,o).replace(/\{CHATBAR_TXT2\}/g,a).replace(/\{CHATBAR_TITLE\}/g,s);e("#idz_chatglobal").html(c),e("body").append('<div id="idzGDPRContainer"></div>'),""!=(i=t.Templates.append2body())&&e("body").append(i),t.Templates.loadLayout()}catch(e){t.errorMailer("buildChat 3: ",e,"")}try{t.chat.loadLayout()}catch(e){t.errorMailer("buildChat 4: ",e,"")}e("#idz_dialogbox").on("scroll",function(t){0===t.target.scrollTop&&v.emit("chatbox.scrolledTop")}),d()&&n(904)(t.$,t.T,t.Templates,this,v,p,f(),l())()},addCobrowsingImg:function(){e("body").append("<img src='https://static.iadvize.com/images/livechat/anim_clic.gif' id='anim_clic' width='163px' height='161px' style='position: absolute; z-index: 999999999998; top: -3000px; left: -3000px;' />"),e("body").append("<img src='https://static.iadvize.com/images/livechat/op_cursor.png' id='visitor_cursor' width='70px' height='70px' style='position: absolute; z-index: 999999999999; top: -3000px; left: -3000px;' />")},loadLayout:function(){1==t.chat.cobrowsing&&t.chat.addCobrowsingImg(),f()&&(t.orchestrator.onCobrowsingAccepted(function(){N()}),t.orchestrator.onCobrowsingRefused(function(){M()})),t.chat.bindSendMessage(),t.chat.bindChatStatesEvents(),e("#idz_chatbox_main").on("click","#idz_button_font_pos, .idz_button_font_pos",function(){var n=1.1*parseFloat(e("#idz_dialogbox").css("font-size"));return n<=21&&(e("#idz_dialogbox").css({"font-size":n+"px"}),t.chat.sendCommand(t.operator.barejid,"!textsize "+n)),!1}),e("#idz_chatbox_main").on("click","#idz_button_font_neg, .idz_button_font_neg",function(){var n=.9*parseFloat(e("#idz_dialogbox").css("font-size"));return n>=10&&(e("#idz_dialogbox").css({"font-size":n+"px"}),t.chat.sendCommand(t.operator.barejid,"!textsize "+n)),!1}),e("#idz_button_close, .idz_button_close").click(function(){if(v.emit("conversation.closed"),t.chat.status===a.CHATTING){var e=Strophe.getBareJidFromJid(m.getConnection().jid);m.getConnection().send($msg({to:e,from:e,type:"chat",website:t.website_id}).c("body").t("!magic_event disabled"))}return(t.Templates.closeDialog||A)(),!1}),e("#idz_button_hide, .idz_button_hide").click(function(){return e("#idz_chatbox").hasClass("idz_chatbox_hide")?(t.Templates.showDialog(),t.chat.sendAlert("!chatshow",t.T("VISITEUR_CHATBOX_OPEN")),t.chatbox_state=t.chat.CHATBOX_STATES.OPENED):(t.Templates.hideDialog(),t.chat.sendAlert("!chathide",t.T("VISITOR_CHATBOX_MINIMIZE")),t.chatbox_state=t.chat.CHATBOX_STATES.MINIMIZED),t.JSONStore.save({chat_status:t.chat.status,chatbox_state:t.chatbox_state}),!1}),setTimeout(function(){t.customize["chatbar_txt2_"+t.curlang]&&0==t.customize["chatbar_txt2_"+t.curlang].length&&e("#idz_msgmsg").width()<=370&&e("#idz_msgmsg").val(t.T("POSER_VOTRE_QUESTION_ICI"))},500),e("#idz_button_mail, .idz_button_mail").click(function(){var n=e("#idz_dialogbox div.idz_msg_visitor").last().size(),r=e("#idz_dialogbox div.idz_msg_operator").last().size();if(!(n>0||r>0))return e("#idz_button_print").attr("target","_self"),t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("CHAT_VIDE_ACTION_IMPOSSIBLE")).replace(/\{TIME\}/g,t.chat.getMsgTime())),e("#idz_dialogbox div.idz_msg_alert_op").last().addClass("idz_noaction"),!1;var i=window.prompt(t.T("EMAIL_PROMPT"),"");if(""===i||null===i)return!1;var o=t.chat.history_id;0==t.chat.history_id&&(o=t.chat.prev_history);var a=j();e("#idz_button_mail").attr("href",t.chaturl+"gethistory_mail.php?id="+o+"&to="+encodeURIComponent(i)+"&u="+t.vuid+"&timezoneAbbr="+a),e("#mailFrame").length&&e("#mailFrame").remove(),e("body").append("<iframe id='mailFrame' name='mailFrame' style='width:0px; height:0px; border: 0px'></iframe>")}),e("#idz_button_print, .idz_button_print").click(function(){var n=e("#idz_dialogbox div.idz_msg_visitor").last().size(),r=e("#idz_dialogbox div.idz_msg_operator").last().size();return n>0||r>0?(e("#idz_button_print").attr("target","_blank"),!0):(e("#idz_button_print").attr("target","_self"),t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("CHAT_VIDE_ACTION_IMPOSSIBLE")).replace(/\{TIME\}/g,t.chat.getMsgTime())),e("#idz_dialogbox div.idz_msg_alert_op").last().addClass("idz_noaction"),!1)}),e(".idz_slide_link_close a").click(function(t){t.preventDefault(),e(t.currentTarget).parents(".idz_slide").toggle()}),e("#idz_button_private").click(function(t){t.preventDefault(),e("#idz_chatbox_private").toggle()}),e(".idz_toggle").click(function(n){var r=e(n.currentTarget).find(".idz_toggle_button"),i=r.siblings("input"),o=i.val();r.toggleClass("idz_toggle_on"),r.toggleClass("idz_toggle_off"),1==o?(i.val(0),r.animate({"background-position-x":"-11px"},200)):(i.val(1),r.animate({"background-position-x":"-49px"},200));var a=i.val();t.JSONStore.saveData({visitorDeleteDataEnabled:a}),"1"===a?t.chat.sendAlert("!datadeletionenabled"):t.chat.sendAlert("!datadeletiondisabled")}),1==t.flags.visitorDeleteDataEnabled&&e(".idz_toggle").trigger("click"),setTimeout(function(){t.Templates.minimizeChatbarHide()},1e3),e("#idz_chatbar_minifier, .idz_chatbar_minifier").click(function(){return t.chat.sendAlert("!chatmini",t.T("VISITEUR_CHATBAR_MINIMIZE")),t.Templates.minimizeChatbar(),!1}),e("#idz_chatbar_mini, .idz_chatbar_mini").click(function(){return t.chat.sendAlert("!chatmaxi",t.T("VISITEUR_CHATBAR_OPEN")),t.Templates.maximizeChatbar(),e(this).hide(),!1}),e("#idz_chatbar").on("click",".idz_upload_trigger",function(t){t.stopPropagation(),t.preventDefault(),e(this).find("input").click()}),e("#idz_chatbar").on("change",".idz_upload_trigger input",function(t){v.emit(_.OnConversationChatFileSelected,t),t.preventDefault(),t.stopPropagation(),e(this).val("")}).on("click",".idz_upload_trigger input",function(t){t.stopPropagation()}),e("#idz_dialogbox").on("click",".idz_upload_abort",function(t){v.emit(_.OnConversationChatUploadAborted,e(this).parents(".idz_upload").data("id")),t.preventDefault(),t.stopPropagation()})},outframeChat:function(){e("body").append("<style>#idz_chatglobal, #idz_chatbar_mini {visibility:hidden;left:-9999px}</style>")},loadInvitation:function(e){if(!t.invitLoaded&&(t.Templates.loadChatCss(),t.invitLoaded=!0,1!==t.chat.composing)){t.callbacks.onInvitationDisplayed({id:e}),t.Templates.hideDialog();var n=t.chaturl+"invitation.php?id="+e+"&t="+t.customize.layout+"&sid="+t.website_id+"&lang="+t.curlang;iAdvize.loadScripts([{url:n}])}},butMessage:!1,onClickChatWidget:function(){this.butMessage||(t.chat.status!=a.CHATTING&&t.chat.putOpAlert(t.T("SAISIR_UN_MESSAGE")),this.butMessage=!0),t.Templates.showDialog()},bindWidgetEvents:function(){try{e(".idz_widget")&&e(".idz_widget").length&&e("#operator_status_textarea")&&e("#operator_status_textarea").length&&(e(".idz_widget").click(function(){return 0==t.opOffline&&""!==e("#operator_status_textarea").val()&&(e("#idz_msgmsg").val(e("#operator_status_textarea").val()),e("#operator_status_textarea").val(""),e("#idz_postmsg").click()),!1}),e("#operator_status_textarea").focus(function(){e("#operator_status_textarea").val()==t.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA")&&(e("#operator_status_textarea").val(""),e("#operator_status_textarea").removeAttr("style"))}))}catch(t){}try{e("#operator_status_textarea")&&e("#operator_status_textarea").length&&e("#operator_status_textarea").keyup(function(t){13==t.which&&(e("#idz_msgmsg").val(e("#operator_status_textarea").val()),e("#operator_status_textarea").val(""),e("#idz_postmsg").click())})}catch(t){}e(".idz_c2vwidget").length&&e(".idz_c2vwidget").click(function(){return v.emit(_.OnConversationVisioRequestedBeforeBundle),!1})},showC2cBusyMessage:function(t){v.emit("engagement.callBox.showBusy",t)},showC2cError:function(t){v.emit("engagement.callBox.showError",t)},closeC2cPopin:function(){v.emit("engagement.callBox.close")},bindChatStatesEvents:function(){var n=function(e){t.operator.barejid&&(m.sendChatState(e),"composing"===e?(t.chat.composing=1,t.callbacks.onVisitorWriting()):(t.chat.composing=0,t.callbacks.onVisitorStopWriting()))};v.on("onVisitorStartedTyping",function(){return n("composing")}),v.on("onVisitorStoppedTyping",function(){return n("paused")}),v.on("onMessageSubmitted",function(){return n("paused")}),e("#idz_msgmsg").focusout(function(){n("paused")}).focusin(function(){n("active")}).keydown(function(e){13===e.which?n("active"):0===t.chat.composing&&n("composing")}).keyup(function(){!e(this).val().trim()&&t.chat.composing&&n("active")}),e("#idz_msgmsg").keydown(function(t){if(!t.ctrlKey||13!==t.keyCode&&10!==t.keyCode){if(13===t.which)return t.preventDefault(),void e("#idz_postmsg").click()}else{var n=e(this).val()+" \n";e(this).val(n)}})},handleSatisfactionSurvey:function(n){var r=parseInt(e("#idzq1").attr("rel"),10)+1+"|";r=(r=r+(parseInt(e("#idzq2").attr("rel"),10)+1)+"|")+(parseInt(e("#idzq3").attr("rel"),10)+1)+"|",n===t.T("VOTRE_COMMENTAIRE_LIBRE")&&(n=""),r+=n;var i=t.chat.history_id||t.chat.prev_history;t.util.addScript("satisfaction",t.chaturl+"rpc/satisfaction.php?save="+t.website_id+"&u="+t.vuid+"&hid="+i+"&data="+encodeURIComponent(r)),t.chat.sendAlert("!satisfaction completed",t.T("SATISFACTION_REPONDU")),t.Templates.removeSatisfaction(),v.emit(_.OnAsyncConversationClosed),e("#idz_msgmsg").val("").change(),t.chat.composing=0,t.callbacks.onSatisfactionAnswered()},startChat:function(){var e=function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}();v.emit(_.OnConversationStarted,e),t.chat.enableLoading(),m.connect().fail(t.chat.showConnectionError).then(function(){return t.createConversation("chat",null,e,null,null)}).done(function(t){D()}).fail(function(){t.chat.showUnavailableMessage(),t.chat.disableLoading(),v.emit(_.OnConversationStartedFailed,e)})},sendMessage:function(n){if(!e(this).prop("disabled")){try{n=y.replaceShortnameToUtf8("apple",n);var r=e("#idz_msgmsg").css("left"),i=e("#idz_msgmsg").css("top");if(1===t.chat.satisfaction&&!f())return void this.handleSatisfactionSurvey(n);if(""===n||n===t.T("POSER_VOTRE_QUESTION_ICI")||n===t.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA")||n===t.customize["chatbar_txt2_"+t.curlang])return void setTimeout(function(){e("#idz_msgmsg").css({left:parseInt(r,10)+"px",top:parseInt(i,10)+"px"})},1030);if(e("#idz_msgmsg").val("").change(),t.blocked||!n)return;var o=m.connect(!0).fail(t.chat.showConnectionError);if(!c()&&f()||l()&&!c()&&!(t.chat.status===a.CHATTING_BUT_VISITOR_CLOSED_THE_CHATBOX)||!l()&&!t.operator.barejid&&1!==t.chat.satisfaction){var u=function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}(),d=m.getConnection().getUniqueId();if(v.emit(_.OnConversationStarted,u),f())try{var h=(0,s.toRfcFirstConversationMessage)(n,d,t.vuid);iAdvize.orchestrator.receiveMessage(h)}catch(t){}t.chat.enableLoading(),o.then(function(){var e="1"===t.flags.visio_status?"visio":"chat";return t.createConversation(e,n,u,null,d)}).then(function(){if(t.routing.enabled){var e=t.$.Deferred();return t.operator.barejid||(t.operator.barejid="i_will_be_back"),e.resolve(d),e.promise()}return m.room.groupchat(n,d),t.util.retry(4,t.chat.onSendFirstMessage,t.chat,[n,d])}).done(function(e){if(D(),t.chat.putVmsg(n,e,u),f())for(;R.length>0;){var r=R.shift();t.chat.onSendMessage(r.message,r.id)}}).fail(function(){t.chat.put_dialog(t.chat.getVmsg(t.util.nl2br(t.util.htmlspecialchars(n)))),t.chat.showUnavailableMessage(),t.chat.disableLoading(),v.emit(_.OnConversationStartedFailed,u),f()&&R.push({id:d,message:n})})}else o.done(function(){t.chat.onSendMessage(n)})}catch(e){t.errorMailer("sendMessage: ",e,"")}return!1}},bindSendMessage:function(){var n=this;e("#idz_postmsg").on("click",function(){var t=e("#idz_msgmsg").get(0).value;n.sendMessage(t)}),f()&&t.orchestrator.onMessageSubmitted(function(t){n.sendMessage(t.payload.message)})},enableLoading:function(){e("#idz_msgmsg").attr("disabled","disabled"),e(".idz_loading").show()},disableLoading:function(){e("#idz_msgmsg").attr("disabled",!1),e(".idz_loading").hide()},showUnavailableMessage:function(){t.chat.putOpMsg(null,t.autoAnswer,0,1),t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&t.orchestrator.notifyWaitingIsListFull(),t.chat.status=a.NOT_CHATTING,t.operator={}},sendProactifAlert:function(){v.emit(_.OnEventEngagementRuleTriggered)},onSendFirstMessage:function(n,r){var i=e.Deferred();return t.chat.dialogCount(),t.Templates.showDialog(),t.routing.enabled?i.resolve(messageId):m.invitation.sendEngage(r,n,t.conversationJid,t.operator.barejid,t.website_id,t.chat.history_id).then(function(t){i.resolve(t)},i.reject),setTimeout(i.reject,4e3),t.proactif_now=0,i.promise()},onSendMessage:function(e,n){var r;if("1"===t.preferences.bankcard_number_hidden&&(e="string"!=typeof(r=e)?r:r.replace(/\b(3[47]\d{2}([ -]?)(?!(\d)\3{5}|123456|234567|345678)\d{6}\2(?!(\d)\4{4})\d{5}|((4\d|5[1-5]|65)\d{2}|6011)([ -]?)(?!(\d)\8{3}|1234|3456|5678)\d{4}\7(?!(\d)\9{3})\d{4}\7\d{4})\b/g,"xxxx-xxxx-xxxx-xxxx")),e){t.Templates.showDialog();var i=n||m.getConnection().getUniqueId();t.chat.sendXmppMessage(e,i).fail(function(){}),t.chat.putVmsg(e,i),t.proactif_now=0}},dialogCount:function(){t.flags.proactif_activatedId&&!t.flags.proactif_dialogIsCounted&&(t.flags.proactif_dialogIsCounted=!0,setTimeout(function(){t.util.addScript("proactifDialogcount",t.chaturl+"rpc/proactif_dialogCount.php?inc="+t.flags.proactif_activatedId+"&sid="+t.website_id+"&u="+t.vuid+"&hid="+t.chat.history_id)},1650))},updateHistory:function(e,n,r,i){if(n&&n!==t.T("livechat.conversations.consent.startConversation")&&n!==t.T("livechat.conversations.consent.stopConversation")){r=r||0;var s=t&&t.vStats?t.vStats.browserInfo+" | "+t.vStats.country:"";i||(i=""),t.util.addScript("IDZhistory",t.chaturl+"rpc/chat_history.php?sid="+t.website_id+"&update="+t.chat.history_id+"&u="+t.vuid+"&oid="+t.operator.id+"&data="+encodeURIComponent(n)+"&type="+e+"&id="+r+"&nick="+Strophe.getNodeFromJid(m.getConnection().jid)+"&userData="+s+"&log_uuid="+i),"VISITOR_CHAT_CLOSE"!==n&&(t.chat.status=a.CHATTING,iAdvize.Templates.shouldNotOpenChatboxOnNewMessage&&t.chatbox_state==o.MINIMIZED||(t.chatbox_state=o.OPENED),t.JSONStore.save({chat_status:t.chat.status,chatbox_state:t.chatbox_state}))}},reloadHistory:function(e){t.chat.buildChat(),t.chat.history_id?(v.emit("chatbox.historyLoaded",t.chat.history_id),p.getConversationHistoryById(t.chat.history_id).then(function(n){var r=n.messages;t.chat.prepare_history2(r),e()})):e(),l()&&t.chat.putOpAlert(t.T("SAISIR_UN_MESSAGE"),void 0,"")},convertLinks:function(t,e){var n="";e&&(n="target=_blank ");return function(t){return t.replace(/((ftp|https?):\/\/([-\w\.]+)+(:\d+)?(\/([\w\/_\.\(\)\-,\#\~\%\=\+&;:]*(\?\S+)?)?)?)/gm,"<a "+n+'rel="nofollow" href="$1">$1</a>')}(function(t){return t.replace(/mailto:(.*?)($|\ )/gm,'<a href="mailto:$1">$1</a>')}(t))},getVmsg:function(e,n){var r=null!=n?n:t.chat.getMsgTime();return e=t.chat.convertLinks(e,!0),e=y.replaceAliasesToShortname(e),e=y.replaceUtf8ToShortname("apple",e),e=y.replaceShortnameToImage("apple",e),t.Templates.vMsg.replace(/\{MSG\}/g,e).replace(/\{TIME\}/g,r)},putVmsg:function(e,n,r){n=n||0;var i=t.util.nl2br(t.util.htmlspecialchars(e));t.chat.put_dialog(t.chat.getVmsg(i),n),v.emit("conversation.message.sent",t.chat.getVmsg(i)),e=y.replaceShortnameToUtf8("apple",e),t.chat.updateHistory(t.chat.MESSAGE_TYPES.VISITOR,e,n,r),t.chat.disableLoading(),t.Templates.showDialog(),t.Templates.maximizeChatbar(),t.callbacks.onVisitorStopWriting(),t.callbacks.onMessageSent({time:t.chat.getMsgTime(),msg:i})},getOpAlert:function(e,n){var r=null!=n?n:t.chat.getMsgTime();return e=(e=t.util.nl2br(t.util.htmlspecialchars(e))).replace(/&lt;br \/&gt;/gi,"<br/>").replace(/&lt;br\/&gt;/gi,"<br/>").replace(/&lt;br&gt;/gi,"<br/>"),t.Templates.opAlert.replace(/\{MSG\}/g,e).replace(/\{TIME\}/g,r)},putOpAlert:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;iAdvize.Templates.shouldNotOpenChatboxOnNewMessage||l()||(t.Templates.showDialog(),t.Templates.maximizeChatbar()),t.chat.put_dialog(t.chat.getOpAlert(e,r)),n&&1===n&&t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR_ALERT,e),t.callbacks.onAlertReceived({time:t.chat.getMsgTime(),msg:e})},getOperatorAvatarUrl:function(){var e=t.static_url+"images/livechat/blank.gif";return t.operator.avatar&&(e=t.operator.avatar),e},getOpMsg:function(n,r,i){var o=null!=r?r:t.chat.getMsgTime(),a=i?i.pictureUrl:t.chat.getOperatorAvatarUrl(),s="",c="";if(t.operator.pseudo){c=i?i.nickName:t.operator.pseudo,s=t.util.htmlspecialchars(i?i.nickName:t.operator.pseudo);var u="";t.operator.isExpert&&(u=" "+iAdvize.T("SEE_MORE")),s=s+'<span class="idz_colonspace">'+u+"</span> : "}-1===n.indexOf(t.autoAnswer)&&(n=-1===n.indexOf(t.website_url)?t.chat.convertLinks(n,!0):t.chat.convertLinks(n,!1)),n=n.replace(/&lt;br \/&gt;/gi,"<br/>").replace(/&lt;br\/&gt;/gi,"<br/>").replace(/&lt;br&gt;/gi,"<br/>"),n=y.replaceUtf8ToImage("apple",n);var l=t.Templates.opMsg.replace(/\{PSEUDO\}/g,s).replace(/\{PSEUDO_RAW\}/g,c).replace(/\{AVATAR\}/g,a).replace(/\{MSG\}/g,n).replace(/\{TIME\}/g,o);if(t.operator.direct_phone&&""!=t.operator.direct_phone&&0===t.phoneDisplayed){t.phoneDisplayed=1;var f=t.Templates.opMsgFooter.replace(/\{PHONE_PRICE\}/g,t.operator.phone_facturation).replace(/\{PHONE_NUMBER\}/g,t.operator.direct_phone);l=l.replace(/\{FOOTER\}/g,f)}else l=l.replace(/\{FOOTER\}/g,"");t.operator.id&&(v.emit("events.operatorMessageSent",t.operator),l=e(l).attr("data-operatorid",t.operator.id)[0].outerHTML);return l},tagAutomatedMessages:function(e,n){n==t.chat.automatedStartMessageId&&e.find(".idz_msgtext:last, .idz_msgtime:last").addClass("idz_automatedMessage idz_automatedStartMessage"),n==t.chat.automatedEndMessageId&&e.find(".idz_msgtext:last, .idz_msgtime:last").addClass("idz_automatedMessage idz_automatedEndMessage")},putOpFile:function(n,r){e('.idz_upload[data-id="'+n+'"]').remove(),r.find("img").on("load",function(){t.Templates.scrollChatBoxDialog()}),t.Templates.showDialog(),t.Templates.maximizeChatbar(),t.chat.put_dialog(r),t.Templates.scrollChatBoxDialog()},putOpProduct:function(e,n){n.find("img").on("load",function(){t.Templates.scrollChatBoxDialog()}),t.Templates.showDialog(),t.Templates.maximizeChatbar(),t.chat.put_dialog(n),t.Templates.scrollChatBoxDialog()},putOpMessageWithMultipleChoices:function(n,r,i,o){o?o.append(r):(t.Templates.showDialog(),t.Templates.maximizeChatbar(),e("#idz_dialogbox #idz_dialogbox_bottom").before(r),t.Templates.scrollChatBoxDialog()),r.find(".idz_choice_button").on("click",function(n){n.preventDefault();var r=e(this),o=r.parents("#hist_container").length>0,a=o&&e("#hist_container").is(":nth-last-child(2)"),s=r.parents(".idz_msg_operator").is(":nth-last-child(2)");if(a||!o&&s){if(i){var c=function(t){for(var e=t,n=e.parentNode.children,r=n.length-1;r>=0;r--)if(e===n[r])return r}(n.target);i[c](n.target.innerText)}else t.chat.onSendMessage(n.target.innerText);e(n.target).addClass("idz_choice_button_selected")}else r.off(n)})},putOpMsg:function(n,r,i,o){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s="";if(s=o?t.util.nl2br(r):t.util.nl2br(t.util.htmlspecialchars(r)),!k(n)){iAdvize.Templates.shouldNotOpenChatboxOnNewMessage||(t.Templates.showDialog(),t.Templates.maximizeChatbar());var c=t.chat.getOpMsg(s);t.chat.put_dialog(c,!1,a),v.emit("conversation.message.received",c),v.emit("events.operatorMessageAppended",t.operator),null!=n&&e("#idz_dialogbox").find(".idz_msgtext:last").attr({id:n}),t.chat.tagAutomatedMessages(e("#idz_dialogbox"),n),1===i?t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR,r,n):2===i&&setTimeout(function(){t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR,r,n)},2200),t.callbacks.onMessageReceived({time:t.chat.getMsgTime(),msg:r})}},onCommand:function(n){if(f())try{if("chat"===n.type){var i=(0,s.toRfcCommand)(n);i&&iAdvize.orchestrator.receiveMessage(i)}if("groupchat"===n.type){var o=(0,s.toRfcMessage)(n);iAdvize.orchestrator.receiveMessage(o)}}catch(t){}var c=n.body,u=n.from,l=n.barejid,d=n.getCommand(),h=function(){var e=t.operator.barejid;return null===e||w(e,l)},p=d.name,g=d.param1;if("routing_operator_found"===p){var y=function(){if(t.operator.id&&t.routing.enabled)t.transfer(E);else{if(t.routing.enabled&&!t.activeCall&&(0===t.chat.history_id||0===t.vStats.history_id||!t.conversationJid))return t.errorMailer("Routing operator found with invalid states",new Error("invalid routing states"),"",{historyId:t.chat.history_id,vStatsHistoryId:t.vStats.history_id,jid:t.conversationJid,profile:E,operator:t.operator}),t.chat.putOpMsg(null,t.T("AN_ERROR_OCCURED_PLEASE_RETRY"),0,1),void t.chat.disableLoading();t.operator=E,"call"!==E.channel&&v.emit(_.OnEventVisitorProfileRequested,{from:E.barejid}),f()&&t.orchestrator.setCurrentOperator((0,s.getAuthorFromLegacyOperator)(t.operator)),!0===t.operator.isExpert&&t.chat.putOpAlert(t.chat.getExpertDisclaimer()),t.activeCall&&"call"===E.channel.toString()?(v.emit(_.OnConversationCallRoutingCompleted,{operatorProfile:E}),v.emit("call.phone.callOperator",E.barejid,t.activeCall)):(t.routing.enabled||m.invitation.sendEngage(null,E.message,t.conversationJid,t.operator.barejid,t.website_id,t.chat.history_id),v.emit(_.OnConversationChatRoutingCompleted,{operatorProfile:E}),v.emit("events.chatBuilt",null))}},b=c.substr(c.indexOf(" ")+1),E=JSON.parse(b);switch(E.channel){case"chat":S.then(y);break;case"call":y();break;case"visio":v.emit(_.OnConversationVisioRoutingCompleted,E)}}"windowsize"===p&&t.chat.sendCommand(u,"!windowsize "+e(window).width()+"|"+e(window).height());var C=null;switch(p){case"vprofile":C=_.OnEventVisitorProfileRequested;break;case"customdata":C=_.OnEventCustomDataRequested;break;case"visio":"refused"===g?C=_.OnConversationVisioRefused:"timeout"===g?C=_.OnConversationVisioTimeout:"close"===g&&(C=_.OnConversationVisioClose);break;case"push":case"links":h()&&(C=_.OnEventLinkSent);break;case"offers":case"pushoffer":h()&&(C=_.OnEventOfferSent);break;case"blockme":C=_.OnEventVisitorBlocked;break;case"closedialog":h()&&(C=_.OnEventConversationClosed);break;case"ackEngage":C=_.OnEventEngageReceived}if(C&&v.emit(C,n),"nomoreslot"===p||"routing_operator_not_found"===p){if(t.routing.enabled&&!t.operator.barejid)return;t.routing.enabled&&t.logMailer("conversations.routing.operator.nomoreslot","Routing operator unavailable",{vuid:iAdvize.vuid,barejid:t.operator.id,history_id:t.chat.history_id}),t.chat.putOpMsg(null,t.T("BONJOUR_NOTRE_SERVICE_CLIENT_EST_ACTUELLEMENT_FERME"),0,1),t.featureFlags["iadvize.conversations.livechat-chatbox-v2"]&&t.orchestrator.notifyWaitingIsListFull(),t.util.addScript("IDZhistory",t.chaturl+"rpc/chat_history.php?sid="+t.website_id+"&missed="+t.chat.history_id+"&oid="+t.operator.id+"&u="+t.vuid),t.opOffline=1,t.chat.status=a.NOT_CHATTING,t.operator={}}if("showinvit"===p&&t.chat.loadInvitation(g),"init_cobro"===p&&t.operator.barejid&&t.chat.sendCommand(t.operator.barejid,"!cobro_init"),"magic_event"===p){if(!T)return!0;if(!T.isReceiver||!T.changeState)return t.errorMailer("Mirroring magic_event error: Defined Mirror but undefined methods",{object:T,type:void 0===T?"undefined":r(T),browser:window.navigator.userAgent,url:window.location.href},""),!0;"sender"==g||"disabled"==g||"receiver"==g?("sender"==g&&T.isReceiver()&&(e("#op_cursor").animate({top:"-3000px",left:"-3000px"},150),t.Templates.showDialog(),t.chat.cobrowsing=0,t.JSONStore.saveData({chat_cobrowsing:t.chat.cobrowsing}),t.chat.putOpAlert(t.T("COBROWSING_STOP")),v.emit(_.OnEventCobrowsingStopped),t.callbacks.onCobrowsingStopped()),"sender"!=g||t.operator.barejid||(t.monitor_jid=l),"disabled"==g&&t.chat.status!=a.CHATTING&&delete t.monitor_jid,T.changeState(g)):"receiver_request"==g&&(t.chat.buildChat(),t.Templates.showDialog(),t.Templates.maximizeChatbar(),t.chat.put_dialog(t.Templates.askCobrowsing.replace(/\{TIME\}/g,t.chat.getMsgTime())),t.chat.updateHistory(t.chat.MESSAGE_TYPES.OPERATOR_ALERT,"COBROWSING_ASK"),e('[id="idz_cobrowsing_accept"]').bind("click",function(n){return e(n.target).closest(".idz_msg_alert_op").remove(),t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("COBROWSING_ACCEPT")).replace(/\{TIME\}/g,t.chat.getMsgTime())),"numericable"==t.customize.layout||t.flags.streamId||t.Templates.hideDialog(),N(),!1}),e('[id="idz_cobrowsing_refuse"]').bind("click",function(n){return e(n.target).closest(".idz_msg_alert_op").remove(),t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("COBROWSING_REFUSE")).replace(/\{TIME\}/g,t.chat.getMsgTime())),M(),!1}),t.callbacks.onCobrowsingRequested())}"change_page"===p&&(document.location.href=decodeURIComponent(g))},onChatStates:function(n,r){try{w(t.operator.pseudo+"_"+t.operator.id,n)&&("composing"===r?(e(".idz_writting").html(t.T("OPERATEUR_COMPOSING")),t.callbacks.onOperatorWriting(),f()&&t.orchestrator.displayOperatorIsTypingIndicator()):(e(".idz_writting").html(" "),t.callbacks.onOperatorStopWriting(),f()&&t.orchestrator.hideOperatorIsTypingIndicator()))}catch(e){t.PROD?t.errorMailer("onChatState: ",e,r):console&&console.debug&&console.debug("[Erreur][onChatStates]",e.message,r)}},onMessage:function(n){if(f()){try{var r=(0,s.toRfcMessage)(n);iAdvize.orchestrator.receiveMessage(r)}catch(t){}t.activeCall&&(t.orchestrator.initializeChatbox(),t.orchestrator.openChatbox())}var i=n.body,c=n.id,u=n.from,l=n.barejid;if(d=u,Strophe.getResourceFromJid(d)!==t.vuid){var d,h;if(t.opBusy=0,null!==(h=t.conversationJid)&&!w(h,l))return t.chat.sendCommand(l,"!chatting"),e(".idz_writting").html(" "),!0;if(t.operator.barejid||(t.operator.barejid=l),t.chat.putOpMsg(c,i,1),setTimeout(function(){e(".idz_writting").html(" ")},350),t.chat.status=a.CHATTING,t.virtualOP=0,iAdvize.Templates.shouldNotOpenChatboxOnNewMessage&&t.chatbox_state==o.MINIMIZED||(t.chatbox_state=o.OPENED),t.blink_title(),"1"==t.customize.sound_alert){t.playSound("message")}}},onMessageReceipt:function(e){if(!t.routing.enabled)try{if(e.isCommand()){var n=e.getCommand();"transfer"===n.name&&t.transfer(n.param1)}}catch(n){t.PROD?t.errorMailer("onReceipt: ",n,e):console&&console.debug&&console.debug("[Erreur][onMessageReceipt]",n.message,e)}return!0},EndOfChat:function(){if(t.chat.status=a.CHATTING_BUT_VISITOR_CLOSED_THE_CHATBOX,(0==t.chat.prev_history||isNaN(t.chat.prev_history)||t.chat.history_id>t.chat.prev_history)&&(t.chat.prev_history=t.chat.history_id),t.chat.history_id=0,t.chatbox_state=t.chat.CHATBOX_STATES.CHATBAR_HIDDEN,t.JSONStore.save({chat_status:t.chat.status,chatbox_state:t.chatbox_state}),t.operator={},m.getConnection().connected&&(m.room.leave(t.conversationJid,t.vuid),t.chat.sendPresence("available")),v.emit("conversation.chat.ended"),f())try{iAdvize.orchestrator.endConversation()}catch(t){}},showConnectionError:function(){(e("#idz_chatglobal").is(":visible")||t.chat.status==a.CHATTING)&&(e(".idz_writting").html(""),t.chat.putOpAlert(t.T("CONNECTION_ERREUR")),t.chat.disableLoading(),e("#idz_msgmsg, #idz_postmsg").prop("disabled",!0),I())},sendXmppMessage:function(n,r){var i=e.Deferred();try{if(!n||""===n)return i.reject("desk.publish.error.empty"),i.promise();if(t.blocked)return i.reject("desk.publish.error.blocked"),i.promise();t.chat.status===a.CHATTING_BUT_VISITOR_CLOSED_THE_CHATBOX&&t.chat.history_id>0&&t.chat.sendPresence("dnd"),t.chat.status=a.CHATTING,t.chatbox_state=t.chat.CHATBOX_STATES.OPENED,m.room.groupchat(n,r).done(function(t){i.resolve(t)}).fail(t.chat.onRetrySendMessage)}catch(t){return i.reject("desk.publish.error.unknown",t)}return i.promise()},onRetrySendMessage:function(e,n,r){r&&r.done(function(t){}).fail(t.chat.onRetrySendMessage)},sendChatClose:function(){v.emit(_.OnEventConversationClosed)},sendAlert:function(e,n,r){try{if(1==t.virtualOP)return;var i=(new Date).getTime();if(t.chat.status==a.CHATTING||r){var o=$msg({to:t.operator.barejid,from:m.getConnection().jid,type:"chat",id:i,website:t.website_id}).c("body").t(e);return m.getConnection().send(o),i}}catch(r){t.errorMailer("sendAlert: ",r,e+"\n\n"+n)}},sendPresence:function(e){var n={site:t.website_id,opid:t.operator.id};t.chat.history_id&&(n.history=t.chat.history_id),"unavailable"==e?m.getConnection().send($pres({type:"unavailable"})):"available"==e?m.getConnection().send($pres(n).c("status").t(location.href)):"away"!=e&&"dnd"!=e||m.getConnection().send($pres(n).c("show").t(e).up().c("status").t(location.href))},sendCommand:function(t,e){if(m.isOnline(t)){var n=(new Date).getTime();m.getConnection().send($msg({id:n,to:t+"/operators",from:m.getConnection().jid,type:"chat"}).c("body").t(e))}},getMsgTime:function(){var t=new Date,e=t.getHours(),n=t.getMinutes();return n<10&&(n="0"+n),e+":"+n},put_dialog:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e(n);o.find(".idz_msgtext").attr("data-id",r);var a=o.attr("class");i&&o.attr("nonGroupable","true");var s=e("#idz_dialogbox_bottom"),c=s.prev("div"),u=c.attr("class"),l=s.prev("div").find(".idz_msgtime:last").html();if(!c.attr("nonGroupable")&&!i&&!t.Templates.hasGroupingMessagesDisabled&&("idz_msg_operator"==a||"idz_msg_visitor"==a)&&a==u){var f=o.find(".idz_msgtext"),d=o.find(".idz_msgtime");l==d.html()&&(d=""),s.prev("div").find(".idz_msgtext:last").after(f).after(d),"idz_msg_operator"==a&&e(".idz_opename:last").remove()}else e("#idz_dialogbox #idz_dialogbox_bottom").before(o);t.Templates.scrollChatBoxDialog()},getLocalTime:function(t){var e=6e4*(new Date).getTimezoneOffset(),n=new Date,r=new Date(n.getTime()+e);r.setHours(t.split(":")[0]),r.setMinutes(t.split(":")[1]);var i=new Date(r.getTime()-e),o=i.getHours(),a=i.getMinutes();return a<10&&(a="0"+a),o+":"+a},prepare_history2:function(e,n){var r,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.chat.prepare_history((r=e.map(function(e){return e.text?[["VISITOR"===e.author.type?t.chat.MESSAGE_TYPES.VISITOR:t.chat.MESSAGE_TYPES.OPERATOR,e.createdAt,e.text,e.id,e.author]]:e.attachments.map(function(n){switch(n.type){case"FILE":case"IMAGE":return["VISITOR"===e.author.type?t.chat.MESSAGE_TYPES.VISITOR_RICH_CONTENT:t.chat.MESSAGE_TYPES.OPERATOR_RICH_CONTENT,e.createdAt,JSON.stringify({type:"upload",data:{url:n.data.url,type:n.data.mimeType,name:n.data.fileName}}),e.id,e.author];case"PRODUCT":return[t.chat.MESSAGE_TYPES.OPERATOR_RICH_CONTENT,e.createdAt,JSON.stringify({type:"product",data:{productUrl:n.data.productUrl,title:n.data.title,imageUrl:n.data.imageUrl,priceCatalog:n.data.catalogPrice,pricePromotion:n.data.promotionPrice,available:n.data.isAvailable}}),e.id,e.author];case"QUICK_REPLY_MENU":return[t.chat.MESSAGE_TYPES.OPERATOR_RICH_CONTENT,e.createdAt,JSON.stringify({type:"message-with-multiple-choices",data:{message:n.data.message,choices:n.data.choices}}),e.id,e.author];case"LINK":return[t.chat.MESSAGE_TYPES.OPERATOR_ALERT,e.createdAt,"LINKS "+n.data.url+" "+n.data.title,e.id,e.author];case"OFFER":return[t.chat.MESSAGE_TYPES.OPERATOR_ALERT,e.createdAt,"OFFERS "+n.data.url+" "+[n.data.title,n.data.description,n.data.imageUrl].join("|"),e.id,e.author];case"AUTOMATIC_MESSAGE_SENT":return[t.chat.MESSAGE_TYPES.OPERATOR,e.createdAt,n.data.text,e.id,e.author];case"COBROWSING_ASKED":case"COBROWSING_ACCEPTED":case"COBROWSING_REFUSED":case"COBROWSING_STOPPED":case"CONVERSATION_CLOSED":case"TRANSFERRED_TO_PARTICIPANT":return[t.chat.MESSAGE_TYPES.OPERATOR_ALERT,e.createdAt,{COBROWSING_ASKED:"COBROWSING_ASK",COBROWSING_ACCEPTED:"COBROWSING_ACCEPT",COBROWSING_REFUSED:"COBROWSING_REFUSE",COBROWSING_STOPPED:"COBROWSING_STOP",CONVERSATION_CLOSED:"CHAT_CLOSE",TRANSFERRED_TO_PARTICIPANT:"TRANSFERRED_TO_PARTICIPANT"}[n.type]]}})}).reduce(function(t,e){return t.concat(e.filter(function(t){return!!t}))},[]),JSON.stringify(r).slice(1,-1)),n,i)},getLocalTimeFromUTCDate:function(t){return new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},prepare_history:function(n,r){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{n=JSON.parse("["+n+"]")}catch(e){return void t.errorMailer("prepare_history JSON.parse: ",e,n)}var o=r||e("<div id='hist_container'></div>"),a="",s="",c="",u="",l="",f=!0,d=!1,p="",m="",g="",b=0;h.forEach(n,function(e){var n={type:e[0],time:t.chat.getLocalTimeFromUTCDate(e[1]),content:e[2],id:e[3],author:e[4]};if(k(n.id))return!0;if(m=(m=t.util.htmlSimpleEscape(n.content)).replace(/&lt;br \/&gt;/gi,"<br/>").replace(/&lt;br\/&gt;/gi,"<br/>").replace(/&lt;br&gt;/gi,"<br/>"),t.Templates.hasGroupingMessagesDisabled||b!=n.type||n.type!=t.chat.MESSAGE_TYPES.OPERATOR&&n.type!=t.chat.MESSAGE_TYPES.VISITOR?n.type==t.chat.MESSAGE_TYPES.OPERATOR?o.append(t.chat.getOpMsg(m,n.time,n.author)):n.type==t.chat.MESSAGE_TYPES.VISITOR&&o.append(t.chat.getVmsg(m,n.time)):(p=g==n.time?"":"<div class='idz_msgtime'>"+n.time+"</div>",m=t.chat.convertLinks(m,!0),m=y.replaceUtf8ToImage("apple",m),o.find(".idz_msgtext:last").after("<div class='idz_msgtext'>"+m+"</div>").after(p)),t.chat.tagAutomatedMessages(o,n.id),b=n.type,g=n.time,n.type==t.chat.MESSAGE_TYPES.VISITOR&&f&&(f=!1,!0===t.operator.isExpert&&(o.append(t.chat.getOpAlert(t.chat.getExpertDisclaimer(),g)),b=t.chat.MESSAGE_TYPES.OPERATOR_ALERT,d=!0)),n.type==t.chat.MESSAGE_TYPES.OPERATOR_ALERT){if("LINKS"===(s=(a=n.content).split(" ")[0])||"PUSH"===s){c=a.split(" ")[1],u=a.substr(c.length+s.length+2),-1==c.indexOf(t.website_url,0)&&(l=" target='_blank'");var r=t.Templates.putLinkItem(c,u,l);C()?o.append(r):("LINKS"===s&&o.append(t.chat.getOpAlert(t.T("OPERATEUR_SENDLINK"),n.time)),"PUSH"===s&&o.append(t.chat.getOpAlert(t.T("OPERATEUR_PUSHLINK"),n.time)))}if("OFFERS"===s){c=a.split(" ")[1],u=a.substr(c.length+s.length+2),-1===c.indexOf(t.website_url)&&(l=" target='_blank'");var i=t.Templates.putOfferItem(c,u,l);C()?o.append(i):o.append(t.chat.getOpAlert(t.T("OPERATEUR_SENDOFFER"),n.time))}"VISIOCONF_ACCEPT"===s&&o.append(t.chat.getOpAlert(t.T("VISIOCONF_ACCEPT"),n.time)),"COBROWSING_ASK"===s&&o.append(t.chat.getOpAlert(t.T("COBROWSING_ASK_SHORT"),n.time)),"COBROWSING_ACCEPT"===s&&o.append(t.chat.getOpAlert(t.T("COBROWSING_ACCEPT"),n.time)),"COBROWSING_REFUSE"===s&&o.append(t.chat.getOpAlert(t.T("COBROWSING_REFUSE"),n.time)),"COBROWSING_STOP"===s&&o.append(t.chat.getOpAlert(t.T("COBROWSING_STOP"),n.time)),"CHAT_CLOSE"!==s&&"VISITOR_CHAT_CLOSE"!==s&&"OPERATOR_CHAT_CLOSE"!==s||o.append(t.chat.getOpAlert(t.T("FIN_DISCUSSION_SHORT"),n.time)),"TRANSFERRED_TO_PARTICIPANT"===s&&o.append(t.chat.getOpAlert(t.T("OPERATEUR_TRANSFER"),n.time))}if(n.type==t.chat.MESSAGE_TYPES.OPERATOR&&x.push(n.id),n.type===t.chat.MESSAGE_TYPES.OPERATOR_RICH_CONTENT||n.type===t.chat.MESSAGE_TYPES.VISITOR_RICH_CONTENT)try{var h=JSON.parse(n.content),S=n.type===t.chat.MESSAGE_TYPES.OPERATOR_RICH_CONTENT?"operator":"visitor";v.emit(_.OnXmppOOBReceived,n.id,S,n.time,h.type,h.data.url,h.data,o,n.author)}catch(t){}}),!1===d&&!0===t.operator.isExpert&&o.append(t.chat.getOpAlert(t.chat.getExpertDisclaimer())),i&&e("#idz_dialogbox #idz_dialogbox_bottom").before(o),v.emit("events.operatorMessageAppended",t.operator),t.chatbox_state==t.chat.CHATBOX_STATES.OPENED&&t.chat.offercount>1&&(C()||t.Templates.showOfferPanel()),r||(t.Templates.scrollChatBoxDialog(),t.Templates.scrollLinkDialog())},getExpertDisclaimer:function(){return t.T("chatbox.operatorAlert.expertDisclaimer").replace(/\{\{ company }}/g,t.website_label)}}),t.blink_title=function(){1!==t.hasFocus&&(null!==t.blinktm&&(clearInterval(t.blinktm),t.blinktm=null),t.blinktm=setInterval(function(){e("title").html()===t.oTitle?document.title=t.T("NOUVEAU_MESSAGE"):document.title=t.oTitle},1500))},t.findOPDelayed=function(){return t.routing.enabled?0:setTimeout(function(){t.AvailableOp.find()},1500)},t.onActivity=function(){t.vStats.lastMove=(new Date).getTime(),null==t.vStats.activeSince&&(t.vStats.activeSince=(new Date).getTime())},t.logMailer=g.info,t.errorMailer=g.error,t.urgentErrorMailer=g.urgent_error,void 0===t.Utils&&(t.Utils={}),t.Utils.errorMailer=t.errorMailer,t.Utils.urgentErrorMailer=t.urgentErrorMailer}function I(){f()&&(t.orchestrator.removeThreadNotification("chatbox.notifications.connection.problem"),t.orchestrator.addThreadNotification({id:"chatbox.notifications.connection.problem",titleTranslationKey:"chatbox.notifications.connection.problem.title",textTranslationKey:"chatbox.notifications.connection.problem.text",type:"DANGER"}),t.orchestrator.disableComposeZone())}function N(){t.chat.addCobrowsingImg(),T.changeState("receiver"),t.chat.sendCommand(t.operator.barejid,"!magic_event receiver_accept"),t.chat.cobrowsing=1,t.JSONStore.saveData({chat_cobrowsing:t.chat.cobrowsing}),t.callbacks.onCobrowsingAccepted()}function M(){t.chat.sendCommand(t.operator.barejid,"!magic_event receiver_refuse"),t.callbacks.onCobrowsingRefused()}function P(n){var r=n.status;t.opOffline=r.opOffline,t.c2cOffline=r.c2cOffline,t.opBusy=r.opBusy,t.initSession=!1;var i=e.Deferred();if(r.opOffline)t.chat.disableLoading();else{t.chat.history_id=n.chatId,t.vStats.history_id=n.chatId,t.chat.status=a.CHATTING,t.conversationJid=n.conversationJid,m.room.join(t.conversationJid,t.vuid,10).done(function(){m.getConnection().connected&&t.chat.sendPresence("dnd"),i.resolve()},i.reject),t.operator=n.operator,f()&&t.orchestrator.setCurrentOperator((0,s.getAuthorFromLegacyOperator)(t.operator)),t.c2coperator=n.c2coperator?n.c2coperator:n.operator,t.on_call&&(t.operator=n.c2coperator);var o=j();e("#idz_button_print").attr("href",t.chaturl+"gethistory.php?id="+n.chatId+"&u="+t.vuid),e("#idz_button_mail").attr("href",t.chaturl+"gethistory_mail.php?id="+n.chatId+"&u="+t.vuid+"&timezoneAbbr="+o),v.emit("conversation.chat.started",n.chatId)}return(r.opOffline||r.opBusy)&&i.reject(),i.promise()}function D(){var e="visitor";(t.flags.proactif_alert||t.flags.proactif_invit)&&(e="proactif"),t.callbacks.onChatStarted({id:t.chat.history_id,startedBy:e})}function k(t){return!h.isUndefined(t)&&!h.isNull(t)&&(!!h.some(x,t)||(x.push(t),x.length>5&&x.shift(),!1))}function j(){var t=String(new Date),e=/\((.*)\)/.exec(t,"g");return!e||e.length<2?"":e[1]}}(iAdvize,iAdvize.$)},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.NOT_CHATTING=1,e.CHATTING=2,e.CHATTING_BUT_VISITOR_CLOSED_THE_CHATBOX=3},function(t,e,n){var r=n(6);t.exports=function(t,e,n,i,o,a,s,c){var u={},l=!1,f=!1,d=function(e,n,i){if((0,r.has)(e,n)){var o=t('<div class="idz_dialogbox_history_previous_conversation_container"></div>');return e[n].find(".idz_dialogbox_history_conversation_separator").after(o),{isGhostContainer:!0,container:o}}return e[n]=i(),{isGhostContainer:!1,container:e[n]}},h=function(n,r){var i=t('<div class="idz_dialogbox_history_day_conversation_container"></div>'),o=t('<div class="idz_dialogbox_history_conversation_separator"></div>'),a=new Date(r),s=p(a)?e("today"):a.toLocaleDateString();return o.append(isNaN(a)?r:s),i.prepend(o),n.push(i),i},p=function(t){return(new Date).toDateString()===t.toDateString()},m=0,g={next:function(){},hasNext:function(){return!1}},v=function(t,e,n,o,a){var s=function(t){var e=t.messages,n=[],o=(0,r.groupBy)(e,function(t){return t.createdAt.split("T")[0]}),a=(0,r.map)(o,function(t,e){return{messages:t,date:e}}).sort(function(t,e){return new Date(e.date)-new Date(t.date)});if(!l){var s=new Date(Date.now()).toISOString().split("T")[0];d(u,s,function(){return h(n,s)}),l=!0}return(0,r.map)(a,function(t){var e=d(u,t.date,function(){return h(n,t.date)}),r=!e.isGhostContainer;i.prepare_history2(t.messages,e.container,r)}),n}(t);e(),(0,r.forEach)(s,function(t){return n.prepend(t)}),o.scrollTop=o.scrollHeight-m,0===o.scrollTop&&y(!1,a,e,n,o)},_=function(t){return t.filter(function(t){return!("SYSTEM_MESSAGE"===t.type&&t.attachments.length>0&&"CONVERSATION_CLOSED"===t.attachments[0].type)})};function y(t,e,n,r,i){g.hasNext()&&(m=i.scrollHeight,e(),t||(m=i.scrollHeight),g.next().then(function(t){if(c){var o=_(t.messages);t.messages=o}return v(t,n,r,i,e)}))}var b=function(t,e,r,i){f||(f=!0,n.displayChatHistoryContainer(),v({messages:[]},e,r,i),a.getFetchPreviousConversationIterator().then(function(n){g=n,y(!0,t,e,r,i)}))},S=function(){return n.showChatHistoryLoader()},T=function(){return n.hideChatHistoryLoader()},E=n.getChatHistoryContainer(),C=t("#idz_dialogbox")[0],w=t("#hist_container, .idz_msg_operator, .idz_msg_visitor");return o.on("conversation.chat.started",function(){return b(S,T,E,C)}),o.on("conversation.chat.ended",function(){return function(t,e){g={next:function(){},hasNext:function(){return!1}},t.empty(),e.remove(),f=!1}(E,w)}),o.on("chatbox.scrolledTop",function(){return y(!1,S,T,E,C)}),function(){return b(S,T,E,C)}}},function(t,e){var n=iAdvize,r=n.require("eventManager"),i={record:function(t,e){try{if("gtm"===n.preferences.plugins.GOOGLEANALYTICS_PLUGIN){var r=n.preferences.plugins.GOOGLEANALYTICS_GTM_NAME;window[r].push({category:"iAdvize",action:t,label:e,event:"iAdvize"})}"gau"===n.preferences.plugins.GOOGLEANALYTICS_PLUGIN&&ga("send","event","iAdvize",t,e)}catch(t){}},handleEvents:function(){if(!n.routing.enabled)return r.on("conversation.call.started",function(){i.record("Call",n.c2coperator.pseudo)}),r.on("conversation.chat.started",function(){i.record("Chat",n.operator.pseudo)}),void r.on("conversation.video.started",function(){i.record("Video",n.operator.pseudo)});r.on(r.events.OnConversationCallRoutingCompleted,function(t){i.record("Call",t.operatorProfile.pseudo)}),r.on(r.events.OnConversationChatRoutingCompleted,function(t){i.record("Chat",t.operatorProfile.pseudo)}),r.on(r.events.OnConversationVisioRoutingCompleted,function(t){i.record("Video",t.pseudo)})}};i.handleEvents(),t.exports=i}]);